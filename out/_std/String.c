// Generated by HLC 4.0.0 (HL v4)
#include <hl/code.h>

String String_toUpperCase(String r0) {
	String r4;
	int r2, r3;
	vbyte *r1;
	r1 = r0->bytes;
	r2 = 0;
	r3 = r0->length;
	r1 = hl_ucs2_upper(r1,r2,r3);
	r2 = r0->length;
	r4 = (String)hl_alloc_obj(String__val);
	r4->bytes = r1;
	r4->length = r2;
	return r4;
}

String String_toLowerCase(String r0) {
	String r4;
	int r2, r3;
	vbyte *r1;
	r1 = r0->bytes;
	r2 = 0;
	r3 = r0->length;
	r1 = hl_ucs2_lower(r1,r2,r3);
	r2 = r0->length;
	r4 = (String)hl_alloc_obj(String__val);
	r4->bytes = r1;
	r4->length = r2;
	return r4;
}

String String_charAt(String r0,int r1) {
	String r5;
	bool r2;
	vbyte *r6, *r7;
	int r3, r4;
	r4 = r0->length;
	if( ((unsigned)r1) >= ((unsigned)r4) ) goto label$3$4;
	r2 = false;
	goto label$3$5;
	label$3$4:
	r2 = true;
	label$3$5:
	if( !r2 ) goto label$3$8;
	r5 = (String)global$8;
	return r5;
	label$3$8:
	r3 = 4;
	r6 = hl_alloc_bytes(r3);
	r7 = r0->bytes;
	r4 = 1;
	r3 = r1 << r4;
	r3 = *(unsigned short*)(r7 + r3);
	r4 = 0;
	*(unsigned short*)(r6 + r4) = (unsigned short)r3;
	r3 = 2;
	r4 = 0;
	*(unsigned short*)(r6 + r3) = (unsigned short)r4;
	r5 = (String)hl_alloc_obj(String__val);
	r5->bytes = r6;
	r3 = 1;
	r5->length = r3;
	return r5;
}

vdynamic* String_charCodeAt(String r0,int r1) {
	bool r2;
	vdynamic *r5;
	vbyte *r6;
	int r3, r4;
	r4 = r0->length;
	if( ((unsigned)r1) >= ((unsigned)r4) ) goto label$4$4;
	r2 = false;
	goto label$4$5;
	label$4$4:
	r2 = true;
	label$4$5:
	if( !r2 ) goto label$4$8;
	r5 = NULL;
	return r5;
	label$4$8:
	r6 = r0->bytes;
	r4 = 1;
	r3 = r1 << r4;
	r3 = *(unsigned short*)(r6 + r3);
	r5 = hl_alloc_dynamic(&type$3);
	r5->v.i = r3;
	return r5;
}

int String_findChar(String r0,int r1,int r2,vbyte* r3,int r4) {
	bool r6;
	vbyte *r8;
	int r5, r7, r9, r10;
	r5 = 0;
	label$5$1:
	r6 = true;
	if( !r6 ) goto label$5$20;
	r8 = r0->bytes;
	r9 = r2 - r1;
	r10 = 0;
	r7 = hl_bytes_find(r8,r1,r9,r3,r10,r4);
	r5 = r7;
	r9 = 0;
	if( r7 < r9 ) goto label$5$15;
	r9 = 1;
	r7 = r7 & r9;
	r9 = 0;
	if( r7 != r9 ) goto label$5$16;
	label$5$15:
	goto label$5$20;
	label$5$16:
	r9 = 1;
	r7 = r5 + r9;
	r1 = r7;
	goto label$5$1;
	label$5$20:
	return r5;
}

int String_indexOf(String r0,String r1,vdynamic* r2) {
	bool r9;
	vbyte *r7, *r11;
	int r3, r4, r5, r6, r8, r10, r12, r13;
	r3 = 0;
	if( !r2 ) goto label$6$14;
	r4 = r2 ? r2->v.i : 0;
	r5 = 0;
	if( r5 >= r4 ) goto label$6$14;
	r4 = r2 ? r2->v.i : 0;
	r5 = r0->length;
	if( r4 < r5 ) goto label$6$10;
	r4 = -1;
	return r4;
	label$6$10:
	r4 = r2 ? r2->v.i : 0;
	r5 = 1;
	r4 = r4 << r5;
	r3 = r4;
	label$6$14:
	r4 = r3;
	r5 = r0->length;
	r6 = 1;
	r5 = r5 << r6;
	if( r1 == NULL ) hl_null_access();
	r7 = r1->bytes;
	r6 = r1->length;
	r8 = 1;
	r6 = r6 << r8;
	r8 = 0;
	label$6$24:
	r9 = true;
	if( !r9 ) goto label$6$43;
	r11 = r0->bytes;
	r12 = r5 - r4;
	r13 = 0;
	r10 = hl_bytes_find(r11,r4,r12,r7,r13,r6);
	r8 = r10;
	r12 = 0;
	if( r10 < r12 ) goto label$6$38;
	r12 = 1;
	r10 = r10 & r12;
	r12 = 0;
	if( r10 != r12 ) goto label$6$39;
	label$6$38:
	goto label$6$43;
	label$6$39:
	r12 = 1;
	r10 = r8 + r12;
	r4 = r10;
	goto label$6$24;
	label$6$43:
	r10 = r8;
	r13 = 0;
	if( r13 >= r8 ) goto label$6$49;
	r13 = 1;
	r12 = r8 >> r13;
	r10 = r12;
	label$6$49:
	return r10;
}

int String_lastIndexOf(String r0,String r1,vdynamic* r2) {
	bool r7;
	vbyte *r9, *r12;
	int r3, r4, r5, r6, r8, r10, r11, r13, r14;
	r3 = 0;
	r4 = r0->length;
	if( !r2 ) goto label$7$5;
	r5 = r2 ? r2->v.i : 0;
	r4 = r5;
	label$7$5:
	r6 = 1;
	r5 = r4 << r6;
	r4 = r5;
	label$7$8:
	r7 = true;
	if( !r7 ) goto label$7$52;
	r5 = r3;
	r6 = r0->length;
	r8 = 1;
	r6 = r6 << r8;
	if( r1 == NULL ) hl_null_access();
	r9 = r1->bytes;
	r8 = r1->length;
	r10 = 1;
	r8 = r8 << r10;
	r10 = 0;
	label$7$21:
	r7 = true;
	if( !r7 ) goto label$7$40;
	r12 = r0->bytes;
	r13 = r6 - r5;
	r14 = 0;
	r11 = hl_bytes_find(r12,r5,r13,r9,r14,r8);
	r10 = r11;
	r13 = 0;
	if( r11 < r13 ) goto label$7$35;
	r13 = 1;
	r11 = r11 & r13;
	r13 = 0;
	if( r11 != r13 ) goto label$7$36;
	label$7$35:
	goto label$7$40;
	label$7$36:
	r13 = 1;
	r11 = r10 + r13;
	r5 = r11;
	goto label$7$21;
	label$7$40:
	r14 = 0;
	if( r10 < r14 ) goto label$7$43;
	if( r4 >= r10 ) goto label$7$48;
	label$7$43:
	r14 = 1;
	r13 = r3 >> r14;
	r14 = 1;
	r13 = r13 - r14;
	return r13;
	label$7$48:
	r14 = 2;
	r13 = r10 + r14;
	r3 = r13;
	goto label$7$8;
	label$7$52:
	r3 = 0;
	return r3;
}

hl__types__ArrayObj String_split(String r0,String r1) {
	String r7;
	hl__types__ArrayObj r2;
	hl_type *r4;
	bool r11;
	vdynamic *r10;
	vbyte *r13, *r16;
	int r5, r6, r8, r9, r12, r14, r15, r17, r18;
	varray *r3;
	r4 = &type$13;
	r5 = 0;
	r3 = hl_alloc_array(r4,r5);
	r2 = hl_types_ArrayObj_alloc(r3);
	r5 = r0->length;
	r6 = 0;
	if( r5 != r6 ) goto label$8$11;
	if( r2 == NULL ) hl_null_access();
	r7 = (String)global$8;
	r5 = hl_types_ArrayObj_push(r2,((vdynamic*)r7));
	return r2;
	label$8$11:
	if( r1 == NULL ) hl_null_access();
	r5 = r1->length;
	r6 = 0;
	if( r5 != r6 ) goto label$8$28;
	r5 = 0;
	r6 = r0->length;
	label$8$17:
	if( r5 >= r6 ) goto label$8$27;
	if( r2 == NULL ) hl_null_access();
	r8 = r5;
	++r5;
	r9 = 1;
	r10 = hl_alloc_dynamic(&type$3);
	r10->v.i = r9;
	r7 = String_substr(r0,r8,r10);
	r8 = hl_types_ArrayObj_push(r2,((vdynamic*)r7));
	goto label$8$17;
	label$8$27:
	return r2;
	label$8$28:
	r5 = 0;
	r6 = r1->length;
	label$8$30:
	r11 = true;
	if( !r11 ) goto label$8$82;
	r9 = 1;
	r8 = r5 << r9;
	r9 = r0->length;
	r12 = 1;
	r9 = r9 << r12;
	if( r1 == NULL ) hl_null_access();
	r13 = r1->bytes;
	r14 = 1;
	r12 = r6 << r14;
	r14 = 0;
	label$8$43:
	r11 = true;
	if( !r11 ) goto label$8$62;
	r16 = r0->bytes;
	r17 = r9 - r8;
	r18 = 0;
	r15 = hl_bytes_find(r16,r8,r17,r13,r18,r12);
	r14 = r15;
	r17 = 0;
	if( r15 < r17 ) goto label$8$57;
	r17 = 1;
	r15 = r15 & r17;
	r17 = 0;
	if( r15 != r17 ) goto label$8$58;
	label$8$57:
	goto label$8$62;
	label$8$58:
	r17 = 1;
	r15 = r14 + r17;
	r8 = r15;
	goto label$8$43;
	label$8$62:
	r18 = 0;
	if( r14 >= r18 ) goto label$8$71;
	if( r2 == NULL ) hl_null_access();
	r18 = r0->length;
	r18 = r18 - r5;
	r10 = hl_alloc_dynamic(&type$3);
	r10->v.i = r18;
	r7 = String_substr(r0,r5,r10);
	r17 = hl_types_ArrayObj_push(r2,((vdynamic*)r7));
	goto label$8$82;
	label$8$71:
	r18 = 1;
	r17 = r14 >> r18;
	r15 = r17;
	if( r2 == NULL ) hl_null_access();
	r18 = r15 - r5;
	r10 = hl_alloc_dynamic(&type$3);
	r10->v.i = r18;
	r7 = String_substr(r0,r5,r10);
	r17 = hl_types_ArrayObj_push(r2,((vdynamic*)r7));
	r17 = r15 + r6;
	r5 = r17;
	goto label$8$30;
	label$8$82:
	return r2;
}

String String_substr(String r0,int r1,vdynamic* r2) {
	String r8;
	bool r9;
	vbyte *r10, *r11;
	int r3, r5, r6, r7, r12, r13;
	r3 = r0->length;
	if( r2 ) goto label$9$4;
	r5 = r3;
	goto label$9$5;
	label$9$4:
	r5 = r2 ? r2->v.i : 0;
	label$9$5:
	r7 = 0;
	if( r5 != r7 ) goto label$9$9;
	r8 = (String)global$8;
	return r8;
	label$9$9:
	r7 = 0;
	if( r1 == r7 ) goto label$9$15;
	r7 = 0;
	if( r5 >= r7 ) goto label$9$15;
	r8 = (String)global$8;
	return r8;
	label$9$15:
	r7 = 0;
	if( r1 >= r7 ) goto label$9$24;
	r6 = r3 + r1;
	r1 = r6;
	r7 = 0;
	if( r6 >= r7 ) goto label$9$23;
	r6 = 0;
	r1 = r6;
	label$9$23:
	goto label$9$33;
	label$9$24:
	r7 = 0;
	if( r5 >= r7 ) goto label$9$33;
	r6 = r3 + r5;
	r6 = r6 - r1;
	r5 = r6;
	r7 = 0;
	if( r6 >= r7 ) goto label$9$33;
	r8 = (String)global$8;
	return r8;
	label$9$33:
	r6 = r1 + r5;
	if( ((unsigned)r3) < ((unsigned)r6) ) goto label$9$37;
	r9 = false;
	goto label$9$38;
	label$9$37:
	r9 = true;
	label$9$38:
	if( !r9 ) goto label$9$41;
	r6 = r3 - r1;
	r5 = r6;
	label$9$41:
	r7 = 0;
	if( r1 < r7 ) goto label$9$45;
	r7 = 0;
	if( r7 < r5 ) goto label$9$47;
	label$9$45:
	r8 = (String)global$8;
	return r8;
	label$9$47:
	r7 = 1;
	r6 = r5 + r7;
	r7 = 1;
	r6 = r6 << r7;
	r10 = hl_alloc_bytes(r6);
	r6 = 0;
	r11 = r0->bytes;
	r12 = 1;
	r7 = r1 << r12;
	r13 = 1;
	r12 = r5 << r13;
	hl_bytes_blit(r10,r6,r11,r7,r12);
	r7 = 1;
	r6 = r5 << r7;
	r7 = 0;
	*(unsigned short*)(r10 + r6) = (unsigned short)r7;
	r8 = (String)hl_alloc_obj(String__val);
	r8->bytes = r10;
	r8->length = r5;
	return r8;
}

String String_substring(String r0,int r1,vdynamic* r2) {
	String r7;
	vdynamic *r3;
	int r4, r5, r6;
	if( r2 ) goto label$10$4;
	r5 = r0->length;
	r4 = r5;
	goto label$10$15;
	label$10$4:
	r5 = r2 ? r2->v.i : 0;
	r4 = r5;
	r6 = 0;
	if( r5 >= r6 ) goto label$10$11;
	r5 = 0;
	r4 = r5;
	goto label$10$15;
	label$10$11:
	r6 = r0->length;
	if( r6 >= r5 ) goto label$10$15;
	r5 = r0->length;
	r4 = r5;
	label$10$15:
	r6 = 0;
	if( r1 >= r6 ) goto label$10$20;
	r5 = 0;
	r1 = r5;
	goto label$10$24;
	label$10$20:
	r6 = r0->length;
	if( r6 >= r1 ) goto label$10$24;
	r5 = r0->length;
	r1 = r5;
	label$10$24:
	if( r4 >= r1 ) goto label$10$28;
	r5 = r1;
	r1 = r4;
	r4 = r5;
	label$10$28:
	r6 = r4 - r1;
	r3 = hl_alloc_dynamic(&type$3);
	r3->v.i = r6;
	r7 = String_substr(r0,r1,r3);
	return r7;
}

String String_toString(String r0) {
	return r0;
}

vbyte* String_toUtf8(String r0) {
	int *r3;
	int r2;
	vbyte *r1;
	r1 = r0->bytes;
	r2 = 0;
	r3 = NULL;
	r1 = hl_utf16_to_utf8(r1,r2,r3);
	return r1;
}

vbyte* String___string(String r0) {
	vbyte *r1;
	r1 = r0->bytes;
	return r1;
}

int String___compare(String r0,vdynamic* r1) {
	String r3;
	$String r2;
	bool r4;
	vbyte *r6, *r7;
	int r5, r8, r9, r10;
	r2 = ($String)global$1;
	r4 = hl_BaseType_check(((hl__BaseType)r2),r1);
	if( !r4 ) goto label$14$5;
	r3 = (String)r1;
	goto label$14$6;
	label$14$5:
	r3 = NULL;
	label$14$6:
	if( r3 ) goto label$14$9;
	r5 = hl_ptr_compare(((vdynamic*)r0),r1);
	return r5;
	label$14$9:
	r6 = r0->bytes;
	r5 = 0;
	if( r3 == NULL ) hl_null_access();
	r7 = r3->bytes;
	r8 = 0;
	r9 = r0->length;
	r10 = r3->length;
	if( r9 >= r10 ) goto label$14$19;
	r9 = r0->length;
	goto label$14$20;
	label$14$19:
	r9 = r3->length;
	label$14$20:
	r10 = 1;
	r9 = r9 << r10;
	r5 = hl_bytes_compare(r6,r5,r7,r8,r9);
	r9 = 0;
	if( r5 != r9 ) goto label$14$29;
	r8 = r0->length;
	r9 = r3->length;
	r8 = r8 - r9;
	return r8;
	label$14$29:
	return r5;
}

void String_new(String r0,String r1) {
	int r3;
	vbyte *r2;
	if( r1 == NULL ) hl_null_access();
	r2 = r1->bytes;
	r0->bytes = r2;
	r3 = r1->length;
	r0->length = r3;
	return;
}

String String___add__(String r0,String r1) {
	String r3;
	vbyte *r8, *r10;
	int r4, r5, r6, r7, r9;
	if( r0 ) goto label$20$3;
	r3 = (String)global$179;
	r0 = r3;
	label$20$3:
	if( r1 ) goto label$20$6;
	r3 = (String)global$179;
	r1 = r3;
	label$20$6:
	if( r0 == NULL ) hl_null_access();
	r4 = r0->length;
	r5 = 1;
	r4 = r4 << r5;
	if( r1 == NULL ) hl_null_access();
	r5 = r1->length;
	r6 = 1;
	r5 = r5 << r6;
	r6 = r4 + r5;
	r9 = 2;
	r7 = r6 + r9;
	r8 = hl_alloc_bytes(r7);
	r7 = 0;
	r10 = r0->bytes;
	r9 = 0;
	hl_bytes_blit(r8,r7,r10,r9,r4);
	r10 = r1->bytes;
	r9 = 0;
	hl_bytes_blit(r8,r4,r10,r9,r5);
	r9 = 0;
	*(unsigned short*)(r8 + r6) = (unsigned short)r9;
	r3 = (String)hl_alloc_obj(String__val);
	r3->bytes = r8;
	r9 = 1;
	r7 = r6 >> r9;
	r3->length = r7;
	return r3;
}

String String_fromUTF8(vbyte* r0) {
	String r5;
	int *r4;
	vbyte *r2;
	int r1, r3, r6;
	r1 = 0;
	r3 = 0;
	r4 = &r1;
	r2 = hl_utf8_to_utf16(r0,r3,r4);
	r5 = (String)hl_alloc_obj(String__val);
	r5->bytes = r2;
	r6 = 1;
	r3 = r1 >> r6;
	r5->length = r3;
	return r5;
}

String String_fromUCS2(vbyte* r0) {
	String r1;
	int r2;
	r1 = (String)hl_alloc_obj(String__val);
	r1->bytes = r0;
	r2 = 0;
	r2 = hl_ucs2length(r0,r2);
	r1->length = r2;
	return r1;
}

vbyte* String_call_toString(vdynamic* r0) {
	String r3;
	vdynamic *r2;
	vbyte *r1;
	if( r0 == NULL ) hl_null_access();
	r2 = (vdynamic*)hl_dyn_getp((vdynamic*)r0,409915697/*toString*/,&type$9);
	if( r2 == NULL ) hl_null_access();
	{
		r2 = (vdynamic*)hl_dyn_call((vclosure*)r2,NULL,0);
	}
	if( r2 ) goto label$17$7;
	r3 = NULL;
	goto label$17$8;
	label$17$7:
	r3 = Std_string(r2);
	label$17$8:
	if( r3 == NULL ) hl_null_access();
	r1 = r3->bytes;
	return r1;
}

String String___alloc__(vbyte* r0,int r1) {
	String r2;
	r2 = (String)hl_alloc_obj(String__val);
	r2->bytes = r0;
	r2->length = r1;
	return r2;
}

String String_fromCharCode(int r0) {
	String r3, r6;
	int *r4;
	vbyte *r5;
	int r1, r2, r7;
	r2 = 0;
	if( r0 < r2 ) goto label$15$27;
	r2 = 65536;
	if( r0 >= r2 ) goto label$15$27;
	r2 = 55296;
	if( r0 < r2 ) goto label$15$15;
	r2 = 57343;
	if( r2 < r0 ) goto label$15$15;
	r3 = (String)global$178;
	r1 = r0;
	r4 = &r1;
	r5 = hl_itos(r1,r4);
	r6 = String___alloc__(r5,r1);
	r3 = String___add__(r3,r6);
	hl_throw((vdynamic*)r3);
	label$15$15:
	r1 = 4;
	r5 = hl_alloc_bytes(r1);
	r1 = 0;
	*(unsigned short*)(r5 + r1) = (unsigned short)r0;
	r1 = 2;
	r2 = 0;
	*(unsigned short*)(r5 + r1) = (unsigned short)r2;
	r3 = (String)hl_alloc_obj(String__val);
	r3->bytes = r5;
	r1 = 1;
	r3->length = r1;
	return r3;
	label$15$27:
	r2 = 1114112;
	if( r0 >= r2 ) goto label$15$54;
	r1 = 6;
	r5 = hl_alloc_bytes(r1);
	r2 = 65536;
	r1 = r0 - r2;
	r0 = r1;
	r1 = 0;
	r7 = 10;
	r2 = r0 >> r7;
	r7 = 55296;
	r2 = r2 + r7;
	*(unsigned short*)(r5 + r1) = (unsigned short)r2;
	r1 = 2;
	r7 = 1023;
	r2 = r0 & r7;
	r7 = 56320;
	r2 = r2 + r7;
	*(unsigned short*)(r5 + r1) = (unsigned short)r2;
	r1 = 4;
	r2 = 0;
	*(unsigned short*)(r5 + r1) = (unsigned short)r2;
	r3 = (String)hl_alloc_obj(String__val);
	r3->bytes = r5;
	r1 = 2;
	r3->length = r1;
	return r3;
	label$15$54:
	r3 = (String)global$178;
	r1 = r0;
	r4 = &r1;
	r5 = hl_itos(r1,r4);
	r6 = String___alloc__(r5,r1);
	r3 = String___add__(r3,r6);
	hl_throw((vdynamic*)r3);
}

