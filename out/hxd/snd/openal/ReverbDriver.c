// Generated by HLC 4.0.0 (HL v4)
#include <hl/code.h>

void hxd_snd_openal_ReverbDriver_acquire(hxd__snd__openal__ReverbDriver r0) {
	String r8;
	hxd__snd__EffectDriver r10;
	haxe__io__Bytes r1, r6;
	hxd__snd__effect__LowPass r11;
	double r12;
	hxd__snd__openal__Driver r2;
	vbyte *r5;
	int r3, r7, r9;
	r2 = r0->driver;
	if( r2 == NULL ) hl_null_access();
	r3 = 4;
	r1 = hxd_snd_openal_Driver_getTmpBytes(r2,r3);
	r3 = 1;
	if( r1 == NULL ) hl_null_access();
	r5 = r1->b;
	openal_al_gen_effects(r3,r5);
	r3 = 0;
	r3 = haxe_io_Bytes_getInt32(r1,r3);
	r0->inst = r3;
	r3 = openal_al_get_error();
	r7 = 0;
	if( r3 == r7 ) goto label$3822$16;
	r8 = (String)global$1340;
	hl_throw((vdynamic*)r8);
	label$3822$16:
	r3 = r0->inst;
	r7 = 32769;
	r9 = 1;
	openal_al_effecti(r3,r7,r9);
	r2 = r0->driver;
	if( r2 == NULL ) hl_null_access();
	r3 = 4;
	r6 = hxd_snd_openal_Driver_getTmpBytes(r2,r3);
	r3 = 1;
	if( r6 == NULL ) hl_null_access();
	r5 = r6->b;
	openal_al_gen_auxiliary_effect_slots(r3,r5);
	r3 = 0;
	r3 = haxe_io_Bytes_getInt32(r6,r3);
	r0->slot = r3;
	r3 = openal_al_get_error();
	r7 = 0;
	if( r3 == r7 ) goto label$3822$36;
	r8 = (String)global$1341;
	hl_throw((vdynamic*)r8);
	label$3822$36:
	r11 = r0->dryFilter;
	if( r11 == NULL ) hl_null_access();
	r10 = r11->driver;
	if( r10 == NULL ) hl_null_access();
	((void (*)(hxd__snd__EffectDriver))r10->$type->vobj_proto[0])(r10);
	r11 = r0->dryFilter;
	if( r11 == NULL ) hl_null_access();
	r12 = 1.;
	r11->gainHF = r12;
	return;
}

void hxd_snd_openal_ReverbDriver_release(hxd__snd__openal__ReverbDriver r0) {
	hxd__snd__EffectDriver r9;
	haxe__io__Bytes r5, r7;
	hxd__snd__effect__LowPass r10;
	hxd__snd__openal__Driver r6;
	vbyte *r8;
	int r2, r3, r4;
	r2 = r0->slot;
	r3 = 1;
	r4 = 0;
	openal_al_auxiliary_effect_sloti(r2,r3,r4);
	r6 = r0->driver;
	if( r6 == NULL ) hl_null_access();
	r2 = 4;
	r5 = hxd_snd_openal_Driver_getTmpBytes(r6,r2);
	if( r5 == NULL ) hl_null_access();
	r2 = 0;
	r3 = r0->slot;
	haxe_io_Bytes_setInt32(r5,r2,r3);
	r2 = 1;
	r8 = r5->b;
	openal_al_delete_auxiliary_effect_slots(r2,r8);
	r6 = r0->driver;
	if( r6 == NULL ) hl_null_access();
	r2 = 4;
	r7 = hxd_snd_openal_Driver_getTmpBytes(r6,r2);
	if( r7 == NULL ) hl_null_access();
	r2 = 0;
	r3 = r0->inst;
	haxe_io_Bytes_setInt32(r7,r2,r3);
	r2 = 1;
	r8 = r7->b;
	openal_al_delete_effects(r2,r8);
	r10 = r0->dryFilter;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->driver;
	if( r9 == NULL ) hl_null_access();
	((void (*)(hxd__snd__EffectDriver))r9->$type->vobj_proto[1])(r9);
	return;
}

void hxd_snd_openal_ReverbDriver_update(hxd__snd__openal__ReverbDriver r0,vdynamic* r1) {
	float r10;
	hxd__snd__effect__Reverb r2;
	double r6, r8, r9;
	int r4, r5, r7;
	r2 = (hxd__snd__effect__Reverb)hl_dyn_castp(&r1,&type$9,&type$3805);
	r4 = r0->inst;
	r5 = 3;
	r7 = 10;
	r6 = (double)r7;
	if( r2 == NULL ) hl_null_access();
	r8 = r2->room;
	r7 = 100;
	r9 = (double)r7;
	r8 = r8 / r9;
	r7 = 20;
	r9 = (double)r7;
	r8 = r8 / r9;
	r6 = hl_math_pow(r6,r8);
	r10 = (float)r6;
	openal_al_effectf(r4,r5,r10);
	r4 = r0->inst;
	r5 = 4;
	r7 = 10;
	r6 = (double)r7;
	r8 = r2->roomHF;
	r7 = 100;
	r9 = (double)r7;
	r8 = r8 / r9;
	r7 = 20;
	r9 = (double)r7;
	r8 = r8 / r9;
	r6 = hl_math_pow(r6,r8);
	r10 = (float)r6;
	openal_al_effectf(r4,r5,r10);
	r4 = r0->inst;
	r5 = 12;
	r6 = r2->roomRolloffFactor;
	r10 = (float)r6;
	openal_al_effectf(r4,r5,r10);
	r4 = r0->inst;
	r5 = 5;
	r6 = r2->decayTime;
	r10 = (float)r6;
	openal_al_effectf(r4,r5,r10);
	r4 = r0->inst;
	r5 = 6;
	r6 = r2->decayHFRatio;
	r10 = (float)r6;
	openal_al_effectf(r4,r5,r10);
	r4 = r0->inst;
	r5 = 7;
	r7 = 10;
	r6 = (double)r7;
	r8 = r2->reflections;
	r7 = 100;
	r9 = (double)r7;
	r8 = r8 / r9;
	r7 = 20;
	r9 = (double)r7;
	r8 = r8 / r9;
	r6 = hl_math_pow(r6,r8);
	r10 = (float)r6;
	openal_al_effectf(r4,r5,r10);
	r4 = r0->inst;
	r5 = 8;
	r6 = r2->reflectionsDelay;
	r10 = (float)r6;
	openal_al_effectf(r4,r5,r10);
	r4 = r0->inst;
	r5 = 9;
	r7 = 10;
	r6 = (double)r7;
	r8 = r2->reverb;
	r7 = 100;
	r9 = (double)r7;
	r8 = r8 / r9;
	r7 = 20;
	r9 = (double)r7;
	r8 = r8 / r9;
	r6 = hl_math_pow(r6,r8);
	r10 = (float)r6;
	openal_al_effectf(r4,r5,r10);
	r4 = r0->inst;
	r5 = 10;
	r6 = r2->reverbDelay;
	r10 = (float)r6;
	openal_al_effectf(r4,r5,r10);
	r4 = r0->inst;
	r5 = 2;
	r6 = r2->diffusion;
	r8 = 100.;
	r6 = r6 / r8;
	r10 = (float)r6;
	openal_al_effectf(r4,r5,r10);
	r4 = r0->inst;
	r5 = 1;
	r6 = r2->density;
	r8 = 100.;
	r6 = r6 / r8;
	r10 = (float)r6;
	openal_al_effectf(r4,r5,r10);
	r4 = r0->slot;
	r5 = 1;
	r7 = r0->inst;
	openal_al_auxiliary_effect_sloti(r4,r5,r7);
	r4 = r0->slot;
	r5 = 2;
	r6 = r2->wetDryMix;
	r8 = 100.;
	r6 = r6 / r8;
	r10 = (float)r6;
	openal_al_auxiliary_effect_slotf(r4,r5,r10);
	r6 = r2->decayTime;
	r8 = r2->reflectionsDelay;
	r6 = r6 + r8;
	r8 = r2->reverbDelay;
	r6 = r6 + r8;
	r2->retainTime = r6;
	return;
}

void hxd_snd_openal_ReverbDriver_bind(hxd__snd__openal__ReverbDriver r0,vdynamic* r1,hxd__snd__openal__SourceHandle r2) {
	String r8;
	hxd__snd__effect__Reverb r3;
	hxd__snd__openal__Driver r7;
	int r5, r6;
	r3 = (hxd__snd__effect__Reverb)hl_dyn_castp(&r1,&type$9,&type$3805);
	if( r2 == NULL ) hl_null_access();
	r5 = hxd_snd_openal_SourceHandle_acquireAuxiliarySend(r2,((hxd__snd__Effect)r3));
	r6 = 1;
	r5 = r5 + r6;
	r7 = r0->driver;
	if( r7 == NULL ) hl_null_access();
	r6 = r7->maxAuxiliarySends;
	if( r6 >= r5 ) goto label$3825$11;
	r8 = (String)global$1342;
	hl_throw((vdynamic*)r8);
	label$3825$11:
	return;
}

void hxd_snd_openal_ReverbDriver_apply(hxd__snd__openal__ReverbDriver r0,vdynamic* r1,hxd__snd__openal__SourceHandle r2) {
	bool r8;
	hxd__snd__effect__$Reverb r6;
	hxd__snd__effect__Reverb r3, r7;
	int r5, r9, r10, r11, r12;
	r3 = (hxd__snd__effect__Reverb)hl_dyn_castp(&r1,&type$9,&type$3805);
	if( r2 == NULL ) hl_null_access();
	r6 = (hxd__snd__effect__$Reverb)global$1328;
	r8 = hl_BaseType_check(((hl__BaseType)r6),((vdynamic*)r3));
	if( !r8 ) goto label$3826$7;
	r7 = r3;
	goto label$3826$8;
	label$3826$7:
	r7 = NULL;
	label$3826$8:
	r5 = hxd_snd_openal_SourceHandle_getAuxiliarySend(r2,((hxd__snd__Effect)r7));
	r9 = r2->inst;
	r10 = 131078;
	r11 = r0->slot;
	r12 = 0;
	openal_al_source3i(r9,r10,r11,r5,r12);
	return;
}

void hxd_snd_openal_ReverbDriver_unbind(hxd__snd__openal__ReverbDriver r0,vdynamic* r1,hxd__snd__openal__SourceHandle r2) {
	hxd__snd__effect__Reverb r3;
	int r5, r6, r7, r8, r9;
	r3 = (hxd__snd__effect__Reverb)hl_dyn_castp(&r1,&type$9,&type$3805);
	if( r2 == NULL ) hl_null_access();
	r5 = hxd_snd_openal_SourceHandle_releaseAuxiliarySend(r2,((hxd__snd__Effect)r3));
	r6 = r2->inst;
	r7 = 131078;
	r8 = 0;
	r9 = 0;
	openal_al_source3i(r6,r7,r8,r5,r9);
	return;
}

void hxd_snd_openal_ReverbDriver_new(hxd__snd__openal__ReverbDriver r0,hxd__snd__openal__Driver r1) {
	hxd__snd__effect__LowPass r3;
	hxd_snd_EffectDriver_new(((hxd__snd__EffectDriver)r0));
	r0->driver = r1;
	r3 = (hxd__snd__effect__LowPass)hl_alloc_obj(hxd__snd__effect__LowPass__val);
	hxd_snd_effect_LowPass_new(r3);
	r0->dryFilter = r3;
	return;
}

