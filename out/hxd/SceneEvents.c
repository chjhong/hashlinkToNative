// Generated by HLC 4.0.0 (HL v4)
#include <hl/code.h>

void hxd_SceneEvents_onRemove(hxd__SceneEvents r0,vvirtual* r1) {
	hl__types__ArrayObj r9;
	vvirtual *r3, *r4;
	venum *r7;
	bool r8;
	hxd__$System r6;
	vclosure *r5;
	r4 = r0->currentFocus;
	if( r1 != r4 && (!r1 || !r4 || !r1->value || !r4->value || r1->value != r4->value) ) goto label$609$4;
	r3 = NULL;
	r0->currentFocus = r3;
	label$609$4:
	r4 = r0->currentOver;
	if( r1 != r4 && (!r1 || !r4 || !r1->value || !r4->value || r1->value != r4->value) ) goto label$609$13;
	r3 = NULL;
	r0->currentOver = r3;
	r6 = (hxd__$System)global$409;
	r5 = r6->setCursor;
	if( r5 == NULL ) hl_null_access();
	r7 = (venum*)global$410;
	r5->hasValue ? ((void (*)(vdynamic*,venum*))r5->fun)((vdynamic*)r5->value,r7) : ((void (*)(venum*))r5->fun)(r7);
	label$609$13:
	r9 = r0->pushList;
	if( r9 == NULL ) hl_null_access();
	r8 = hl_types_ArrayObj_remove(r9,((vdynamic*)r1));
	return;
}

void hxd_SceneEvents_addScene(hxd__SceneEvents r0,vvirtual* r1,vdynamic* r2) {
	hl__types__ArrayObj r5;
	int r4;
	if( r1 == NULL ) hl_null_access();
	if( hl_vfields(r1)[0] ) ((void (*)(vdynamic*,hxd__SceneEvents))hl_vfields(r1)[0])(r1->value,r0); else {
		void *args[] = {r0};
		hl_dyn_call_obj(r1->value,&type$1319,-166607781/*setEvents*/,args,NULL);
	}
	if( r2 ) goto label$610$7;
	r5 = r0->scenes;
	if( r5 == NULL ) hl_null_access();
	r4 = hl_types_ArrayObj_push(r5,((vdynamic*)r1));
	goto label$610$11;
	label$610$7:
	r5 = r0->scenes;
	if( r5 == NULL ) hl_null_access();
	r4 = r2 ? r2->v.i : 0;
	hl_types_ArrayObj_insert(r5,r4,((vdynamic*)r1));
	label$610$11:
	return;
}

void hxd_SceneEvents_removeScene(hxd__SceneEvents r0,vvirtual* r1) {
	hl__types__ArrayObj r4;
	bool r3;
	hxd__SceneEvents r5;
	r4 = r0->scenes;
	if( r4 == NULL ) hl_null_access();
	r3 = hl_types_ArrayObj_remove(r4,((vdynamic*)r1));
	if( !r3 ) goto label$611$7;
	if( r1 == NULL ) hl_null_access();
	r5 = NULL;
	if( hl_vfields(r1)[0] ) ((void (*)(vdynamic*,hxd__SceneEvents))hl_vfields(r1)[0])(r1->value,r5); else {
		void *args[] = {r5};
		hl_dyn_call_obj(r1->value,&type$1319,-166607781/*setEvents*/,args,NULL);
	}
	label$611$7:
	return;
}

void hxd_SceneEvents_dispose(hxd__SceneEvents r0) {
	hxd__Window r2;
	vclosure *r3;
	r2 = r0->window;
	if( r2 == NULL ) hl_null_access();
	r3 = hl_alloc_closure_ptr(&type$3304,hxd_SceneEvents_onEvent,r0);
	hxd_Window_removeEventTarget(r2,r3);
	return;
}

void hxd_SceneEvents_focus(hxd__SceneEvents r0,vvirtual* r1) {
	vvirtual *r3;
	venum *r5;
	bool r8;
	hxd__Event r4;
	double *r6, *r7;
	r3 = r0->currentFocus;
	if( r3 != r1 && (!r3 || !r1 || !r3->value || !r1->value || r3->value != r1->value) ) goto label$613$3;
	return;
	label$613$3:
	if( r1 ) goto label$613$6;
	hxd_SceneEvents_blur(r0);
	return;
	label$613$6:
	r3 = r0->currentFocus;
	if( !r3 ) goto label$613$12;
	hxd_SceneEvents_blur(r0);
	r3 = r0->currentFocus;
	if( !r3 ) goto label$613$12;
	return;
	label$613$12:
	r4 = (hxd__Event)hl_alloc_obj(hxd__Event__val);
	r5 = (venum*)global$960;
	r6 = NULL;
	r7 = NULL;
	hxd_Event_new(r4,r5,r6,r7);
	if( r1 == NULL ) hl_null_access();
	if( hl_vfields(r1)[0] ) ((void (*)(vdynamic*,hxd__Event))hl_vfields(r1)[0])(r1->value,r4); else {
		void *args[] = {r4};
		hl_dyn_call_obj(r1->value,&type$676,135164887/*handleEvent*/,args,NULL);
	}
	r8 = r4->cancel;
	if( r8 ) goto label$613$22;
	r0->currentFocus = r1;
	label$613$22:
	return;
}

void hxd_SceneEvents_blur(hxd__SceneEvents r0) {
	vvirtual *r2;
	bool r4;
	hxd__Event r3;
	r2 = r0->currentFocus;
	if( r2 ) goto label$614$3;
	return;
	label$614$3:
	r3 = r0->focusLost;
	if( r3 == NULL ) hl_null_access();
	r4 = false;
	r3->cancel = r4;
	r2 = r0->currentFocus;
	if( r2 == NULL ) hl_null_access();
	r3 = r0->focusLost;
	if( hl_vfields(r2)[0] ) ((void (*)(vdynamic*,hxd__Event))hl_vfields(r2)[0])(r2->value,r3); else {
		void *args[] = {r3};
		hl_dyn_call_obj(r2->value,&type$676,135164887/*handleEvent*/,args,NULL);
	}
	r3 = r0->focusLost;
	if( r3 == NULL ) hl_null_access();
	r4 = r3->cancel;
	if( r4 ) goto label$614$17;
	r2 = NULL;
	r0->currentFocus = r2;
	label$614$17:
	return;
}

void hxd_SceneEvents_checkFocus(hxd__SceneEvents r0) {
	vvirtual *r2, *r3;
	bool r4;
	r2 = r0->currentFocus;
	if( r2 ) goto label$615$3;
	return;
	label$615$3:
	r2 = r0->currentFocus;
	if( r2 == NULL ) hl_null_access();
	if( hl_vfields(r2)[1] ) r3 = ((vvirtual* (*)(vdynamic*))hl_vfields(r2)[1])(r2->value); else {
		r3 = (vvirtual*)hl_dyn_call_obj(r2->value,&type$1317,148300234/*getInteractiveScene*/,NULL,NULL);
	}
	if( r3 ) goto label$615$10;
	r2 = NULL;
	r0->currentFocus = r2;
	return;
	label$615$10:
	if( r3 == NULL ) hl_null_access();
	r2 = r0->currentFocus;
	if( hl_vfields(r3)[1] ) r4 = ((bool (*)(vdynamic*,vvirtual*))hl_vfields(r3)[1])(r3->value,r2); else {
		void *args[] = {r2};
		vdynamic ret;
		hl_dyn_call_obj(r3->value,&type$1320,-56589131/*isInteractiveVisible*/,args,&ret);
		r4 = (bool)ret.v.i;
	}
	if( r4 ) goto label$615$15;
	hxd_SceneEvents_blur(r0);
	label$615$15:
	return;
}

void hxd_SceneEvents_emitEvent(hxd__SceneEvents r0,hxd__Event r1) {
	hl__types__ArrayObj r17, r20;
	vvirtual *r13, *r21, *r23, *r24, *r25;
	venum *r11, *r26;
	bool r6, r7, r8, r9, r12, r27;
	hxd__Event r3, r14;
	double r2, r5, r15;
	vdynamic *r16;
	varray *r22;
	int r10, r18, r19;
	if( r1 == NULL ) hl_null_access();
	r2 = r1->relX;
	r5 = r1->relY;
	r6 = false;
	r7 = false;
	r8 = false;
	r9 = false;
	r11 = r1->kind;
	if( r11 == NULL ) hl_null_access();
	r10 = HL__ENUM_INDEX__(r11);
	switch(r10) {
		default:
		case 3:
		case 4:
		case 6:
		case 7:
		case 10:
			goto label$616$37;
		case 0:
			r12 = true;
			r9 = r12;
			r12 = true;
			r8 = r12;
			goto label$616$37;
		case 1:
			r12 = true;
			r8 = r12;
			goto label$616$37;
		case 5:
		case 8:
		case 9:
		case 11:
			r13 = r0->currentFocus;
			if( !r13 ) goto label$616$34;
			r10 = 0;
			r15 = (double)r10;
			r1->relY = r15;
			r1->relX = r15;
			r13 = r0->currentFocus;
			if( r13 == NULL ) hl_null_access();
			if( hl_vfields(r13)[0] ) ((void (*)(vdynamic*,hxd__Event))hl_vfields(r13)[0])(r13->value,r1); else {
				void *args[] = {r1};
				hl_dyn_call_obj(r13->value,&type$676,135164887/*handleEvent*/,args,NULL);
			}
			r1->relX = r2;
			r1->relY = r5;
			r12 = r1->propagate;
			if( r12 ) goto label$616$34;
			return;
			label$616$34:
			goto label$616$37;
		case 2:
		case 12:
			r12 = true;
			r7 = r12;
	}
	label$616$37:
	r10 = 0;
	r17 = r0->scenes;
	label$616$39:
	if( r17 == NULL ) hl_null_access();
	r19 = r17->length;
	if( r10 >= r19 ) goto label$616$137;
	r18 = r10;
	++r10;
	r19 = r17->length;
	if( ((unsigned)r18) < ((unsigned)r19) ) goto label$616$49;
	r21 = NULL;
	goto label$616$52;
	label$616$49:
	r22 = r17->array;
	r16 = ((vdynamic**)(r22 + 1))[r18];
	r21 = hl_to_virtual(&type$1318,(vdynamic*)r16);
	label$616$52:
	r13 = NULL;
	label$616$53:
	r12 = true;
	if( !r12 ) goto label$616$134;
	if( r21 == NULL ) hl_null_access();
	if( hl_vfields(r21)[2] ) r23 = ((vvirtual* (*)(vdynamic*,hxd__Event,vvirtual*))hl_vfields(r21)[2])(r21->value,r1,r13); else {
		void *args[] = {r1,r13};
		r23 = (vvirtual*)hl_dyn_call_obj(r21->value,&type$1321,135164887/*handleEvent*/,args,NULL);
	}
	if( r23 ) goto label$616$63;
	if( r1 == NULL ) hl_null_access();
	r1->relX = r2;
	r1->relY = r5;
	goto label$616$134;
	label$616$63:
	if( !r7 ) goto label$616$105;
	r24 = r0->currentOver;
	if( r24 == r23 || (r24 && r23 && r24->value && r23->value && r24->value == r23->value) ) goto label$616$102;
	r3 = r0->onOut;
	if( r3 == NULL ) hl_null_access();
	r12 = false;
	r3->cancel = r12;
	r24 = r0->currentOver;
	if( !r24 ) goto label$616$76;
	r24 = r0->currentOver;
	if( r24 == NULL ) hl_null_access();
	r3 = r0->onOut;
	if( hl_vfields(r24)[0] ) ((void (*)(vdynamic*,hxd__Event))hl_vfields(r24)[0])(r24->value,r3); else {
		void *args[] = {r3};
		hl_dyn_call_obj(r24->value,&type$676,135164887/*handleEvent*/,args,NULL);
	}
	label$616$76:
	r3 = r0->onOut;
	if( r3 == NULL ) hl_null_access();
	r12 = r3->cancel;
	if( r12 ) goto label$616$101;
	if( r1 == NULL ) hl_null_access();
	r12 = r1->propagate;
	r11 = r1->kind;
	r26 = (venum*)global$961;
	r1->kind = r26;
	r27 = false;
	r1->cancel = r27;
	if( r23 == NULL ) hl_null_access();
	if( hl_vfields(r23)[0] ) ((void (*)(vdynamic*,hxd__Event))hl_vfields(r23)[0])(r23->value,r1); else {
		void *args[] = {r1};
		hl_dyn_call_obj(r23->value,&type$676,135164887/*handleEvent*/,args,NULL);
	}
	r27 = r1->cancel;
	if( !r27 ) goto label$616$94;
	r24 = NULL;
	r0->currentOver = r24;
	goto label$616$97;
	label$616$94:
	r0->currentOver = r23;
	r27 = false;
	r7 = r27;
	label$616$97:
	r1->kind = r11;
	r27 = false;
	r1->cancel = r27;
	r1->propagate = r12;
	label$616$101:
	goto label$616$104;
	label$616$102:
	r12 = false;
	r7 = r12;
	label$616$104:
	goto label$616$122;
	label$616$105:
	if( !r8 ) goto label$616$117;
	if( r1 == NULL ) hl_null_access();
	r11 = r1->kind;
	r26 = (venum*)global$962;
	if( r11 != r26 ) goto label$616$114;
	r20 = r0->pushList;
	if( r20 == NULL ) hl_null_access();
	r18 = hl_types_ArrayObj_push(r20,((vdynamic*)r23));
	goto label$616$117;
	label$616$114:
	r20 = r0->pushList;
	if( r20 == NULL ) hl_null_access();
	r12 = hl_types_ArrayObj_remove(r20,((vdynamic*)r23));
	label$616$117:
	if( !r9 ) goto label$616$122;
	r25 = r0->currentFocus;
	if( r23 != r25 && (!r23 || !r25 || !r23->value || !r25->value || r23->value != r25->value) ) goto label$616$122;
	r12 = false;
	r9 = r12;
	label$616$122:
	if( r1 == NULL ) hl_null_access();
	r1->relX = r2;
	r1->relY = r5;
	r12 = r1->propagate;
	if( r12 ) goto label$616$130;
	r12 = true;
	r6 = r12;
	goto label$616$134;
	label$616$130:
	r13 = r23;
	r12 = false;
	r1->propagate = r12;
	goto label$616$53;
	label$616$134:
	if( !r6 ) goto label$616$136;
	goto label$616$137;
	label$616$136:
	goto label$616$39;
	label$616$137:
	if( !r9 ) goto label$616$141;
	r13 = r0->currentFocus;
	if( !r13 ) goto label$616$141;
	hxd_SceneEvents_blur(r0);
	label$616$141:
	if( !r7 ) goto label$616$158;
	r13 = r0->currentOver;
	if( !r13 ) goto label$616$158;
	r3 = r0->onOut;
	if( r3 == NULL ) hl_null_access();
	r12 = false;
	r3->cancel = r12;
	r13 = r0->currentOver;
	if( r13 == NULL ) hl_null_access();
	r3 = r0->onOut;
	if( hl_vfields(r13)[0] ) ((void (*)(vdynamic*,hxd__Event))hl_vfields(r13)[0])(r13->value,r3); else {
		void *args[] = {r3};
		hl_dyn_call_obj(r13->value,&type$676,135164887/*handleEvent*/,args,NULL);
	}
	r3 = r0->onOut;
	if( r3 == NULL ) hl_null_access();
	r12 = r3->cancel;
	if( r12 ) goto label$616$158;
	r13 = NULL;
	r0->currentOver = r13;
	label$616$158:
	if( r6 ) goto label$616$178;
	r14 = r0->checkPos;
	if( r1 == r14 ) goto label$616$178;
	if( r1 == NULL ) hl_null_access();
	r11 = r1->kind;
	r26 = (venum*)global$962;
	if( r11 != r26 ) goto label$616$170;
	r17 = r0->pushList;
	if( r17 == NULL ) hl_null_access();
	r13 = NULL;
	r10 = hl_types_ArrayObj_push(r17,((vdynamic*)r13));
	goto label$616$177;
	label$616$170:
	r11 = r1->kind;
	r26 = (venum*)global$411;
	if( r11 != r26 ) goto label$616$177;
	r17 = r0->pushList;
	if( r17 == NULL ) hl_null_access();
	r13 = NULL;
	r12 = hl_types_ArrayObj_remove(r17,((vdynamic*)r13));
	label$616$177:
	hxd_SceneEvents_dispatchListeners(r0,r1);
	label$616$178:
	if( r1 == NULL ) hl_null_access();
	r11 = r1->kind;
	r26 = (venum*)global$411;
	if( r11 != r26 ) goto label$616$221;
	r17 = r0->pushList;
	if( r17 == NULL ) hl_null_access();
	r10 = r17->length;
	r18 = 0;
	if( r18 >= r10 ) goto label$616$221;
	r10 = 0;
	r17 = r0->pushList;
	label$616$189:
	if( r17 == NULL ) hl_null_access();
	r19 = r17->length;
	if( r10 >= r19 ) goto label$616$218;
	r19 = r17->length;
	if( ((unsigned)r10) < ((unsigned)r19) ) goto label$616$197;
	r13 = NULL;
	goto label$616$200;
	label$616$197:
	r22 = r17->array;
	r16 = ((vdynamic**)(r22 + 1))[r10];
	r13 = hl_to_virtual(&type$1316,(vdynamic*)r16);
	label$616$200:
	++r10;
	if( r13 ) goto label$616$204;
	hxd_SceneEvents_dispatchListeners(r0,r1);
	goto label$616$217;
	label$616$204:
	if( r13 == NULL ) hl_null_access();
	if( hl_vfields(r13)[1] ) r21 = ((vvirtual* (*)(vdynamic*))hl_vfields(r13)[1])(r13->value); else {
		r21 = (vvirtual*)hl_dyn_call_obj(r13->value,&type$1317,148300234/*getInteractiveScene*/,NULL,NULL);
	}
	if( r21 ) goto label$616$208;
	goto label$616$189;
	label$616$208:
	if( r1 == NULL ) hl_null_access();
	r11 = (venum*)global$412;
	r1->kind = r11;
	if( r21 == NULL ) hl_null_access();
	if( hl_vfields(r21)[4] ) ((void (*)(vdynamic*,hxd__Event,vvirtual*))hl_vfields(r21)[4])(r21->value,r1,r13); else {
		void *args[] = {r1,r13};
		hl_dyn_call_obj(r21->value,&type$1322,-429603205/*dispatchEvent*/,args,NULL);
	}
	r11 = (venum*)global$411;
	r1->kind = r11;
	r1->relX = r2;
	r1->relY = r5;
	label$616$217:
	goto label$616$189;
	label$616$218:
	r17 = (hl__types__ArrayObj)hl_alloc_obj(hl__types__ArrayObj__val);
	hl_types_ArrayObj_new(r17);
	r0->pushList = r17;
	label$616$221:
	return;
}

void hxd_SceneEvents_checkEvents(hxd__SceneEvents r0) {
	vvirtual *r5, *r6, *r20;
	hl__types__ArrayObj r1, r8;
	venum *r17;
	hl_type *r11;
	bool r3, r4, r19;
	hxd__Event r13;
	vclosure *r23;
	double r15, r16, r18;
	vdynamic *r14, *r21, *r22;
	varray *r10;
	int r7, r9, r12;
	r1 = r0->pendingEvents;
	r3 = false;
	r5 = r0->currentFocus;
	r6 = NULL;
	if( r5 == r6 || (r5 && r6 && r5->value && r6->value && r5->value == r6->value) ) goto label$617$7;
	r4 = false;
	goto label$617$8;
	label$617$7:
	r4 = true;
	label$617$8:
	if( r1 == NULL ) hl_null_access();
	r7 = r1->length;
	r9 = 0;
	if( r9 >= r7 ) goto label$617$92;
	r11 = &type$677;
	r7 = 0;
	r10 = hl_alloc_array(r11,r7);
	r8 = hl_types_ArrayObj_alloc(r10);
	r0->pendingEvents = r8;
	r7 = 0;
	label$617$18:
	if( r1 == NULL ) hl_null_access();
	r12 = r1->length;
	if( r7 >= r12 ) goto label$617$92;
	r12 = r1->length;
	if( ((unsigned)r7) < ((unsigned)r12) ) goto label$617$26;
	r13 = NULL;
	goto label$617$29;
	label$617$26:
	r10 = r1->array;
	r14 = ((vdynamic**)(r10 + 1))[r7];
	r13 = (hxd__Event)r14;
	label$617$29:
	++r7;
	if( r13 == NULL ) hl_null_access();
	r15 = r13->relX;
	r16 = r13->relY;
	r17 = r13->kind;
	if( r17 == NULL ) hl_null_access();
	r9 = HL__ENUM_INDEX__(r17);
	switch(r9) {
		default:
		case 3:
		case 4:
		case 6:
		case 7:
		case 10:
			goto label$617$58;
		case 0:
		case 1:
			r18 = r13->relX;
			r0->mouseX = r18;
			r18 = r13->relY;
			r0->mouseY = r18;
			r9 = r13->touchId;
			r0->lastTouch = r9;
			goto label$617$58;
		case 2:
			r19 = true;
			r3 = r19;
			r18 = r13->relX;
			r0->mouseX = r18;
			r18 = r13->relY;
			r0->mouseY = r18;
			r9 = r13->touchId;
			r0->lastTouch = r9;
			goto label$617$58;
		case 5:
		case 8:
		case 9:
		case 11:
			if( r4 ) goto label$617$58;
			r19 = true;
			r4 = r19;
			hxd_SceneEvents_checkFocus(r0);
	}
	label$617$58:
	r20 = r0->currentDrag;
	if( !r20 ) goto label$617$90;
	r20 = r0->currentDrag;
	if( r20 == NULL ) hl_null_access();
	r21 = hl_vfields(r20)[0] ? (*(vdynamic**)(hl_vfields(r20)[0])) : (vdynamic*)hl_dyn_getp(r20->value,5691731/*ref*/,&type$127);
	if( !r21 ) goto label$617$70;
	r20 = r0->currentDrag;
	if( r20 == NULL ) hl_null_access();
	r21 = hl_vfields(r20)[0] ? (*(vdynamic**)(hl_vfields(r20)[0])) : (vdynamic*)hl_dyn_getp(r20->value,5691731/*ref*/,&type$127);
	r9 = r13->touchId;
	r22 = hl_alloc_dynamic(&type$3);
	r22->v.i = r9;
	if( r21 != r22 && (!r21 || !r22 || (r21->v.i != r22->v.i)) ) goto label$617$90;
	label$617$70:
	r19 = false;
	r13->propagate = r19;
	r19 = false;
	r13->cancel = r19;
	r20 = r0->currentDrag;
	if( r20 == NULL ) hl_null_access();
	r23 = (vclosure*)hl_dyn_getp((vdynamic*)r20,102/*f*/,&type$676);
	if( r23 == NULL ) hl_null_access();
	r23->hasValue ? ((void (*)(vdynamic*,hxd__Event))r23->fun)((vdynamic*)r23->value,r13) : ((void (*)(hxd__Event))r23->fun)(r13);
	r13->relX = r15;
	r13->relY = r16;
	r19 = r13->cancel;
	if( r19 ) goto label$617$85;
	r19 = r13->propagate;
	if( !r19 ) goto label$617$90;
	label$617$85:
	r19 = false;
	r13->cancel = r19;
	r19 = false;
	r13->propagate = r19;
	goto label$617$18;
	label$617$90:
	hxd_SceneEvents_emitEvent(r0,r13);
	goto label$617$18;
	label$617$92:
	if( r4 ) goto label$617$94;
	hxd_SceneEvents_checkFocus(r0);
	label$617$94:
	if( r3 ) goto label$617$119;
	r20 = r0->currentDrag;
	if( r20 ) goto label$617$119;
	r13 = r0->checkPos;
	if( r13 == NULL ) hl_null_access();
	r15 = r0->mouseX;
	r13->relX = r15;
	r13 = r0->checkPos;
	if( r13 == NULL ) hl_null_access();
	r15 = r0->mouseY;
	r13->relY = r15;
	r13 = r0->checkPos;
	if( r13 == NULL ) hl_null_access();
	r7 = r0->lastTouch;
	r13->touchId = r7;
	r13 = r0->checkPos;
	if( r13 == NULL ) hl_null_access();
	r19 = false;
	r13->cancel = r19;
	r13 = r0->checkPos;
	if( r13 == NULL ) hl_null_access();
	r19 = false;
	r13->propagate = r19;
	r13 = r0->checkPos;
	hxd_SceneEvents_emitEvent(r0,r13);
	label$617$119:
	return;
}

void hxd_SceneEvents_startDrag(hxd__SceneEvents r0,vclosure* r1,vclosure* r2,hxd__Event r3) {
	vdynobj *r7;
	vvirtual *r5;
	vclosure *r6;
	vdynamic *r8;
	int r9;
	r5 = r0->currentDrag;
	if( !r5 ) goto label$618$11;
	r5 = r0->currentDrag;
	if( r5 == NULL ) hl_null_access();
	r6 = (vclosure*)hl_dyn_getp((vdynamic*)r5,-136256918/*onCancel*/,&type$65);
	if( !r6 ) goto label$618$11;
	r5 = r0->currentDrag;
	if( r5 == NULL ) hl_null_access();
	r6 = (vclosure*)hl_dyn_getp((vdynamic*)r5,-136256918/*onCancel*/,&type$65);
	if( r6 == NULL ) hl_null_access();
	r6->hasValue ? ((void (*)(vdynamic*))r6->fun)((vdynamic*)r6->value) : ((void (*)(void))r6->fun)();
	label$618$11:
	r7 = hl_alloc_dynobj();
	hl_dyn_setp((vdynamic*)r7,102/*f*/,&type$676,r1);
	if( r3 ) goto label$618$16;
	r8 = NULL;
	goto label$618$19;
	label$618$16:
	if( r3 == NULL ) hl_null_access();
	r9 = r3->touchId;
	r8 = hl_alloc_dynamic(&type$3);
	r8->v.i = r9;
	label$618$19:
	hl_dyn_setp((vdynamic*)r7,5691731/*ref*/,&type$127,r8);
	hl_dyn_setp((vdynamic*)r7,-136256918/*onCancel*/,&type$65,r2);
	r5 = hl_to_virtual(&type$1323,(vdynamic*)r7);
	r0->currentDrag = r5;
	return;
}

void hxd_SceneEvents_stopDrag(hxd__SceneEvents r0) {
	vvirtual *r1;
	r1 = NULL;
	r0->currentDrag = r1;
	return;
}

vvirtual* hxd_SceneEvents_getFocus(hxd__SceneEvents r0) {
	vvirtual *r1;
	r1 = r0->currentFocus;
	return r1;
}

void hxd_SceneEvents_onEvent(hxd__SceneEvents r0,hxd__Event r1) {
	hl__types__ArrayObj r3;
	int r2;
	r3 = r0->pendingEvents;
	if( r3 == NULL ) hl_null_access();
	r2 = hl_types_ArrayObj_push(r3,((vdynamic*)r1));
	return;
}

void hxd_SceneEvents_dispatchListeners(hxd__SceneEvents r0,hxd__Event r1) {
	vvirtual *r10;
	hl__types__ArrayObj r7;
	bool r5;
	double r2, r4;
	vdynamic *r11;
	varray *r12;
	int r6, r8, r9;
	if( r1 == NULL ) hl_null_access();
	r2 = r1->relX;
	r4 = r1->relY;
	r5 = true;
	r1->propagate = r5;
	r6 = 0;
	r7 = r0->scenes;
	label$622$7:
	if( r7 == NULL ) hl_null_access();
	r9 = r7->length;
	if( r6 >= r9 ) goto label$622$31;
	r8 = r6;
	++r6;
	r9 = r7->length;
	if( ((unsigned)r8) < ((unsigned)r9) ) goto label$622$17;
	r10 = NULL;
	goto label$622$20;
	label$622$17:
	r12 = r7->array;
	r11 = ((vdynamic**)(r12 + 1))[r8];
	r10 = hl_to_virtual(&type$1318,(vdynamic*)r11);
	label$622$20:
	if( r1 == NULL ) hl_null_access();
	r5 = false;
	r1->cancel = r5;
	if( r10 == NULL ) hl_null_access();
	if( hl_vfields(r10)[3] ) ((void (*)(vdynamic*,hxd__Event))hl_vfields(r10)[3])(r10->value,r1); else {
		void *args[] = {r1};
		hl_dyn_call_obj(r10->value,&type$676,-181481893/*dispatchListeners*/,args,NULL);
	}
	r1->relX = r2;
	r1->relY = r4;
	r5 = r1->propagate;
	if( r5 ) goto label$622$30;
	goto label$622$31;
	label$622$30:
	goto label$622$7;
	label$622$31:
	return;
}

void hxd_SceneEvents_new(hxd__SceneEvents r0,hxd__Window r1) {
	hl__types__ArrayObj r9;
	hl_type *r11;
	venum *r3;
	hxd__Window r12;
	hxd__Event r2;
	vclosure *r13;
	double r8;
	double *r4, *r5;
	varray *r10;
	int r7;
	r2 = (hxd__Event)hl_alloc_obj(hxd__Event__val);
	r3 = (venum*)global$957;
	r4 = NULL;
	r5 = NULL;
	hxd_Event_new(r2,r3,r4,r5);
	r0->onOut = r2;
	r2 = (hxd__Event)hl_alloc_obj(hxd__Event__val);
	r3 = (venum*)global$958;
	r4 = NULL;
	r5 = NULL;
	hxd_Event_new(r2,r3,r4,r5);
	r0->checkPos = r2;
	r2 = (hxd__Event)hl_alloc_obj(hxd__Event__val);
	r3 = (venum*)global$959;
	r4 = NULL;
	r5 = NULL;
	hxd_Event_new(r2,r3,r4,r5);
	r0->focusLost = r2;
	r7 = 0;
	r0->lastTouch = r7;
	r8 = -1.;
	r0->mouseY = r8;
	r8 = -1.;
	r0->mouseX = r8;
	r11 = &type$1318;
	r7 = 0;
	r10 = hl_alloc_array(r11,r7);
	r9 = hl_types_ArrayObj_alloc(r10);
	r0->scenes = r9;
	r11 = &type$677;
	r7 = 0;
	r10 = hl_alloc_array(r11,r7);
	r9 = hl_types_ArrayObj_alloc(r10);
	r0->pendingEvents = r9;
	r11 = &type$1316;
	r7 = 0;
	r10 = hl_alloc_array(r11,r7);
	r9 = hl_types_ArrayObj_alloc(r10);
	r0->pushList = r9;
	if( r1 ) goto label$626$42;
	r12 = hxd_Window_getInstance();
	r1 = r12;
	label$626$42:
	r0->window = r1;
	if( r1 == NULL ) hl_null_access();
	r13 = hl_alloc_closure_ptr(&type$3304,hxd_SceneEvents_onEvent,r0);
	hxd_Window_addEventTarget(r1,r13);
	return;
}

