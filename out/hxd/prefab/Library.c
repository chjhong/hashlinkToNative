// Generated by HLC 4.0.0 (HL v4)
#include <hl/code.h>

void hxd_prefab_Library_load(hxd__prefab__Library r0,vdynamic* r1) {
	bool r3;
	hl__types__ArrayDyn r5;
	vdynamic *r4;
	hxd__prefab__Prefab r9;
	int r6, r7, r8;
	r3 = r0->inRec;
	if( !r3 ) goto label$3652$3;
	return;
	label$3652$3:
	if( r1 == NULL ) hl_null_access();
	r4 = (vdynamic*)hl_dyn_getp((vdynamic*)r1,275389134/*children*/,&type$9);
	r5 = (hl__types__ArrayDyn)hl_dyn_castp(&r4,&type$9,&type$321);
	if( !r5 ) goto label$3652$17;
	r6 = 0;
	label$3652$8:
	if( r5 == NULL ) hl_null_access();
	r8 = hl_types_ArrayDyn_get_length(r5);
	if( r6 >= r8 ) goto label$3652$17;
	r7 = r6;
	++r6;
	r4 = ((vdynamic* (*)(hl__types__ArrayDyn,int))r5->$type->vobj_proto[0])(r5,r7);
	r9 = hxd_prefab_Prefab_loadRec(r4,((hxd__prefab__Prefab)r0));
	goto label$3652$8;
	label$3652$17:
	return;
}

void hxd_prefab_Library_reload(hxd__prefab__Library r0,vdynamic* r1) {
	bool r2;
	r2 = true;
	r0->inRec = r2;
	hxd_prefab_Prefab_reload(((hxd__prefab__Prefab)r0),r1);
	r2 = false;
	r0->inRec = r2;
	return;
}

vdynamic* hxd_prefab_Library_save(hxd__prefab__Library r0) {
	vdynobj *r2;
	bool r1;
	vdynamic *r3;
	r1 = r0->inRec;
	if( !r1 ) goto label$3654$4;
	r2 = hl_alloc_dynobj();
	return ((vdynamic*)r2);
	label$3654$4:
	r1 = true;
	r0->inRec = r1;
	r3 = hxd_prefab_Prefab_saveRec(((hxd__prefab__Prefab)r0));
	r1 = false;
	r0->inRec = r1;
	return r3;
}

hxd__prefab__Context hxd_prefab_Library_makeInstance(hxd__prefab__Library r0,hxd__prefab__Context r1) {
	bool r2;
	hxd__prefab__Context r3;
	r2 = r0->inRec;
	if( !r2 ) goto label$3655$3;
	return r1;
	label$3655$3:
	r2 = true;
	r0->inRec = r2;
	r3 = hxd_prefab_Prefab_makeInstanceRec(((hxd__prefab__Prefab)r0),r1);
	r2 = false;
	r0->inRec = r2;
	return r1;
}

void hxd_prefab_Library_new(hxd__prefab__Library r0) {
	String r4;
	bool r1;
	hxd__prefab__Prefab r3;
	r1 = false;
	r0->inRec = r1;
	r3 = NULL;
	hxd_prefab_Prefab_new(((hxd__prefab__Prefab)r0),r3);
	r4 = (String)global$1270;
	r0->type = r4;
	return;
}

String hxd_prefab_Library_getPrefabType(String r0) {
	String r1, r4;
	haxe__ds__StringMap r5;
	hl__types__ArrayObj r3;
	hxd__prefab__$Library r6;
	vdynamic *r2;
	if( r0 == NULL ) hl_null_access();
	r4 = (String)global$210;
	r3 = String_split(r0,r4);
	if( r3 == NULL ) hl_null_access();
	r2 = hl_types_ArrayObj_pop(r3);
	r1 = (String)r2;
	if( r1 == NULL ) hl_null_access();
	r1 = String_toLowerCase(r1);
	r6 = (hxd__prefab__$Library)global$1266;
	r5 = r6->registeredExtensions;
	if( r5 == NULL ) hl_null_access();
	r2 = haxe_ds_StringMap_get(r5,r1);
	r4 = (String)r2;
	return r4;
}

hxd__prefab__Prefab hxd_prefab_Library_create(String r0) {
	bool *r16;
	String r1;
	hl__Class r6;
	hl__types__ArrayObj r14;
	vvirtual *r9;
	haxe__ds__StringMap r7;
	hl_type *r12;
	bool r15;
	hxd__prefab__$Library r8;
	hxd__prefab__Library r4;
	hl__types__ArrayDyn r10;
	vdynamic *r5;
	int r13;
	varray *r11;
	hxd__prefab__Prefab r3, r17;
	r1 = hxd_prefab_Library_getPrefabType(r0);
	if( r1 ) goto label$3647$6;
	r4 = (hxd__prefab__Library)hl_alloc_obj(hxd__prefab__Library__val);
	hxd_prefab_Library_new(r4);
	r3 = ((hxd__prefab__Prefab)r4);
	goto label$3647$23;
	label$3647$6:
	r8 = (hxd__prefab__$Library)global$1266;
	r7 = r8->registeredElements;
	if( r7 == NULL ) hl_null_access();
	r5 = haxe_ds_StringMap_get(r7,r1);
	r9 = hl_to_virtual(&type$3654,(vdynamic*)r5);
	if( r9 == NULL ) hl_null_access();
	r6 = hl_vfields(r9)[0] ? (*(hl__Class*)(hl_vfields(r9)[0])) : (hl__Class)hl_dyn_getp(r9->value,22185/*cl*/,&type$12);
	r12 = &type$9;
	r13 = 0;
	r11 = hl_alloc_array(r12,r13);
	r14 = hl_types_ArrayObj_alloc(r11);
	r15 = true;
	r16 = &r15;
	r10 = hl_types_ArrayDyn_alloc(((hl__types__ArrayBase)r14),r16);
	r5 = Type_createInstance(r6,r10);
	r17 = (hxd__prefab__Prefab)hl_dyn_castp(&r5,&type$9,&type$265);
	r3 = r17;
	label$3647$23:
	return r3;
}

bool hxd_prefab_Library_register(String r0,hl__Class r1,String r2) {
	vvirtual *r6;
	haxe__ds__StringMap r4;
	bool r7;
	hxd__prefab__$Library r5;
	r5 = (hxd__prefab__$Library)global$1266;
	r4 = r5->registeredElements;
	if( r4 == NULL ) hl_null_access();
	r6 = hl_alloc_virtual(&type$3654);
	if( hl_vfields(r6)[0] ) *(hl__Class*)(hl_vfields(r6)[0]) = (hl__Class)r1; else hl_dyn_setp(r6->value,22185/*cl*/,&type$12,r1);
	haxe_ds_StringMap_set(r4,r0,((vdynamic*)r6));
	if( !r2 ) goto label$3646$11;
	r5 = (hxd__prefab__$Library)global$1266;
	r4 = r5->registeredExtensions;
	if( r4 == NULL ) hl_null_access();
	haxe_ds_StringMap_set(r4,r2,((vdynamic*)r0));
	label$3646$11:
	r7 = true;
	return r7;
}

bool hxd_prefab_Library_isOfType(String r0,hl__Class r1) {
	hl__Class r7, r8;
	vvirtual *r5;
	haxe__ds__StringMap r3;
	bool r6;
	hxd__prefab__$Library r4;
	vdynamic *r2;
	r4 = (hxd__prefab__$Library)global$1266;
	r3 = r4->registeredElements;
	if( r3 == NULL ) hl_null_access();
	r2 = haxe_ds_StringMap_get(r3,r0);
	r5 = hl_to_virtual(&type$3654,(vdynamic*)r2);
	if( r5 ) goto label$3645$8;
	r6 = false;
	return r6;
	label$3645$8:
	if( r5 == NULL ) hl_null_access();
	r7 = hl_vfields(r5)[0] ? (*(hl__Class*)(hl_vfields(r5)[0])) : (hl__Class)hl_dyn_getp(r5->value,22185/*cl*/,&type$12);
	label$3645$10:
	if( !r7 ) goto label$3645$18;
	if( r7 != r1 ) goto label$3645$15;
	r6 = true;
	return r6;
	label$3645$15:
	r8 = Type_getSuperClass(r7);
	r7 = r8;
	goto label$3645$10;
	label$3645$18:
	r6 = false;
	return r6;
}

haxe__ds__StringMap hxd_prefab_Library_getRegistered() {
	haxe__ds__StringMap r0;
	hxd__prefab__$Library r1;
	r1 = (hxd__prefab__$Library)global$1266;
	r0 = r1->registeredElements;
	return r0;
}

