// Generated by HLC 4.0.0 (HL v4)
#include <hl/code.h>

hxd__fs__FileEntry hxd_fs_EmbedFileSystem_getRoot(hxd__fs__EmbedFileSystem r0) {
	String r2, r3, r4;
	hxd__fs___EmbedFileSystem__EmbedEntry r1;
	r1 = (hxd__fs___EmbedFileSystem__EmbedEntry)hl_alloc_obj(hxd__fs___EmbedFileSystem__EmbedEntry__val);
	r2 = (String)global$1229;
	r3 = (String)global$210;
	r4 = NULL;
	hxd_fs__EmbedFileSystem_EmbedEntry_new(r1,r0,r2,r3,r4);
	return ((hxd__fs__FileEntry)r1);
}

hl__types__ArrayObj hxd_fs_EmbedFileSystem_splitPath(hxd__fs__EmbedFileSystem r0,String r1) {
	String r2;
	hl__types__ArrayObj r3;
	hl_type *r5;
	int r6;
	varray *r4;
	r2 = (String)global$210;
	if( r1 != r2 && (!r1 || !r2 || String___compare(r1,(vdynamic*)r2) != 0) ) goto label$1776$7;
	r5 = &type$13;
	r6 = 0;
	r4 = hl_alloc_array(r5,r6);
	r3 = hl_types_ArrayObj_alloc(r4);
	return r3;
	label$1776$7:
	if( r1 == NULL ) hl_null_access();
	r2 = (String)global$207;
	r3 = String_split(r1,r2);
	return r3;
}

hl__types__ArrayObj hxd_fs_EmbedFileSystem_subFiles(hxd__fs__EmbedFileSystem r0,String r1) {
	String r6, r13, r17;
	hl__types__ArrayObj r5, r9;
	hl_type *r15;
	hxd__fs___EmbedFileSystem__EmbedEntry r16;
	vclosure *r14;
	vdynamic *r2, *r10, *r11;
	varray *r12;
	int r4, r7, r8;
	r2 = r0->root;
	r4 = 0;
	r5 = hxd_fs_EmbedFileSystem_splitPath(r0,r1);
	label$1777$3:
	if( r5 == NULL ) hl_null_access();
	r8 = r5->length;
	if( r4 >= r8 ) goto label$1777$19;
	r7 = r4;
	++r4;
	r8 = r5->length;
	if( ((unsigned)r7) < ((unsigned)r8) ) goto label$1777$13;
	r6 = NULL;
	goto label$1777$16;
	label$1777$13:
	r12 = r5->array;
	r11 = ((vdynamic**)(r12 + 1))[r7];
	r6 = (String)r11;
	label$1777$16:
	r10 = Reflect_field(r2,r6);
	r2 = r10;
	goto label$1777$3;
	label$1777$19:
	if( r2 ) goto label$1777$23;
	r13 = (String)global$1230;
	r6 = String___add__(r1,r13);
	hl_throw((vdynamic*)r6);
	label$1777$23:
	r5 = Reflect_fields(r2);
	if( r5 == NULL ) hl_null_access();
	r14 = &cl$1946;
	hl_types_ArrayObj_sort(r5,r14);
	r15 = &type$302;
	r4 = 0;
	r12 = hl_alloc_array(r15,r4);
	r9 = hl_types_ArrayObj_alloc(r12);
	r4 = 0;
	label$1777$32:
	if( r5 == NULL ) hl_null_access();
	r8 = r5->length;
	if( r4 >= r8 ) goto label$1777$55;
	r8 = r5->length;
	if( ((unsigned)r4) < ((unsigned)r8) ) goto label$1777$40;
	r6 = NULL;
	goto label$1777$43;
	label$1777$40:
	r12 = r5->array;
	r10 = ((vdynamic**)(r12 + 1))[r4];
	r6 = (String)r10;
	label$1777$43:
	++r4;
	if( r9 == NULL ) hl_null_access();
	r17 = (String)global$210;
	if( r1 != r17 && (!r1 || !r17 || String___compare(r1,(vdynamic*)r17) != 0) ) goto label$1777$49;
	r13 = r6;
	goto label$1777$52;
	label$1777$49:
	r17 = (String)global$207;
	r13 = String___add__(r1,r17);
	r13 = String___add__(r13,r6);
	label$1777$52:
	r16 = hxd_fs_EmbedFileSystem_get(r0,r13);
	r7 = hl_types_ArrayObj_push(r9,((vdynamic*)r16));
	goto label$1777$32;
	label$1777$55:
	return r9;
}

bool hxd_fs_EmbedFileSystem_isDirectory(hxd__fs__EmbedFileSystem r0,String r1) {
	String r5;
	hl__types__ArrayObj r4;
	bool r11;
	vdynamic *r2, *r8, *r9;
	varray *r10;
	int r3, r6, r7;
	r2 = r0->root;
	r3 = 0;
	r4 = hxd_fs_EmbedFileSystem_splitPath(r0,r1);
	label$1778$3:
	if( r4 == NULL ) hl_null_access();
	r7 = r4->length;
	if( r3 >= r7 ) goto label$1778$19;
	r6 = r3;
	++r3;
	r7 = r4->length;
	if( ((unsigned)r6) < ((unsigned)r7) ) goto label$1778$13;
	r5 = NULL;
	goto label$1778$16;
	label$1778$13:
	r10 = r4->array;
	r9 = ((vdynamic**)(r10 + 1))[r6];
	r5 = (String)r9;
	label$1778$16:
	r8 = Reflect_field(r2,r5);
	r2 = r8;
	goto label$1778$3;
	label$1778$19:
	if( !r2 ) goto label$1778$27;
	r11 = true;
	r9 = hl_alloc_dynbool(r11);
	{ int i = hl_dyn_compare((vdynamic*)r2,(vdynamic*)r9); if( i != 0 ) goto label$1778$25; };
	r11 = false;
	goto label$1778$26;
	label$1778$25:
	r11 = true;
	label$1778$26:
	return r11;
	label$1778$27:
	r11 = false;
	return r11;
}

bool hxd_fs_EmbedFileSystem_exists(hxd__fs__EmbedFileSystem r0,String r1) {
	String r5;
	hl__types__ArrayObj r4;
	bool r11;
	vdynamic *r2, *r8, *r9;
	varray *r10;
	int r3, r6, r7;
	r2 = r0->root;
	r3 = 0;
	r4 = hxd_fs_EmbedFileSystem_splitPath(r0,r1);
	label$1779$3:
	if( r4 == NULL ) hl_null_access();
	r7 = r4->length;
	if( r3 >= r7 ) goto label$1779$22;
	r6 = r3;
	++r3;
	r7 = r4->length;
	if( ((unsigned)r6) < ((unsigned)r7) ) goto label$1779$13;
	r5 = NULL;
	goto label$1779$16;
	label$1779$13:
	r10 = r4->array;
	r9 = ((vdynamic**)(r10 + 1))[r6];
	r5 = (String)r9;
	label$1779$16:
	r8 = Reflect_field(r2,r5);
	r2 = r8;
	if( r8 ) goto label$1779$21;
	r11 = false;
	return r11;
	label$1779$21:
	goto label$1779$3;
	label$1779$22:
	r11 = true;
	return r11;
}

hxd__fs___EmbedFileSystem__EmbedEntry hxd_fs_EmbedFileSystem_get(hxd__fs__EmbedFileSystem r0,String r1) {
	String r4, r9, r10;
	hl__types__ArrayObj r8;
	hxd__fs__NotFound r5;
	hxd__fs___EmbedFileSystem__EmbedEntry r7;
	bool r3;
	vdynamic *r6;
	r3 = hxd_fs_EmbedFileSystem_exists(r0,r1);
	if( r3 ) goto label$1780$5;
	r5 = (hxd__fs__NotFound)hl_alloc_obj(hxd__fs__NotFound__val);
	hxd_fs_NotFound_new(r5,r1);
	hl_throw((vdynamic*)r5);
	label$1780$5:
	r4 = hxd_fs_EmbedFileSystem_resolve(r1);
	r7 = (hxd__fs___EmbedFileSystem__EmbedEntry)hl_alloc_obj(hxd__fs___EmbedFileSystem__EmbedEntry__val);
	if( r1 == NULL ) hl_null_access();
	r10 = (String)global$207;
	r8 = String_split(r1,r10);
	if( r8 == NULL ) hl_null_access();
	r6 = hl_types_ArrayObj_pop(r8);
	r9 = (String)r6;
	hxd_fs__EmbedFileSystem_EmbedEntry_new(r7,r0,r9,r1,r4);
	return r7;
}

void hxd_fs_EmbedFileSystem_dispose(hxd__fs__EmbedFileSystem r0) {
	return;
}

hl__types__ArrayObj hxd_fs_EmbedFileSystem_dir(hxd__fs__EmbedFileSystem r0,String r1) {
	String r2;
	r2 = (String)global$1231;
	hl_throw((vdynamic*)r2);
}

void hxd_fs_EmbedFileSystem_new(hxd__fs__EmbedFileSystem r0,vdynamic* r1) {
	r0->root = r1;
	return;
}

String hxd_fs_EmbedFileSystem_resolve(String r0) {
	String r1, r2, r5;
	hxd__fs__$EmbedFileSystem r4;
	EReg r3;
	r1 = (String)global$1227;
	r4 = (hxd__fs__$EmbedFileSystem)global$153;
	r3 = r4->invalidChars;
	if( r3 == NULL ) hl_null_access();
	r5 = (String)global$1228;
	r2 = EReg_replace(r3,r0,r5);
	r1 = String___add__(r1,r2);
	return r1;
}

