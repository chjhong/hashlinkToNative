// Generated by HLC 4.0.0 (HL v4)
#include <hl/code.h>

int hxd_fs__LocalFileSystem_LocalEntry_getSign(hxd__fs___LocalFileSystem__LocalEntry r0) {
	venum *r6;
	sys__io__FileInput r2;
	int r1, r4, r5;
	r2 = r0->fread;
	if( r2 ) goto label$3569$4;
	r1 = -1;
	goto label$3569$7;
	label$3569$4:
	r2 = r0->fread;
	if( r2 == NULL ) hl_null_access();
	r1 = sys_io_FileInput_tell(r2);
	label$3569$7:
	hxd_fs__LocalFileSystem_LocalEntry_open(r0);
	r2 = r0->fread;
	if( r2 == NULL ) hl_null_access();
	r4 = haxe_io_Input_readInt32(((haxe__io__Input)r2));
	r5 = 0;
	if( r1 >= r5 ) goto label$3569$15;
	hxd_fs__LocalFileSystem_LocalEntry_close(r0);
	goto label$3569$19;
	label$3569$15:
	r2 = r0->fread;
	if( r2 == NULL ) hl_null_access();
	r6 = (venum*)global$1241;
	sys_io_FileInput_seek(r2,r1,r6);
	label$3569$19:
	return r4;
}

haxe__io__Bytes hxd_fs__LocalFileSystem_LocalEntry_getBytes(hxd__fs___LocalFileSystem__LocalEntry r0) {
	String r2;
	haxe__io__Bytes r1;
	r2 = r0->file;
	r1 = sys_io_File_getBytes(r2);
	return r1;
}

void hxd_fs__LocalFileSystem_LocalEntry_open(hxd__fs___LocalFileSystem__LocalEntry r0) {
	bool *r6;
	String r5;
	venum *r4;
	int r3;
	sys__io__FileInput r2;
	r2 = r0->fread;
	if( !r2 ) goto label$3571$8;
	r2 = r0->fread;
	if( r2 == NULL ) hl_null_access();
	r3 = 0;
	r4 = (venum*)global$1241;
	sys_io_FileInput_seek(r2,r3,r4);
	goto label$3571$12;
	label$3571$8:
	r5 = r0->file;
	r6 = NULL;
	r2 = sys_io_File_read(r5,r6);
	r0->fread = r2;
	label$3571$12:
	return;
}

void hxd_fs__LocalFileSystem_LocalEntry_skip(hxd__fs___LocalFileSystem__LocalEntry r0,int r1) {
	venum *r4;
	sys__io__FileInput r3;
	r3 = r0->fread;
	if( r3 == NULL ) hl_null_access();
	r4 = (venum*)global$1242;
	sys_io_FileInput_seek(r3,r1,r4);
	return;
}

int hxd_fs__LocalFileSystem_LocalEntry_readByte(hxd__fs___LocalFileSystem__LocalEntry r0) {
	sys__io__FileInput r2;
	int r1;
	r2 = r0->fread;
	if( r2 == NULL ) hl_null_access();
	r1 = sys_io_FileInput_readByte(r2);
	return r1;
}

void hxd_fs__LocalFileSystem_LocalEntry_read(hxd__fs___LocalFileSystem__LocalEntry r0,haxe__io__Bytes r1,int r2,int r3) {
	sys__io__FileInput r5;
	r5 = r0->fread;
	if( r5 == NULL ) hl_null_access();
	haxe_io_Input_readFullBytes(((haxe__io__Input)r5),r1,r2,r3);
	return;
}

void hxd_fs__LocalFileSystem_LocalEntry_close(hxd__fs___LocalFileSystem__LocalEntry r0) {
	sys__io__FileInput r2;
	r2 = r0->fread;
	if( !r2 ) goto label$3575$7;
	r2 = r0->fread;
	if( r2 == NULL ) hl_null_access();
	sys_io_FileInput_close(r2);
	r2 = NULL;
	r0->fread = r2;
	label$3575$7:
	return;
}

bool hxd_fs__LocalFileSystem_LocalEntry_get_isDirectory(hxd__fs___LocalFileSystem__LocalEntry r0) {
	String r3;
	bool r2;
	vdynamic *r1;
	r1 = r0->isDirCached;
	if( !r1 ) goto label$3576$5;
	r1 = r0->isDirCached;
	r2 = r1 ? r1->v.b : 0;
	return r2;
	label$3576$5:
	r3 = r0->file;
	r2 = sys_FileSystem_isDirectory(r3);
	r1 = hl_alloc_dynbool(r2);
	r0->isDirCached = r1;
	r2 = r1 ? r1->v.b : 0;
	return r2;
}

void hxd_fs__LocalFileSystem_LocalEntry_load(hxd__fs___LocalFileSystem__LocalEntry r0,vclosure* r1) {
	haxe__Timer r3;
	int r4;
	if( !r1 ) goto label$3577$3;
	r4 = 1;
	r3 = haxe_Timer_delay(r1,r4);
	label$3577$3:
	return;
}

void hxd_fs__LocalFileSystem_LocalEntry_loadBitmap(hxd__fs___LocalFileSystem__LocalEntry r0,vclosure* r1) {
	hxd__BitmapData r3;
	hxd__res__Image r4;
	if( r1 == NULL ) hl_null_access();
	r4 = (hxd__res__Image)hl_alloc_obj(hxd__res__Image__val);
	hxd_res_Image_new(r4,((hxd__fs__FileEntry)r0));
	r3 = hxd_res_Image_toBitmap(r4);
	r1->hasValue ? ((void (*)(vdynamic*,hxd__BitmapData))r1->fun)((vdynamic*)r1->value,r3) : ((void (*)(hxd__BitmapData))r1->fun)(r3);
	return;
}

String hxd_fs__LocalFileSystem_LocalEntry_get_path(hxd__fs___LocalFileSystem__LocalEntry r0) {
	String r1;
	r1 = r0->relPath;
	if( r1 ) goto label$3579$4;
	r1 = (String)global$1226;
	return r1;
	label$3579$4:
	r1 = r0->relPath;
	return r1;
}

bool hxd_fs__LocalFileSystem_LocalEntry_exists(hxd__fs___LocalFileSystem__LocalEntry r0,String r1) {
	String r4, r5;
	bool r2;
	hxd__fs__LocalFileSystem r3;
	r3 = r0->fs;
	if( r3 == NULL ) hl_null_access();
	r4 = r0->relPath;
	if( r4 ) goto label$3580$6;
	r4 = r1;
	goto label$3580$10;
	label$3580$6:
	r4 = r0->relPath;
	r5 = (String)global$207;
	r4 = String___add__(r4,r5);
	r4 = String___add__(r4,r1);
	label$3580$10:
	r2 = hxd_fs_LocalFileSystem_exists(r3,r4);
	return r2;
}

hxd__fs__FileEntry hxd_fs__LocalFileSystem_LocalEntry_get(hxd__fs___LocalFileSystem__LocalEntry r0,String r1) {
	String r4, r5;
	hxd__fs___LocalFileSystem__LocalEntry r2;
	hxd__fs__LocalFileSystem r3;
	r3 = r0->fs;
	if( r3 == NULL ) hl_null_access();
	r4 = r0->relPath;
	if( r4 ) goto label$3581$6;
	r4 = r1;
	goto label$3581$10;
	label$3581$6:
	r4 = r0->relPath;
	r5 = (String)global$207;
	r4 = String___add__(r4,r5);
	r4 = String___add__(r4,r1);
	label$3581$10:
	r2 = hxd_fs_LocalFileSystem_get(r3,r4);
	return ((hxd__fs__FileEntry)r2);
}

int hxd_fs__LocalFileSystem_LocalEntry_get_size(hxd__fs___LocalFileSystem__LocalEntry r0) {
	String r3;
	vvirtual *r2;
	int r1;
	r3 = r0->file;
	r2 = sys_FileSystem_stat(r3);
	if( r2 == NULL ) hl_null_access();
	r1 = hl_vfields(r2)[9] ? (*(int*)(hl_vfields(r2)[9])) : (int)hl_dyn_geti(r2->value,206807499/*size*/,&type$3);
	return r1;
}

hxd__impl__ArrayIterator_hxd_fs_FileEntry hxd_fs__LocalFileSystem_LocalEntry_iterator(hxd__fs___LocalFileSystem__LocalEntry r0) {
	hxd__fs__FileEntry r19;
	bool *r17;
	hxd__fs___LocalFileSystem__LocalEntry r13;
	String r5, r10, r15;
	hl__types__ArrayObj r1, r4;
	bool r16, r18, r20;
	hxd__fs__LocalFileSystem r14;
	hxd__impl__ArrayIterator_hxd_fs_FileEntry r21;
	vdynamic *r8;
	vbyte *r11, *r12;
	varray *r9;
	int r3, r6, r7;
	r1 = (hl__types__ArrayObj)hl_alloc_obj(hl__types__ArrayObj__val);
	hl_types_ArrayObj_new(r1);
	r3 = 0;
	r5 = r0->file;
	r4 = sys_FileSystem_readDirectory(r5);
	label$3583$5:
	if( r4 == NULL ) hl_null_access();
	r7 = r4->length;
	if( r3 >= r7 ) goto label$3583$104;
	r7 = r4->length;
	if( ((unsigned)r3) < ((unsigned)r7) ) goto label$3583$13;
	r5 = NULL;
	goto label$3583$16;
	label$3583$13:
	r9 = r4->array;
	r8 = ((vdynamic**)(r9 + 1))[r3];
	r5 = (String)r8;
	label$3583$16:
	++r3;
	if( !r5 ) goto label$3583$26;
	r6 = r5->length;
	r7 = 4;
	if( r6 != r7 ) goto label$3583$26;
	r11 = r5->bytes;
	r12 = (vbyte*)USTR(".git");
	r6 = hl_string_compare(r11,r12,r6);
	r7 = 0;
	if( r6 == r7 ) goto label$3583$60;
	label$3583$26:
	if( !r5 ) goto label$3583$35;
	r6 = r5->length;
	r7 = 4;
	if( r6 != r7 ) goto label$3583$35;
	r11 = r5->bytes;
	r12 = (vbyte*)USTR(".svn");
	r6 = hl_string_compare(r11,r12,r6);
	r7 = 0;
	if( r6 == r7 ) goto label$3583$60;
	label$3583$35:
	if( !r5 ) goto label$3583$44;
	r6 = r5->length;
	r7 = 4;
	if( r6 != r7 ) goto label$3583$44;
	r11 = r5->bytes;
	r12 = (vbyte*)USTR(".tmp");
	r6 = hl_string_compare(r11,r12,r6);
	r7 = 0;
	if( r6 == r7 ) goto label$3583$83;
	label$3583$44:
	if( r1 == NULL ) hl_null_access();
	r14 = r0->fs;
	if( r14 == NULL ) hl_null_access();
	r10 = r0->relPath;
	if( r10 ) goto label$3583$51;
	r10 = r5;
	goto label$3583$55;
	label$3583$51:
	r10 = r0->relPath;
	r15 = (String)global$207;
	r10 = String___add__(r10,r15);
	r10 = String___add__(r10,r5);
	label$3583$55:
	r16 = false;
	r17 = &r16;
	r13 = hxd_fs_LocalFileSystem_open(r14,r10,r17);
	r6 = hl_types_ArrayObj_push(r1,((vdynamic*)r13));
	goto label$3583$103;
	label$3583$60:
	r10 = r0->file;
	r15 = (String)global$207;
	r10 = String___add__(r10,r15);
	r10 = String___add__(r10,r5);
	r18 = sys_FileSystem_isDirectory(r10);
	if( !r18 ) goto label$3583$67;
	goto label$3583$5;
	label$3583$67:
	if( r1 == NULL ) hl_null_access();
	r14 = r0->fs;
	if( r14 == NULL ) hl_null_access();
	r10 = r0->relPath;
	if( r10 ) goto label$3583$74;
	r10 = r5;
	goto label$3583$78;
	label$3583$74:
	r10 = r0->relPath;
	r15 = (String)global$207;
	r10 = String___add__(r10,r15);
	r10 = String___add__(r10,r5);
	label$3583$78:
	r18 = false;
	r17 = &r18;
	r13 = hxd_fs_LocalFileSystem_open(r14,r10,r17);
	r6 = hl_types_ArrayObj_push(r1,((vdynamic*)r13));
	goto label$3583$103;
	label$3583$83:
	r14 = r0->fs;
	if( r14 == NULL ) hl_null_access();
	r19 = r14->root;
	if( r0 != ((hxd__fs___LocalFileSystem__LocalEntry)r19) ) goto label$3583$88;
	goto label$3583$5;
	label$3583$88:
	if( r1 == NULL ) hl_null_access();
	r14 = r0->fs;
	if( r14 == NULL ) hl_null_access();
	r10 = r0->relPath;
	if( r10 ) goto label$3583$95;
	r10 = r5;
	goto label$3583$99;
	label$3583$95:
	r10 = r0->relPath;
	r15 = (String)global$207;
	r10 = String___add__(r10,r15);
	r10 = String___add__(r10,r5);
	label$3583$99:
	r20 = false;
	r17 = &r20;
	r13 = hxd_fs_LocalFileSystem_open(r14,r10,r17);
	r6 = hl_types_ArrayObj_push(r1,((vdynamic*)r13));
	label$3583$103:
	goto label$3583$5;
	label$3583$104:
	r21 = (hxd__impl__ArrayIterator_hxd_fs_FileEntry)hl_alloc_obj(hxd__impl__ArrayIterator_hxd_fs_FileEntry__val);
	hxd_impl_ArrayIterator_hxd_fs_FileEntry_new(r21,r1);
	return r21;
}

double hxd_fs__LocalFileSystem_LocalEntry_getModifTime(hxd__fs___LocalFileSystem__LocalEntry r0) {
	String r4;
	vvirtual *r3;
	Date r2;
	double r1;
	r4 = r0->file;
	r3 = sys_FileSystem_stat(r4);
	if( r3 == NULL ) hl_null_access();
	r2 = hl_vfields(r3)[6] ? (*(Date*)(hl_vfields(r3)[6])) : (Date)hl_dyn_getp(r3->value,262801146/*mtime*/,&type$24);
	if( r2 == NULL ) hl_null_access();
	r1 = Date_getTime(r2);
	return r1;
}

void hxd_fs__LocalFileSystem_LocalEntry_watch(hxd__fs___LocalFileSystem__LocalEntry r0,vclosure* r1) {
	hxd__fs___LocalFileSystem__LocalEntry r16;
	String r13, r17;
	vvirtual *r20;
	Date r19;
	hl__types__ArrayObj r5, r15;
	hl_type *r9;
	bool r4;
	haxe__MainEvent r11;
	hxd__fs___LocalFileSystem__$LocalEntry r6;
	double r18;
	vclosure *r3;
	int *r12;
	vdynamic *r7;
	int r10, r14;
	varray *r8;
	if( r1 ) goto label$3585$10;
	r3 = r0->watchCallback;
	if( !r3 ) goto label$3585$9;
	r6 = (hxd__fs___LocalFileSystem__$LocalEntry)global$1234;
	r5 = r6->WATCH_LIST;
	if( r5 == NULL ) hl_null_access();
	r4 = hl_types_ArrayObj_remove(r5,((vdynamic*)r0));
	r3 = NULL;
	r0->watchCallback = r3;
	label$3585$9:
	return;
	label$3585$10:
	r3 = r0->watchCallback;
	if( r3 ) goto label$3585$54;
	r6 = (hxd__fs___LocalFileSystem__$LocalEntry)global$1234;
	r5 = r6->WATCH_LIST;
	if( r5 ) goto label$3585$24;
	r9 = &type$3570;
	r10 = 0;
	r8 = hl_alloc_array(r9,r10);
	r5 = hl_types_ArrayObj_alloc(r8);
	r6 = (hxd__fs___LocalFileSystem__$LocalEntry)global$1234;
	r6->WATCH_LIST = r5;
	r3 = &cl$3568;
	r12 = NULL;
	r11 = haxe_MainLoop_add(r3,r12);
	label$3585$24:
	r13 = hxd_fs__LocalFileSystem_LocalEntry_get_path(r0);
	r10 = 0;
	r6 = (hxd__fs___LocalFileSystem__$LocalEntry)global$1234;
	r5 = r6->WATCH_LIST;
	label$3585$28:
	if( r5 == NULL ) hl_null_access();
	r14 = r5->length;
	if( r10 >= r14 ) goto label$3585$50;
	r14 = r5->length;
	if( ((unsigned)r10) < ((unsigned)r14) ) goto label$3585$36;
	r16 = NULL;
	goto label$3585$39;
	label$3585$36:
	r8 = r5->array;
	r7 = ((vdynamic**)(r8 + 1))[r10];
	r16 = (hxd__fs___LocalFileSystem__LocalEntry)r7;
	label$3585$39:
	++r10;
	if( r16 == NULL ) hl_null_access();
	r17 = hxd_fs__LocalFileSystem_LocalEntry_get_path(r16);
	if( r17 != r13 && (!r17 || !r13 || String___compare(r17,(vdynamic*)r13) != 0) ) goto label$3585$49;
	r3 = NULL;
	r16->watchCallback = r3;
	r6 = (hxd__fs___LocalFileSystem__$LocalEntry)global$1234;
	r15 = r6->WATCH_LIST;
	if( r15 == NULL ) hl_null_access();
	r4 = hl_types_ArrayObj_remove(r15,((vdynamic*)r16));
	label$3585$49:
	goto label$3585$28;
	label$3585$50:
	r6 = (hxd__fs___LocalFileSystem__$LocalEntry)global$1234;
	r5 = r6->WATCH_LIST;
	if( r5 == NULL ) hl_null_access();
	r10 = hl_types_ArrayObj_push(r5,((vdynamic*)r0));
	label$3585$54:
	r13 = r0->file;
	r20 = sys_FileSystem_stat(r13);
	if( r20 == NULL ) hl_null_access();
	r19 = hl_vfields(r20)[6] ? (*(Date*)(hl_vfields(r20)[6])) : (Date)hl_dyn_getp(r20->value,262801146/*mtime*/,&type$24);
	if( r19 == NULL ) hl_null_access();
	r18 = Date_getTime(r19);
	r0->watchTime = r18;
	r0->watchCallback = r1;
	return;
}

void hxd_fs__LocalFileSystem_LocalEntry_new(hxd__fs___LocalFileSystem__LocalEntry r0,hxd__fs__LocalFileSystem r1,String r2,String r3,String r4) {
	r0->fs = r1;
	r0->name = r2;
	r0->relPath = r3;
	r0->file = r4;
	return;
}

void hxd_fs__LocalFileSystem_LocalEntry_checkFiles() {
	bool *r18;
	String r11, r15, r16;
	hxd__fs___LocalFileSystem__LocalEntry r4;
	sys__io__FileOutput r17;
	vvirtual *r10;
	Date r9;
	hl__types__ArrayObj r0;
	bool r14;
	hxd__fs___LocalFileSystem__$LocalEntry r1;
	vclosure *r19;
	double r8, r12;
	vdynamic *r5, *r13;
	varray *r6;
	int r2, r3;
	hl_trap_ctx trap$0;
	r1 = (hxd__fs___LocalFileSystem__$LocalEntry)global$1234;
	r0 = r1->WATCH_LIST;
	if( r0 == NULL ) hl_null_access();
	r1 = (hxd__fs___LocalFileSystem__$LocalEntry)global$1234;
	r2 = r1->WATCH_INDEX;
	r3 = r2;
	++r2;
	r1->WATCH_INDEX = r2;
	r2 = r0->length;
	if( ((unsigned)r3) < ((unsigned)r2) ) goto label$3568$12;
	r4 = NULL;
	goto label$3568$15;
	label$3568$12:
	r6 = r0->array;
	r5 = ((vdynamic**)(r6 + 1))[r3];
	r4 = (hxd__fs___LocalFileSystem__LocalEntry)r5;
	label$3568$15:
	if( r4 ) goto label$3568$20;
	r2 = 0;
	r1 = (hxd__fs___LocalFileSystem__$LocalEntry)global$1234;
	r1->WATCH_INDEX = r2;
	return;
	label$3568$20:
	hl_trap(trap$0,r5,label$3568$30);
	if( r4 == NULL ) hl_null_access();
	r11 = r4->file;
	r10 = sys_FileSystem_stat(r11);
	if( r10 == NULL ) hl_null_access();
	r9 = hl_vfields(r10)[6] ? (*(Date*)(hl_vfields(r10)[6])) : (Date)hl_dyn_getp(r10->value,262801146/*mtime*/,&type$24);
	if( r9 == NULL ) hl_null_access();
	r8 = Date_getTime(r9);
	hl_endtrap(trap$0);
	goto label$3568$31;
	label$3568$30:
	r8 = -1.;
	label$3568$31:
	if( r4 == NULL ) hl_null_access();
	r12 = r4->watchTime;
	if( r8 != r12 ) goto label$3568$35;
	return;
	label$3568$35:
	r1 = (hxd__fs___LocalFileSystem__$LocalEntry)global$1234;
	r11 = r1->tmpDir;
	if( r11 ) goto label$3568$56;
	r11 = (String)global$1235;
	r11 = Sys_getEnv(r11);
	r1 = (hxd__fs___LocalFileSystem__$LocalEntry)global$1234;
	r1->tmpDir = r11;
	r1 = (hxd__fs___LocalFileSystem__$LocalEntry)global$1234;
	r11 = r1->tmpDir;
	if( r11 ) goto label$3568$49;
	r11 = (String)global$1236;
	r11 = Sys_getEnv(r11);
	r1 = (hxd__fs___LocalFileSystem__$LocalEntry)global$1234;
	r1->tmpDir = r11;
	label$3568$49:
	r1 = (hxd__fs___LocalFileSystem__$LocalEntry)global$1234;
	r11 = r1->tmpDir;
	if( r11 ) goto label$3568$56;
	r11 = (String)global$1237;
	r11 = Sys_getEnv(r11);
	r1 = (hxd__fs___LocalFileSystem__$LocalEntry)global$1234;
	r1->tmpDir = r11;
	label$3568$56:
	r1 = (hxd__fs___LocalFileSystem__$LocalEntry)global$1234;
	r11 = r1->tmpDir;
	r15 = (String)global$207;
	r11 = String___add__(r11,r15);
	r15 = r4->file;
	if( r15 == NULL ) hl_null_access();
	r16 = (String)global$207;
	r0 = String_split(r15,r16);
	if( r0 == NULL ) hl_null_access();
	r13 = hl_types_ArrayObj_pop(r0);
	r15 = (String)r13;
	r11 = String___add__(r11,r15);
	r15 = (String)global$1238;
	r11 = String___add__(r11,r15);
	r14 = sys_FileSystem_exists(r11);
	if( !r14 ) goto label$3568$73;
	return;
	label$3568$73:
	r14 = hxd_fs__LocalFileSystem_LocalEntry_get_isDirectory(r4);
	if( r14 ) goto label$3568$84;
	hl_trap(trap$0,r13,label$3568$83);
	r11 = r4->file;
	r18 = NULL;
	r17 = sys_io_File_append(r11,r18);
	if( r17 == NULL ) hl_null_access();
	sys_io_FileOutput_close(r17);
	hl_endtrap(trap$0);
	goto label$3568$84;
	label$3568$83:
	return;
	label$3568$84:
	r4->watchTime = r8;
	r19 = r4->watchCallback;
	if( r19 == NULL ) hl_null_access();
	r19->hasValue ? ((void (*)(vdynamic*))r19->fun)((vdynamic*)r19->value) : ((void (*)(void))r19->fun)();
	return;
}

