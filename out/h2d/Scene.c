// Generated by HLC 4.0.0 (HL v4)
#include <hl/code.h>

bool h2d_Scene_get_defaultSmooth(h2d__Scene r0) {
	bool r1;
	h2d__RenderContext r2;
	r2 = r0->ctx;
	if( r2 == NULL ) hl_null_access();
	r1 = r2->defaultSmooth;
	return r1;
}

bool h2d_Scene_set_defaultSmooth(h2d__Scene r0,bool r1) {
	h2d__RenderContext r2;
	r2 = r0->ctx;
	if( r2 == NULL ) hl_null_access();
	r2->defaultSmooth = r1;
	return r1;
}

void h2d_Scene_setEvents(h2d__Scene r0,hxd__SceneEvents r1) {
	r0->events = r1;
	return;
}

int h2d_Scene_get_zoom(h2d__Scene r0) {
	h3d__Engine r3;
	h3d__$Engine r4;
	double r1, r5;
	int r2;
	r4 = (h3d__$Engine)global$38;
	r3 = r4->CURRENT;
	if( r3 == NULL ) hl_null_access();
	r2 = r3->width;
	r1 = (double)r2;
	r2 = r0->width;
	r5 = (double)r2;
	r1 = r1 / r5;
	r2 = (int)r1;
	return r2;
}

int h2d_Scene_set_zoom(h2d__Scene r0,int r1) {
	hxd__Window r7;
	h3d__Engine r2;
	h3d__$Engine r3;
	double r6, r8;
	int r5, r9, r10, r11, r12;
	r3 = (h3d__$Engine)global$38;
	r2 = r3->CURRENT;
	r7 = r0->window;
	if( r7 == NULL ) hl_null_access();
	r5 = hxd_Window_get_width(r7);
	r6 = (double)r5;
	r8 = (double)r1;
	r6 = r6 / r8;
	r5 = hl_math_ceil(r6);
	r7 = r0->window;
	if( r7 == NULL ) hl_null_access();
	r9 = hxd_Window_get_height(r7);
	r6 = (double)r9;
	r8 = (double)r1;
	r6 = r6 / r8;
	r9 = hl_math_ceil(r6);
	r10 = r5 * r1;
	r11 = r9 * r1;
	if( r2 == NULL ) hl_null_access();
	r12 = r2->width;
	if( r10 != r12 ) goto label$693$23;
	r12 = r2->height;
	if( r11 == r12 ) goto label$693$24;
	label$693$23:
	h3d_Engine_resize(r2,r10,r11);
	label$693$24:
	h2d_Scene_setFixedSize(r0,r5,r9);
	return r1;
}

h2d__RenderContext h2d_Scene_get_renderer(h2d__Scene r0) {
	h2d__RenderContext r1;
	r1 = r0->ctx;
	return r1;
}

h2d__RenderContext h2d_Scene_set_renderer(h2d__Scene r0,h2d__RenderContext r1) {
	r0->ctx = r1;
	return r1;
}

void h2d_Scene_setFixedSize(h2d__Scene r0,int r1,int r2) {
	bool r3;
	r0->width = r1;
	r0->height = r2;
	r3 = true;
	r0->fixedSize = r3;
	r3 = true;
	r0->posChanged = r3;
	return;
}

void h2d_Scene_checkResize(h2d__Scene r0) {
	bool r2;
	h3d__Engine r3;
	h3d__$Engine r4;
	int r5, r6;
	r2 = r0->fixedSize;
	if( !r2 ) goto label$697$3;
	return;
	label$697$3:
	r4 = (h3d__$Engine)global$38;
	r3 = r4->CURRENT;
	r5 = r0->width;
	if( r3 == NULL ) hl_null_access();
	r6 = r3->width;
	if( r5 != r6 ) goto label$697$12;
	r5 = r0->height;
	r6 = r3->height;
	if( r5 == r6 ) goto label$697$18;
	label$697$12:
	r5 = r3->width;
	r0->width = r5;
	r5 = r3->height;
	r0->height = r5;
	r2 = true;
	r0->posChanged = r2;
	label$697$18:
	return;
}

double h2d_Scene_screenXToLocal(h2d__Scene r0,double r1) {
	hxd__Window r5;
	double r2, r4, r6;
	int r3;
	r3 = r0->width;
	r4 = (double)r3;
	r2 = r1 * r4;
	r5 = r0->window;
	if( r5 == NULL ) hl_null_access();
	r3 = hxd_Window_get_width(r5);
	r4 = (double)r3;
	r6 = r0->scaleX;
	r4 = r4 * r6;
	r2 = r2 / r4;
	r4 = r0->x;
	r2 = r2 - r4;
	return r2;
}

double h2d_Scene_screenYToLocal(h2d__Scene r0,double r1) {
	hxd__Window r5;
	double r2, r4, r6;
	int r3;
	r3 = r0->height;
	r4 = (double)r3;
	r2 = r1 * r4;
	r5 = r0->window;
	if( r5 == NULL ) hl_null_access();
	r3 = hxd_Window_get_height(r5);
	r4 = (double)r3;
	r6 = r0->scaleY;
	r4 = r4 * r6;
	r2 = r2 / r4;
	r4 = r0->y;
	r2 = r2 - r4;
	return r2;
}

double h2d_Scene_get_mouseX(h2d__Scene r0) {
	hxd__Window r3;
	double r1, r4, r5;
	int r2;
	r3 = r0->window;
	if( r3 == NULL ) hl_null_access();
	r2 = hxd_Window_get_mouseX(r3);
	r1 = (double)r2;
	r2 = r0->width;
	r4 = (double)r2;
	r1 = r1 * r4;
	r3 = r0->window;
	if( r3 == NULL ) hl_null_access();
	r2 = hxd_Window_get_width(r3);
	r4 = (double)r2;
	r5 = r0->scaleX;
	r4 = r4 * r5;
	r1 = r1 / r4;
	r4 = r0->x;
	r1 = r1 - r4;
	return r1;
}

double h2d_Scene_get_mouseY(h2d__Scene r0) {
	hxd__Window r3;
	double r1, r4, r5;
	int r2;
	r3 = r0->window;
	if( r3 == NULL ) hl_null_access();
	r2 = hxd_Window_get_mouseY(r3);
	r1 = (double)r2;
	r2 = r0->height;
	r4 = (double)r2;
	r1 = r1 * r4;
	r3 = r0->window;
	if( r3 == NULL ) hl_null_access();
	r2 = hxd_Window_get_height(r3);
	r4 = (double)r2;
	r5 = r0->scaleY;
	r4 = r4 * r5;
	r1 = r1 / r4;
	r4 = r0->y;
	r1 = r1 - r4;
	return r1;
}

void h2d_Scene_dispatchListeners(h2d__Scene r0,hxd__Event r1) {
	hl__types__ArrayObj r4;
	bool r10;
	vclosure *r7;
	vdynamic *r8;
	varray *r9;
	int r3, r5, r6;
	h2d_Scene_screenToLocal(r0,r1);
	r3 = 0;
	r4 = r0->eventListeners;
	label$702$3:
	if( r4 == NULL ) hl_null_access();
	r6 = r4->length;
	if( r3 >= r6 ) goto label$702$23;
	r5 = r3;
	++r3;
	r6 = r4->length;
	if( ((unsigned)r5) < ((unsigned)r6) ) goto label$702$13;
	r7 = NULL;
	goto label$702$16;
	label$702$13:
	r9 = r4->array;
	r8 = ((vdynamic**)(r9 + 1))[r5];
	r7 = (vclosure*)r8;
	label$702$16:
	if( r7 == NULL ) hl_null_access();
	r7->hasValue ? ((void (*)(vdynamic*,hxd__Event))r7->fun)((vdynamic*)r7->value,r1) : ((void (*)(hxd__Event))r7->fun)(r1);
	if( r1 == NULL ) hl_null_access();
	r10 = r1->propagate;
	if( r10 ) goto label$702$22;
	goto label$702$23;
	label$702$22:
	goto label$702$3;
	label$702$23:
	return;
}

bool h2d_Scene_isInteractiveVisible(h2d__Scene r0,vvirtual* r1) {
	bool r4;
	h2d__Object r2, r3;
	r2 = (h2d__Object)hl_dyn_castp(&r1,&type$1316,&type$136);
	label$703$1:
	if( !r2 ) goto label$703$11;
	if( r2 == NULL ) hl_null_access();
	r4 = r2->visible;
	if( r4 ) goto label$703$8;
	r4 = false;
	return r4;
	label$703$8:
	r3 = r2->parent;
	r2 = r3;
	goto label$703$1;
	label$703$11:
	r4 = true;
	return r4;
}

h2d__Interactive h2d_Scene_getInteractive(h2d__Scene r0,double r1,double r2) {
	hl__types__ArrayObj r8;
	bool r22, r25;
	h2d__Object r23, r24;
	double r3, r4, r5, r6, r14, r15, r16, r17, r18, r19, r20, r21;
	vdynamic *r12;
	h2d__Interactive r11;
	varray *r13;
	int r7, r9, r10;
	r4 = r0->matA;
	r3 = r1 * r4;
	r5 = r0->matB;
	r4 = r2 * r5;
	r3 = r3 + r4;
	r4 = r0->absX;
	r3 = r3 + r4;
	r5 = r0->matC;
	r4 = r1 * r5;
	r6 = r0->matD;
	r5 = r2 * r6;
	r4 = r4 + r5;
	r5 = r0->absY;
	r4 = r4 + r5;
	r7 = 0;
	r8 = r0->interactive;
	label$704$16:
	if( r8 == NULL ) hl_null_access();
	r10 = r8->length;
	if( r7 >= r10 ) goto label$704$81;
	r10 = r8->length;
	if( ((unsigned)r7) < ((unsigned)r10) ) goto label$704$24;
	r11 = NULL;
	goto label$704$27;
	label$704$24:
	r13 = r8->array;
	r12 = ((vdynamic**)(r13 + 1))[r7];
	r11 = (h2d__Interactive)r12;
	label$704$27:
	++r7;
	if( r11 == NULL ) hl_null_access();
	r6 = r11->absX;
	r5 = r3 - r6;
	r14 = r11->absY;
	r6 = r4 - r14;
	r14 = r11->width;
	r15 = r11->matA;
	r14 = r14 * r15;
	r15 = r11->width;
	r16 = r11->matC;
	r15 = r15 * r16;
	r16 = r15 * r5;
	r17 = r14 * r6;
	r16 = r16 + r17;
	r9 = 0;
	r18 = (double)r9;
	if( !(r16 < r18) ) goto label$704$46;
	goto label$704$16;
	label$704$46:
	r17 = r11->height;
	r18 = r11->matB;
	r17 = r17 * r18;
	r18 = r11->height;
	r19 = r11->matD;
	r18 = r18 * r19;
	r19 = r17 * r6;
	r20 = r18 * r5;
	r19 = r19 + r20;
	r9 = 0;
	r21 = (double)r9;
	if( !(r19 < r21) ) goto label$704$59;
	goto label$704$16;
	label$704$59:
	r20 = r14 * r18;
	r21 = r15 * r17;
	r20 = r20 - r21;
	if( r16 >= r20 ) goto label$704$64;
	if( !(r19 >= r20) ) goto label$704$65;
	label$704$64:
	goto label$704$16;
	label$704$65:
	r22 = true;
	r23 = ((h2d__Object)r11);
	label$704$67:
	if( !r23 ) goto label$704$78;
	if( r23 == NULL ) hl_null_access();
	r25 = r23->visible;
	if( r25 ) goto label$704$75;
	r25 = false;
	r22 = r25;
	goto label$704$78;
	label$704$75:
	r24 = r23->parent;
	r23 = r24;
	goto label$704$67;
	label$704$78:
	if( r22 ) goto label$704$80;
	goto label$704$16;
	label$704$80:
	return r11;
	label$704$81:
	r11 = NULL;
	return r11;
}

void h2d_Scene_screenToLocal(h2d__Scene r0,hxd__Event r1) {
	hxd__Window r5;
	double r2, r4, r6, r8, r9;
	int r3;
	if( r1 == NULL ) hl_null_access();
	r2 = r1->relX;
	r3 = r0->width;
	r4 = (double)r3;
	r2 = r2 * r4;
	r5 = r0->window;
	if( r5 == NULL ) hl_null_access();
	r3 = hxd_Window_get_width(r5);
	r4 = (double)r3;
	r6 = r0->scaleX;
	r4 = r4 * r6;
	r2 = r2 / r4;
	r4 = r0->x;
	r2 = r2 - r4;
	r4 = r1->relY;
	r3 = r0->height;
	r6 = (double)r3;
	r4 = r4 * r6;
	r5 = r0->window;
	if( r5 == NULL ) hl_null_access();
	r3 = hxd_Window_get_height(r5);
	r6 = (double)r3;
	r8 = r0->scaleY;
	r6 = r6 * r8;
	r4 = r4 / r6;
	r6 = r0->y;
	r4 = r4 - r6;
	r8 = r0->matA;
	r6 = r2 * r8;
	r9 = r0->matB;
	r8 = r4 * r9;
	r6 = r6 + r8;
	r8 = r0->absX;
	r6 = r6 + r8;
	r1->relX = r6;
	r8 = r0->matC;
	r6 = r2 * r8;
	r9 = r0->matD;
	r8 = r4 * r9;
	r6 = r6 + r8;
	r8 = r0->absY;
	r6 = r6 + r8;
	r1->relY = r6;
	return;
}

void h2d_Scene_dispatchEvent(h2d__Scene r0,hxd__Event r1,vvirtual* r2) {
	double r5, r6, r7, r8, r9, r10, r11, r12, r13;
	h2d__Interactive r3;
	r3 = (h2d__Interactive)hl_dyn_castp(&r2,&type$1316,&type$1524);
	h2d_Scene_screenToLocal(r0,r1);
	if( r1 == NULL ) hl_null_access();
	r5 = r1->relX;
	if( r3 == NULL ) hl_null_access();
	r6 = r3->absX;
	r5 = r5 - r6;
	r6 = r1->relY;
	r7 = r3->absY;
	r6 = r6 - r7;
	r7 = r3->width;
	r8 = r3->matA;
	r7 = r7 * r8;
	r8 = r3->width;
	r9 = r3->matC;
	r8 = r8 * r9;
	r9 = r3->height;
	r10 = r3->matB;
	r9 = r9 * r10;
	r10 = r3->height;
	r11 = r3->matD;
	r10 = r10 * r11;
	r11 = r7 * r10;
	r12 = r8 * r9;
	r11 = r11 - r12;
	r12 = r9 * r6;
	r13 = r10 * r5;
	r12 = r12 + r13;
	r12 = r12 / r11;
	r13 = r3->width;
	r12 = r12 * r13;
	r1->relX = r12;
	r12 = r8 * r5;
	r13 = r7 * r6;
	r12 = r12 + r13;
	r12 = r12 / r11;
	r13 = r3->height;
	r12 = r12 * r13;
	r1->relY = r12;
	h2d_Interactive_handleEvent(r3,r1);
	return;
}

vvirtual* h2d_Scene_handleEvent(h2d__Scene r0,hxd__Event r1,vvirtual* r2) {
	hl__types__ArrayObj r8;
	vvirtual *r7;
	bool r27, r30;
	h2d__Object r28, r29;
	double r4, r5, r16, r17, r18, r19, r20, r21, r22, r23, r24, r25, r26;
	vdynamic *r10, *r14;
	h2d__Interactive r9;
	varray *r15;
	int r6, r11, r12, r13;
	h2d_Scene_screenToLocal(r0,r1);
	if( r1 == NULL ) hl_null_access();
	r4 = r1->relX;
	r5 = r1->relY;
	if( r2 ) goto label$707$7;
	r6 = 0;
	goto label$707$14;
	label$707$7:
	r8 = r0->interactive;
	if( r8 == NULL ) hl_null_access();
	r9 = (h2d__Interactive)hl_dyn_castp(&r2,&type$1316,&type$1524);
	r10 = NULL;
	r6 = hl_types_ArrayObj_indexOf(r8,((vdynamic*)r9),r10);
	r11 = 1;
	r6 = r6 + r11;
	label$707$14:
	r8 = r0->interactive;
	if( r8 == NULL ) hl_null_access();
	r11 = r8->length;
	label$707$17:
	if( r6 >= r11 ) goto label$707$110;
	r8 = r0->interactive;
	if( r8 == NULL ) hl_null_access();
	r12 = r6;
	++r6;
	r13 = r8->length;
	if( ((unsigned)r12) < ((unsigned)r13) ) goto label$707$27;
	r9 = NULL;
	goto label$707$30;
	label$707$27:
	r15 = r8->array;
	r14 = ((vdynamic**)(r15 + 1))[r12];
	r9 = (h2d__Interactive)r14;
	label$707$30:
	if( r9 ) goto label$707$32;
	goto label$707$110;
	label$707$32:
	if( r9 == NULL ) hl_null_access();
	r17 = r9->absX;
	r16 = r4 - r17;
	r18 = r9->absY;
	r17 = r5 - r18;
	r18 = r9->width;
	r19 = r9->matA;
	r18 = r18 * r19;
	r19 = r9->width;
	r20 = r9->matC;
	r19 = r19 * r20;
	r20 = r19 * r16;
	r21 = r18 * r17;
	r20 = r20 + r21;
	r12 = 0;
	r22 = (double)r12;
	if( !(r20 < r22) ) goto label$707$50;
	goto label$707$17;
	label$707$50:
	r21 = r9->height;
	r22 = r9->matB;
	r21 = r21 * r22;
	r22 = r9->height;
	r23 = r9->matD;
	r22 = r22 * r23;
	r23 = r21 * r17;
	r24 = r22 * r16;
	r23 = r23 + r24;
	r12 = 0;
	r25 = (double)r12;
	if( !(r23 < r25) ) goto label$707$63;
	goto label$707$17;
	label$707$63:
	r24 = r18 * r22;
	r25 = r19 * r21;
	r24 = r24 - r25;
	if( r20 >= r24 ) goto label$707$68;
	if( !(r23 >= r24) ) goto label$707$69;
	label$707$68:
	goto label$707$17;
	label$707$69:
	r27 = true;
	r28 = ((h2d__Object)r9);
	label$707$71:
	if( !r28 ) goto label$707$82;
	if( r28 == NULL ) hl_null_access();
	r30 = r28->visible;
	if( r30 ) goto label$707$79;
	r30 = false;
	r27 = r30;
	goto label$707$82;
	label$707$79:
	r29 = r28->parent;
	r28 = r29;
	goto label$707$71;
	label$707$82:
	if( r27 ) goto label$707$84;
	goto label$707$17;
	label$707$84:
	if( r1 == NULL ) hl_null_access();
	r25 = r23 / r24;
	if( r9 == NULL ) hl_null_access();
	r26 = r9->width;
	r25 = r25 * r26;
	r1->relX = r25;
	r25 = r20 / r24;
	r26 = r9->height;
	r25 = r25 * r26;
	r1->relY = r25;
	h2d_Interactive_handleEvent(r9,r1);
	r30 = r1->cancel;
	if( !r30 ) goto label$707$102;
	r30 = false;
	r1->cancel = r30;
	r30 = false;
	r1->propagate = r30;
	goto label$707$17;
	label$707$102:
	if( r9 ) goto label$707$105;
	r7 = NULL;
	goto label$707$109;
	label$707$105:
	r7 = r9->$_f51;
	if( r7 ) goto label$707$109;
	r7 = hl_to_virtual(&type$1316,(vdynamic*)r9);
	r9->$_f51 = r7;
	label$707$109:
	return r7;
	label$707$110:
	r7 = NULL;
	return r7;
}

void h2d_Scene_addEventListener(h2d__Scene r0,vclosure* r1) {
	hl__types__ArrayObj r3;
	int r2;
	r3 = r0->eventListeners;
	if( r3 == NULL ) hl_null_access();
	r2 = hl_types_ArrayObj_push(r3,((vdynamic*)r1));
	return;
}

bool h2d_Scene_removeEventListener(h2d__Scene r0,vclosure* r1) {
	hl__types__ArrayObj r3, r5;
	bool r9;
	vclosure *r6;
	vdynamic *r7;
	varray *r8;
	int r2, r4;
	r2 = 0;
	r3 = r0->eventListeners;
	label$709$2:
	if( r3 == NULL ) hl_null_access();
	r4 = r3->length;
	if( r2 >= r4 ) goto label$709$22;
	r4 = r3->length;
	if( ((unsigned)r2) < ((unsigned)r4) ) goto label$709$10;
	r6 = NULL;
	goto label$709$13;
	label$709$10:
	r8 = r3->array;
	r7 = ((vdynamic**)(r8 + 1))[r2];
	r6 = (vclosure*)r7;
	label$709$13:
	++r2;
	r9 = hl_fun_compare(((vdynamic*)r6),((vdynamic*)r1));
	if( !r9 ) goto label$709$21;
	r5 = r0->eventListeners;
	if( r5 == NULL ) hl_null_access();
	r9 = hl_types_ArrayObj_remove(r5,((vdynamic*)r6));
	r9 = true;
	return r9;
	label$709$21:
	goto label$709$2;
	label$709$22:
	r9 = false;
	return r9;
}

void h2d_Scene_startDrag(h2d__Scene r0,vclosure* r1,vclosure* r2,hxd__Event r3) {
	venum *r7;
	vclosure *r6;
	hxd__SceneEvents r5;
	r5 = r0->events;
	if( r5 == NULL ) hl_null_access();
	r7 = hl_alloc_enum(&type$1582,0);
	((Enum$1582*)r7)->p0 = (vclosure*)r1;
	((Enum$1582*)r7)->p1 = (h2d__Scene)r0;
	r6 = hl_alloc_closure_ptr(&type$1581,fun$2405,r7);
	hxd_SceneEvents_startDrag(r5,r6,r2,r3);
	return;
}

void h2d_Scene_stopDrag(h2d__Scene r0) {
	hxd__SceneEvents r2;
	r2 = r0->events;
	if( r2 == NULL ) hl_null_access();
	hxd_SceneEvents_stopDrag(r2);
	return;
}

h2d__Interactive h2d_Scene_getFocus(h2d__Scene r0) {
	hl__types__ArrayObj r8, r10;
	vvirtual *r4;
	bool r6;
	h2d__$Interactive r5;
	hxd__SceneEvents r1;
	vdynamic *r3, *r11;
	h2d__Interactive r2, r7;
	varray *r13;
	int r9, r12;
	r1 = r0->events;
	if( r1 ) goto label$712$4;
	r2 = NULL;
	return r2;
	label$712$4:
	r1 = r0->events;
	if( r1 == NULL ) hl_null_access();
	r4 = hxd_SceneEvents_getFocus(r1);
	if( r4 ) goto label$712$10;
	r2 = NULL;
	return r2;
	label$712$10:
	r5 = (h2d__$Interactive)global$94;
	r6 = hl_BaseType_check(((hl__BaseType)r5),((vdynamic*)r4));
	if( !r6 ) goto label$712$15;
	r2 = (h2d__Interactive)hl_dyn_castp(&r4,&type$1316,&type$1524);
	goto label$712$16;
	label$712$15:
	r2 = NULL;
	label$712$16:
	if( r2 ) goto label$712$19;
	r7 = NULL;
	return r7;
	label$712$19:
	r8 = r0->interactive;
	if( r8 == NULL ) hl_null_access();
	r10 = r0->interactive;
	if( r10 == NULL ) hl_null_access();
	r11 = NULL;
	r9 = hl_types_ArrayObj_indexOf(r10,((vdynamic*)r2),r11);
	r12 = r8->length;
	if( ((unsigned)r9) < ((unsigned)r12) ) goto label$712$29;
	r7 = NULL;
	goto label$712$32;
	label$712$29:
	r13 = r8->array;
	r3 = ((vdynamic**)(r13 + 1))[r9];
	r7 = (h2d__Interactive)r3;
	label$712$32:
	return r7;
}

void h2d_Scene_addEventTarget(h2d__Scene r0,h2d__Interactive r1) {
	hl__types__ArrayObj r10;
	h2d__Object r3, r6, r16, r17, r18, r20, r23;
	vdynamic *r14;
	h2d__Interactive r2;
	varray *r15;
	int r5, r7, r8, r9, r11, r12, r13, r19, r21, r22, r24, r25, r26, r27, r28;
	r3 = ((h2d__Object)r1);
	r5 = 0;
	label$713$2:
	if( !r3 ) goto label$713$9;
	if( r3 == NULL ) hl_null_access();
	r6 = r3->parent;
	r3 = r6;
	++r5;
	goto label$713$2;
	label$713$9:
	r7 = r5;
	r8 = 0;
	r10 = r0->interactive;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->length;
	label$713$14:
	if( r8 >= r9 ) goto label$713$124;
	r11 = r8;
	++r8;
	r6 = ((h2d__Object)r1);
	r10 = r0->interactive;
	if( r10 == NULL ) hl_null_access();
	r13 = r10->length;
	if( ((unsigned)r11) < ((unsigned)r13) ) goto label$713$25;
	r2 = NULL;
	goto label$713$28;
	label$713$25:
	r15 = r10->array;
	r14 = ((vdynamic**)(r15 + 1))[r11];
	r2 = (h2d__Interactive)r14;
	label$713$28:
	r16 = ((h2d__Object)r2);
	r12 = r7;
	r17 = ((h2d__Object)r2);
	r13 = 0;
	label$713$32:
	if( !r17 ) goto label$713$39;
	if( r17 == NULL ) hl_null_access();
	r18 = r17->parent;
	r17 = r18;
	++r13;
	goto label$713$32;
	label$713$39:
	r19 = r13;
	r18 = r6;
	r20 = r16;
	label$713$42:
	if( r19 >= r12 ) goto label$713$50;
	r6 = r18;
	if( r18 == NULL ) hl_null_access();
	r23 = r18->parent;
	r18 = r23;
	--r12;
	goto label$713$42;
	label$713$50:
	if( r12 >= r19 ) goto label$713$58;
	r16 = r20;
	if( r20 == NULL ) hl_null_access();
	r23 = r20->parent;
	r20 = r23;
	--r19;
	goto label$713$50;
	label$713$58:
	if( r18 == r20 ) goto label$713$69;
	r6 = r18;
	if( r18 == NULL ) hl_null_access();
	r23 = r18->parent;
	r18 = r23;
	r16 = r20;
	if( r20 == NULL ) hl_null_access();
	r23 = r20->parent;
	r20 = r23;
	goto label$713$58;
	label$713$69:
	r21 = -1;
	r22 = 0;
	if( r18 == NULL ) hl_null_access();
	r10 = r18->children;
	if( r10 == NULL ) hl_null_access();
	r24 = r10->length;
	label$713$75:
	if( r22 >= r24 ) goto label$713$93;
	r25 = r22;
	++r22;
	if( r18 == NULL ) hl_null_access();
	r10 = r18->children;
	if( r10 == NULL ) hl_null_access();
	r27 = r10->length;
	if( ((unsigned)r25) < ((unsigned)r27) ) goto label$713$86;
	r23 = NULL;
	goto label$713$89;
	label$713$86:
	r15 = r10->array;
	r14 = ((vdynamic**)(r15 + 1))[r25];
	r23 = (h2d__Object)r14;
	label$713$89:
	if( r23 != r6 ) goto label$713$92;
	r21 = r25;
	goto label$713$93;
	label$713$92:
	goto label$713$75;
	label$713$93:
	r22 = r21;
	r24 = -1;
	r25 = 0;
	if( r20 == NULL ) hl_null_access();
	r10 = r20->children;
	if( r10 == NULL ) hl_null_access();
	r26 = r10->length;
	label$713$100:
	if( r25 >= r26 ) goto label$713$118;
	r27 = r25;
	++r25;
	if( r20 == NULL ) hl_null_access();
	r10 = r20->children;
	if( r10 == NULL ) hl_null_access();
	r28 = r10->length;
	if( ((unsigned)r27) < ((unsigned)r28) ) goto label$713$111;
	r23 = NULL;
	goto label$713$114;
	label$713$111:
	r15 = r10->array;
	r14 = ((vdynamic**)(r15 + 1))[r27];
	r23 = (h2d__Object)r14;
	label$713$114:
	if( r23 != r16 ) goto label$713$117;
	r24 = r27;
	goto label$713$118;
	label$713$117:
	goto label$713$100;
	label$713$118:
	if( r24 >= r22 ) goto label$713$123;
	r10 = r0->interactive;
	if( r10 == NULL ) hl_null_access();
	hl_types_ArrayObj_insert(r10,r11,((vdynamic*)r1));
	return;
	label$713$123:
	goto label$713$14;
	label$713$124:
	r10 = r0->interactive;
	if( r10 == NULL ) hl_null_access();
	r8 = hl_types_ArrayObj_push(r10,((vdynamic*)r1));
	return;
}

void h2d_Scene_removeEventTarget(h2d__Scene r0,h2d__Interactive r1,bool* r2) {
	vvirtual *r8;
	hl__types__ArrayObj r5;
	bool r3, r4;
	hxd__SceneEvents r7;
	if( r2 ) goto label$714$3;
	r3 = false;
	goto label$714$4;
	label$714$3:
	r3 = *r2;
	label$714$4:
	r5 = r0->interactive;
	if( r5 == NULL ) hl_null_access();
	r4 = hl_types_ArrayObj_remove(r5,((vdynamic*)r1));
	if( !r3 ) goto label$714$20;
	r7 = r0->events;
	if( !r7 ) goto label$714$20;
	r7 = r0->events;
	if( r7 == NULL ) hl_null_access();
	if( r1 ) goto label$714$15;
	r8 = NULL;
	goto label$714$19;
	label$714$15:
	r8 = r1->$_f51;
	if( r8 ) goto label$714$19;
	r8 = hl_to_virtual(&type$1316,(vdynamic*)r1);
	r1->$_f51 = r8;
	label$714$19:
	hxd_SceneEvents_onRemove(r7,r8);
	label$714$20:
	return;
}

void h2d_Scene_dispose(h2d__Scene r0) {
	bool r2;
	h2d__RenderContext r3;
	r2 = r0->allocated;
	if( !r2 ) goto label$715$3;
	h2d_Object_onRemove(((h2d__Object)r0));
	label$715$3:
	r3 = r0->ctx;
	if( r3 == NULL ) hl_null_access();
	h2d_RenderContext_dispose(r3);
	return;
}

void h2d_Scene_setElapsedTime(h2d__Scene r0,double r1) {
	h2d__RenderContext r2;
	r2 = r0->ctx;
	if( r2 == NULL ) hl_null_access();
	r2->elapsedTime = r1;
	return;
}

void h2d_Scene_drawImplTo(h2d__Scene r0,h2d__Object r1,h3d__mat__Texture r2) {
	bool *r20;
	String r6;
	bool r7, r11;
	h3d__Engine r9;
	h2d__RenderContext r8;
	h3d__$Engine r10;
	double r12;
	vdynamic *r17, *r18, *r19;
	int *r13, *r14, *r15, *r16;
	int r4, r5;
	if( r2 == NULL ) hl_null_access();
	r4 = r2->flags;
	r5 = 1;
	r4 = r4 & r5;
	r5 = 0;
	if( r4 != r5 ) goto label$717$8;
	r6 = (String)global$431;
	hl_throw((vdynamic*)r6);
	label$717$8:
	r4 = r2->flags;
	r5 = 256;
	r4 = r4 & r5;
	r5 = 0;
	if( r4 == r5 ) goto label$717$15;
	r7 = false;
	goto label$717$16;
	label$717$15:
	r7 = true;
	label$717$16:
	r8 = r0->ctx;
	if( r8 == NULL ) hl_null_access();
	r10 = (h3d__$Engine)global$38;
	r9 = r10->CURRENT;
	r8->engine = r9;
	r8 = r0->ctx;
	if( r8 == NULL ) hl_null_access();
	r9 = r8->engine;
	if( r9 == NULL ) hl_null_access();
	r11 = h3d_Engine_begin(r9);
	r8 = r0->ctx;
	if( r8 == NULL ) hl_null_access();
	r12 = r0->alpha;
	r8->globalAlpha = r12;
	r8 = r0->ctx;
	if( r8 == NULL ) hl_null_access();
	h2d_RenderContext_begin(r8);
	r8 = r0->ctx;
	if( r8 == NULL ) hl_null_access();
	r13 = NULL;
	r14 = NULL;
	r15 = NULL;
	r16 = NULL;
	h2d_RenderContext_pushTarget(r8,r2,r13,r14,r15,r16);
	if( !r7 ) goto label$717$50;
	r8 = r0->ctx;
	if( r8 == NULL ) hl_null_access();
	r9 = r8->engine;
	if( r9 == NULL ) hl_null_access();
	r4 = 0;
	r17 = hl_alloc_dynamic(&type$3);
	r17->v.i = r4;
	r18 = NULL;
	r19 = NULL;
	h3d_Engine_clear(r9,r17,r18,r19);
	label$717$50:
	if( r1 == NULL ) hl_null_access();
	r8 = r0->ctx;
	((void (*)(h2d__Object,h2d__RenderContext))r1->$type->vobj_proto[10])(r1,r8);
	r8 = r0->ctx;
	if( r8 == NULL ) hl_null_access();
	r20 = NULL;
	h2d_RenderContext_popTarget(r8,r20);
	return;
}

void h2d_Scene_syncOnly(h2d__Scene r0,double r1) {
	h2d__RenderContext r6, r9;
	h3d__Engine r2;
	h3d__$Engine r3;
	double r5, r8;
	int r7;
	r3 = (h3d__$Engine)global$38;
	r2 = r3->CURRENT;
	h2d_Scene_setElapsedTime(r0,r1);
	r6 = r0->ctx;
	if( r6 == NULL ) hl_null_access();
	r6->engine = r2;
	r6 = r0->ctx;
	if( r6 == NULL ) hl_null_access();
	r7 = r6->frame;
	++r7;
	r6->frame = r7;
	r6 = r0->ctx;
	if( r6 == NULL ) hl_null_access();
	r5 = r6->time;
	r9 = r0->ctx;
	if( r9 == NULL ) hl_null_access();
	r8 = r9->elapsedTime;
	r5 = r5 + r8;
	r6->time = r5;
	r6 = r0->ctx;
	if( r6 == NULL ) hl_null_access();
	r5 = r0->alpha;
	r6->globalAlpha = r5;
	r6 = r0->ctx;
	h2d_Scene_sync(r0,r6);
	return;
}

void h2d_Scene_render(h2d__Scene r0,h3d__Engine r1) {
	hl__types__ArrayObj r9;
	h2d__RenderContext r2, r7;
	double r5, r6;
	int r3, r4;
	r2 = r0->ctx;
	if( r2 == NULL ) hl_null_access();
	r2->engine = r1;
	r2 = r0->ctx;
	if( r2 == NULL ) hl_null_access();
	r3 = r2->frame;
	++r3;
	r2->frame = r3;
	r2 = r0->ctx;
	if( r2 == NULL ) hl_null_access();
	r5 = r2->time;
	r7 = r0->ctx;
	if( r7 == NULL ) hl_null_access();
	r6 = r7->elapsedTime;
	r5 = r5 + r6;
	r2->time = r5;
	r2 = r0->ctx;
	if( r2 == NULL ) hl_null_access();
	r5 = r0->alpha;
	r2->globalAlpha = r5;
	r2 = r0->ctx;
	h2d_Scene_sync(r0,r2);
	r9 = r0->children;
	if( r9 == NULL ) hl_null_access();
	r3 = r9->length;
	r4 = 0;
	if( r3 != r4 ) goto label$719$28;
	return;
	label$719$28:
	r2 = r0->ctx;
	if( r2 == NULL ) hl_null_access();
	h2d_RenderContext_begin(r2);
	r2 = r0->ctx;
	if( r2 == NULL ) hl_null_access();
	h2d_RenderContext_drawScene(r2);
	r2 = r0->ctx;
	if( r2 == NULL ) hl_null_access();
	h2d_RenderContext_end(r2);
	return;
}

void h2d_Scene_sync(h2d__Scene r0,h2d__RenderContext r1) {
	bool r3;
	h3d__Engine r6;
	int r4, r5;
	r3 = r0->allocated;
	if( r3 ) goto label$720$3;
	h2d_Object_onAdd(((h2d__Object)r0));
	label$720$3:
	r3 = r0->fixedSize;
	if( r3 ) goto label$720$26;
	r4 = r0->width;
	if( r1 == NULL ) hl_null_access();
	r6 = r1->engine;
	if( r6 == NULL ) hl_null_access();
	r5 = r6->width;
	if( r4 != r5 ) goto label$720$16;
	r4 = r0->height;
	r6 = r1->engine;
	if( r6 == NULL ) hl_null_access();
	r5 = r6->height;
	if( r4 == r5 ) goto label$720$26;
	label$720$16:
	r6 = r1->engine;
	if( r6 == NULL ) hl_null_access();
	r4 = r6->width;
	r0->width = r4;
	r6 = r1->engine;
	if( r6 == NULL ) hl_null_access();
	r4 = r6->height;
	r0->height = r4;
	r3 = true;
	r0->posChanged = r3;
	label$720$26:
	h2d_Object_sync(((h2d__Object)r0),r1);
	return;
}

h2d__Bitmap h2d_Scene_captureBitmap(h2d__Scene r0,h2d__Tile r1) {
	vvirtual *r15;
	hl__types__ArrayObj r9;
	venum *r13, *r14;
	hl_type *r11;
	bool r19, r26;
	h2d__Object r28;
	h2d__Tile r5;
	h3d__Engine r2;
	h3d__$Engine r3;
	h2d__Bitmap r27;
	int *r17, *r18, *r20, *r21;
	varray *r10;
	int r7, r8, r12, r16, r22, r23, r24, r25;
	h3d__mat__Texture r6;
	r3 = (h3d__$Engine)global$38;
	r2 = r3->CURRENT;
	if( r1 ) goto label$721$25;
	r5 = (h2d__Tile)hl_alloc_obj(h2d__Tile__val);
	r6 = (h3d__mat__Texture)hl_alloc_obj(h3d__mat__Texture__val);
	r7 = r0->width;
	r8 = r0->height;
	r11 = &type$497;
	r12 = 1;
	r10 = hl_alloc_array(r11,r12);
	r13 = (venum*)global$432;
	r12 = 0;
	((venum**)(r10 + 1))[r12] = r13;
	r9 = hl_types_ArrayObj_alloc(r10);
	r14 = NULL;
	r15 = NULL;
	h3d_mat_Texture_new(r6,r7,r8,r9,r14,r15);
	r7 = 0;
	r8 = 0;
	r12 = r0->width;
	r16 = r0->height;
	r17 = NULL;
	r18 = NULL;
	h2d_Tile_new(r5,r6,r7,r8,r12,r16,r17,r18);
	r1 = r5;
	label$721$25:
	if( r2 == NULL ) hl_null_access();
	r19 = h3d_Engine_begin(r2);
	if( r1 == NULL ) hl_null_access();
	r7 = r1->x;
	r17 = &r7;
	r8 = r1->y;
	r18 = &r8;
	r12 = r1->width;
	r20 = &r12;
	r16 = r1->height;
	r21 = &r16;
	h3d_Engine_setRenderZone(r2,r17,r18,r20,r21);
	r6 = r1->innerTex;
	r17 = NULL;
	r18 = NULL;
	h3d_Engine_pushTarget(r2,r6,r17,r18);
	r22 = r0->width;
	r23 = r0->height;
	r19 = r0->fixedSize;
	if( r6 == NULL ) hl_null_access();
	r24 = r6->width;
	r25 = r6->height;
	h2d_Scene_setFixedSize(r0,r24,r25);
	h2d_Scene_render(r0,r2);
	h3d_Engine_popTarget(r2);
	r0->width = r22;
	r0->height = r23;
	r0->fixedSize = r19;
	r26 = true;
	r0->posChanged = r26;
	r17 = NULL;
	r18 = NULL;
	r20 = NULL;
	r21 = NULL;
	h3d_Engine_setRenderZone(r2,r17,r18,r20,r21);
	h3d_Engine_end(r2);
	r27 = (h2d__Bitmap)hl_alloc_obj(h2d__Bitmap__val);
	r28 = NULL;
	h2d_Bitmap_new(r27,r1,r28);
	return r27;
}

void h2d_Scene_new(h2d__Scene r0) {
	hl__types__ArrayObj r7;
	bool r9;
	h2d__Object r2;
	hxd__Window r8;
	h2d__RenderContext r5;
	h3d__Engine r3;
	h3d__$Engine r4;
	int r6;
	r2 = NULL;
	h2d_Layers_new(((h2d__Layers)r0),r2);
	r4 = (h3d__$Engine)global$38;
	r3 = r4->CURRENT;
	r5 = (h2d__RenderContext)hl_alloc_obj(h2d__RenderContext__val);
	h2d_RenderContext_new(r5,r0);
	r0->ctx = r5;
	if( r3 == NULL ) hl_null_access();
	r6 = r3->width;
	r0->width = r6;
	r6 = r3->height;
	r0->height = r6;
	r7 = (hl__types__ArrayObj)hl_alloc_obj(hl__types__ArrayObj__val);
	hl_types_ArrayObj_new(r7);
	r0->interactive = r7;
	r7 = (hl__types__ArrayObj)hl_alloc_obj(hl__types__ArrayObj__val);
	hl_types_ArrayObj_new(r7);
	r0->eventListeners = r7;
	r8 = hxd_Window_getInstance();
	r0->window = r8;
	r9 = true;
	r0->posChanged = r9;
	return;
}

