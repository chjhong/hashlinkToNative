// Generated by HLC 4.0.0 (HL v4)
#include <hl/code.h>

h2d__FontChar h2d_Font_getChar(h2d__Font r0,int r1) {
	hxd__Charset r6;
	haxe__ds__IntMap r3;
	h2d__FontChar r4, r5;
	vdynamic *r2;
	int r7;
	r3 = r0->glyphs;
	if( r3 == NULL ) hl_null_access();
	r2 = haxe_ds_IntMap_get(r3,r1);
	r4 = (h2d__FontChar)r2;
	if( r4 ) goto label$1867$20;
	r6 = r0->charset;
	if( r6 == NULL ) hl_null_access();
	r3 = r0->glyphs;
	r2 = hxd_Charset_resolveChar(r6,r1,r3);
	r5 = (h2d__FontChar)r2;
	r4 = r5;
	if( r5 ) goto label$1867$20;
	r7 = 13;
	if( r1 == r7 ) goto label$1867$16;
	r7 = 10;
	if( r1 != r7 ) goto label$1867$18;
	label$1867$16:
	r5 = r0->nullChar;
	goto label$1867$19;
	label$1867$18:
	r5 = r0->defaultChar;
	label$1867$19:
	r4 = r5;
	label$1867$20:
	return r4;
}

void h2d_Font_setOffset(h2d__Font r0,int r1,int r2) {
	bool r10;
	haxe__ds__IntMap r9;
	h2d__Tile r14;
	h2d__FontChar r12;
	vclosure *r11, *r13;
	vdynamic *r8;
	int r3, r4, r6, r7;
	r4 = r0->offsetX;
	r3 = r1 - r4;
	r6 = r0->offsetY;
	r4 = r2 - r6;
	r7 = 0;
	if( r3 != r7 ) goto label$1868$9;
	r7 = 0;
	if( r4 != r7 ) goto label$1868$9;
	return;
	label$1868$9:
	r9 = r0->glyphs;
	if( r9 == NULL ) hl_null_access();
	r8 = haxe_ds_IntMap_iterator(r9);
	label$1868$12:
	if( r8 == NULL ) hl_null_access();
	r11 = (vclosure*)hl_dyn_getp((vdynamic*)r8,407283053/*hasNext*/,&type$118);
	if( r11 == NULL ) hl_null_access();
	r10 = r11->hasValue ? ((bool (*)(vdynamic*))r11->fun)((vdynamic*)r11->value) : ((bool (*)(void))r11->fun)();
	if( !r10 ) goto label$1868$33;
	r13 = (vclosure*)hl_dyn_getp((vdynamic*)r8,151160317/*next*/,&type$1518);
	if( r13 == NULL ) hl_null_access();
	r12 = r13->hasValue ? ((h2d__FontChar (*)(vdynamic*))r13->fun)((vdynamic*)r13->value) : ((h2d__FontChar (*)(void))r13->fun)();
	if( r12 == NULL ) hl_null_access();
	r14 = r12->_t;
	if( r14 == NULL ) hl_null_access();
	r6 = r14->dx;
	r6 = r6 + r3;
	r14->dx = r6;
	r14 = r12->_t;
	if( r14 == NULL ) hl_null_access();
	r6 = r14->dy;
	r6 = r6 + r4;
	r14->dy = r6;
	goto label$1868$12;
	label$1868$33:
	r6 = r0->offsetX;
	r6 = r6 + r3;
	r0->offsetX = r6;
	r6 = r0->offsetY;
	r6 = r6 + r4;
	r0->offsetY = r6;
	return;
}

h2d__Font h2d_Font_clone(h2d__Font r0) {
	String r2;
	hxd__Charset r6;
	bool r10;
	haxe__ds__IntMap r9;
	h2d__Tile r5;
	h2d__Font r1;
	h2d__FontChar r7, r14, r15;
	vclosure *r11, *r13;
	vdynamic *r8, *r12;
	int r3;
	r1 = (h2d__Font)hl_alloc_obj(h2d__Font__val);
	r2 = r0->name;
	r3 = r0->size;
	h2d_Font_new(r1,r2,r3);
	r3 = r0->baseLine;
	r1->baseLine = r3;
	r3 = r0->lineHeight;
	r1->lineHeight = r3;
	r5 = r0->tile;
	if( r5 == NULL ) hl_null_access();
	r5 = h2d_Tile_clone(r5);
	r1->tile = r5;
	r6 = r0->charset;
	r1->charset = r6;
	r7 = r0->defaultChar;
	if( r7 == NULL ) hl_null_access();
	r7 = h2d_FontChar_clone(r7);
	r1->defaultChar = r7;
	r9 = r0->glyphs;
	if( r9 == NULL ) hl_null_access();
	r8 = haxe_ds_IntMap_keys(r9);
	label$1869$21:
	if( r8 == NULL ) hl_null_access();
	r11 = (vclosure*)hl_dyn_getp((vdynamic*)r8,407283053/*hasNext*/,&type$118);
	if( r11 == NULL ) hl_null_access();
	r10 = r11->hasValue ? ((bool (*)(vdynamic*))r11->fun)((vdynamic*)r11->value) : ((bool (*)(void))r11->fun)();
	if( !r10 ) goto label$1869$45;
	r13 = (vclosure*)hl_dyn_getp((vdynamic*)r8,151160317/*next*/,&type$488);
	if( r13 == NULL ) hl_null_access();
	r3 = r13->hasValue ? ((int (*)(vdynamic*))r13->fun)((vdynamic*)r13->value) : ((int (*)(void))r13->fun)();
	r9 = r0->glyphs;
	if( r9 == NULL ) hl_null_access();
	r12 = haxe_ds_IntMap_get(r9,r3);
	r7 = (h2d__FontChar)r12;
	if( r7 == NULL ) hl_null_access();
	r14 = h2d_FontChar_clone(r7);
	r15 = r0->defaultChar;
	if( r7 != r15 ) goto label$1869$40;
	if( r1 == NULL ) hl_null_access();
	r1->defaultChar = r14;
	label$1869$40:
	if( r1 == NULL ) hl_null_access();
	r9 = r1->glyphs;
	if( r9 == NULL ) hl_null_access();
	haxe_ds_IntMap_set(r9,r3,((vdynamic*)r14));
	goto label$1869$21;
	label$1869$45:
	return r1;
}

void h2d_Font_resizeTo(h2d__Font r0,int r1) {
	bool r8;
	haxe__ds__IntMap r7;
	h2d__Tile r13, r14;
	h2d__FontChar r10;
	vclosure *r9, *r11;
	double r2, r4, r12, r15, r17, r19;
	vdynamic *r6;
	int r3, r16, r18;
	r2 = (double)r1;
	r3 = r0->initSize;
	r4 = (double)r3;
	r2 = r2 / r4;
	r7 = r0->glyphs;
	if( r7 == NULL ) hl_null_access();
	r6 = haxe_ds_IntMap_iterator(r7);
	label$1870$7:
	if( r6 == NULL ) hl_null_access();
	r9 = (vclosure*)hl_dyn_getp((vdynamic*)r6,407283053/*hasNext*/,&type$118);
	if( r9 == NULL ) hl_null_access();
	r8 = r9->hasValue ? ((bool (*)(vdynamic*))r9->fun)((vdynamic*)r9->value) : ((bool (*)(void))r9->fun)();
	if( !r8 ) goto label$1870$56;
	r11 = (vclosure*)hl_dyn_getp((vdynamic*)r6,151160317/*next*/,&type$1518);
	if( r11 == NULL ) hl_null_access();
	r10 = r11->hasValue ? ((h2d__FontChar (*)(vdynamic*))r11->fun)((vdynamic*)r11->value) : ((h2d__FontChar (*)(void))r11->fun)();
	if( r10 == NULL ) hl_null_access();
	r3 = r10->width;
	r4 = (double)r3;
	r4 = r4 * r2;
	r3 = (int)r4;
	r10->width = r3;
	r13 = r10->_t;
	r14 = r10->_t;
	if( r14 == NULL ) hl_null_access();
	r3 = r14->width;
	r12 = (double)r3;
	r12 = r12 * r2;
	r3 = (int)r12;
	r14 = r10->_t;
	if( r14 == NULL ) hl_null_access();
	r16 = r14->height;
	r15 = (double)r16;
	r15 = r15 * r2;
	if( r13 == NULL ) hl_null_access();
	r18 = (int)r15;
	h2d_Tile_scaleToSize(r13,r3,r18);
	r14 = r10->_t;
	if( r14 == NULL ) hl_null_access();
	r16 = r14->dx;
	r17 = (double)r16;
	r17 = r17 * r2;
	r16 = (int)r17;
	r14 = r10->_t;
	if( r14 == NULL ) hl_null_access();
	r14->dx = r16;
	r14 = r10->_t;
	if( r14 == NULL ) hl_null_access();
	r18 = r14->dy;
	r19 = (double)r18;
	r19 = r19 * r2;
	r18 = (int)r19;
	r14 = r10->_t;
	if( r14 == NULL ) hl_null_access();
	r14->dy = r18;
	goto label$1870$7;
	label$1870$56:
	r3 = r0->lineHeight;
	r4 = (double)r3;
	r4 = r4 * r2;
	r3 = (int)r4;
	r0->lineHeight = r3;
	r3 = r0->baseLine;
	r12 = (double)r3;
	r12 = r12 * r2;
	r3 = (int)r12;
	r0->baseLine = r3;
	r0->size = r1;
	return;
}

bool h2d_Font_hasChar(h2d__Font r0,int r1) {
	bool r2;
	haxe__ds__IntMap r4;
	h2d__FontChar r5, r6;
	vdynamic *r3;
	r4 = r0->glyphs;
	if( r4 == NULL ) hl_null_access();
	r3 = haxe_ds_IntMap_get(r4,r1);
	r5 = (h2d__FontChar)r3;
	r6 = NULL;
	if( r5 != r6 ) goto label$1871$8;
	r2 = false;
	goto label$1871$9;
	label$1871$8:
	r2 = true;
	label$1871$9:
	return r2;
}

void h2d_Font_dispose(h2d__Font r0) {
	h2d__Tile r2;
	r2 = r0->tile;
	if( r2 == NULL ) hl_null_access();
	h2d_Tile_dispose(r2);
	return;
}

void h2d_Font_new(h2d__Font r0,String r1,int r2) {
	String r4, r16;
	hxd__Charset r15;
	haxe__ds__IntMap r5;
	h2d__Tile r8;
	h2d__FontChar r7;
	int *r13, *r14;
	h3d__mat__Texture r9;
	int r3, r10, r11, r12;
	r3 = 0;
	r0->offsetY = r3;
	r3 = 0;
	r0->offsetX = r3;
	r0->name = r1;
	r0->size = r2;
	r0->initSize = r2;
	r5 = (haxe__ds__IntMap)hl_alloc_obj(haxe__ds__IntMap__val);
	haxe_ds_IntMap_new(r5);
	r0->glyphs = r5;
	r7 = (h2d__FontChar)hl_alloc_obj(h2d__FontChar__val);
	r8 = (h2d__Tile)hl_alloc_obj(h2d__Tile__val);
	r9 = NULL;
	r3 = 0;
	r10 = 0;
	r11 = 0;
	r12 = 0;
	r13 = NULL;
	r14 = NULL;
	h2d_Tile_new(r8,r9,r3,r10,r11,r12,r13,r14);
	r3 = 0;
	h2d_FontChar_new(r7,r8,r3);
	r0->nullChar = r7;
	r0->defaultChar = r7;
	r15 = hxd_Charset_getDefault();
	r0->charset = r15;
	if( !r1 ) goto label$1884$30;
	r16 = (String)global$405;
	r4 = haxe_io_Path_withExtension(r1,r16);
	r0->tilePath = r4;
	label$1884$30:
	return;
}

