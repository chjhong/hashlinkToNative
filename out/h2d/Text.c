// Generated by HLC 4.0.0 (HL v4)
#include <hl/code.h>

h2d__Font h2d_Text_set_font(h2d__Text r0,h2d__Font r1) {
	bool r7;
	h2d__Object r5;
	h2d__Tile r6;
	h2d__Font r3;
	h2d__TileGroup r4;
	r3 = r0->font;
	if( r3 != r1 ) goto label$1788$3;
	return r1;
	label$1788$3:
	r0->font = r1;
	r4 = r0->glyphs;
	if( !r4 ) goto label$1788$14;
	r4 = r0->glyphs;
	if( !r4 ) goto label$1788$14;
	if( r4 == NULL ) hl_null_access();
	r5 = r4->parent;
	if( !r5 ) goto label$1788$14;
	r5 = r4->parent;
	if( r5 == NULL ) hl_null_access();
	((void (*)(h2d__Object,h2d__TileGroup))r5->$type->vobj_proto[6])(r5,r4);
	label$1788$14:
	r4 = (h2d__TileGroup)hl_alloc_obj(h2d__TileGroup__val);
	if( r1 ) goto label$1788$18;
	r6 = NULL;
	goto label$1788$20;
	label$1788$18:
	if( r1 == NULL ) hl_null_access();
	r6 = r1->tile;
	label$1788$20:
	h2d_TileGroup_new(r4,r6,((h2d__Object)r0));
	r0->glyphs = r4;
	r4 = r0->glyphs;
	if( r4 == NULL ) hl_null_access();
	r7 = false;
	r7 = h2d_Object_set_visible(((h2d__Object)r4),r7);
	h2d_Text_rebuild(r0);
	return r1;
}

venum* h2d_Text_set_textAlign(h2d__Text r0,venum* r1) {
	venum *r3;
	r3 = r0->textAlign;
	if( r3 != r1 ) goto label$1789$3;
	return r1;
	label$1789$3:
	r0->textAlign = r1;
	h2d_Text_rebuild(r0);
	return r1;
}

int h2d_Text_set_letterSpacing(h2d__Text r0,int r1) {
	int r3;
	r3 = r0->letterSpacing;
	if( r3 != r1 ) goto label$1790$3;
	return r1;
	label$1790$3:
	r0->letterSpacing = r1;
	h2d_Text_rebuild(r0);
	return r1;
}

int h2d_Text_set_lineSpacing(h2d__Text r0,int r1) {
	int r3;
	r3 = r0->lineSpacing;
	if( r3 != r1 ) goto label$1791$3;
	return r1;
	label$1791$3:
	r0->lineSpacing = r1;
	h2d_Text_rebuild(r0);
	return r1;
}

void h2d_Text_constraintSize(h2d__Text r0,double r1,double r2) {
	r0->constraintWidth = r1;
	h2d_Text_updateConstraint(r0);
	return;
}

void h2d_Text_onAdd(h2d__Text r0) {
	h2d_Object_onAdd(((h2d__Object)r0));
	h2d_Text_rebuild(r0);
	return;
}

void h2d_Text_draw(h2d__Text r0,h2d__RenderContext r1) {
	bool *r13, *r14;
	String r12;
	vvirtual *r10, *r16;
	bool r11;
	hl__types__ArrayBytes_Int r15;
	h2d__Tile r4;
	h3d__Vector r23;
	double r17, r18, r19, r20, r21, r22, r24, r26;
	h2d__TileGroup r3;
	vdynamic *r7, *r8, *r9;
	int r5, r6, r25;
	r3 = r0->glyphs;
	if( r3 ) goto label$1794$12;
	r5 = 16711935;
	r6 = 16;
	r7 = hl_alloc_dynamic(&type$3);
	r7->v.i = r6;
	r6 = 16;
	r8 = hl_alloc_dynamic(&type$3);
	r8->v.i = r6;
	r9 = NULL;
	r10 = NULL;
	r4 = h2d_Tile_fromColor(r5,r7,r8,r9,r10);
	h2d_Drawable_emitTile(((h2d__Drawable)r0),r1,r4);
	return;
	label$1794$12:
	r11 = r0->calcDone;
	if( r11 ) goto label$1794$20;
	r12 = r0->text;
	r11 = false;
	r13 = &r11;
	r14 = NULL;
	r15 = NULL;
	h2d_Text_initGlyphs(r0,r12,r13,r14,r15);
	label$1794$20:
	r16 = r0->dropShadow;
	if( !r16 ) goto label$1794$119;
	r17 = r0->absX;
	r18 = r0->absY;
	r19 = r0->absX;
	r16 = r0->dropShadow;
	if( r16 == NULL ) hl_null_access();
	r20 = hl_vfields(r16)[2] ? (*(double*)(hl_vfields(r16)[2])) : (double)hl_dyn_getd(r16->value,22420/*dx*/);
	r21 = r0->matA;
	r20 = r20 * r21;
	r16 = r0->dropShadow;
	if( r16 == NULL ) hl_null_access();
	r21 = hl_vfields(r16)[3] ? (*(double*)(hl_vfields(r16)[3])) : (double)hl_dyn_getd(r16->value,22421/*dy*/);
	r22 = r0->matC;
	r21 = r21 * r22;
	r20 = r20 + r21;
	r19 = r19 + r20;
	r0->absX = r19;
	r19 = r0->absY;
	r16 = r0->dropShadow;
	if( r16 == NULL ) hl_null_access();
	r20 = hl_vfields(r16)[2] ? (*(double*)(hl_vfields(r16)[2])) : (double)hl_dyn_getd(r16->value,22420/*dx*/);
	r21 = r0->matB;
	r20 = r20 * r21;
	r16 = r0->dropShadow;
	if( r16 == NULL ) hl_null_access();
	r21 = hl_vfields(r16)[3] ? (*(double*)(hl_vfields(r16)[3])) : (double)hl_dyn_getd(r16->value,22421/*dy*/);
	r22 = r0->matD;
	r21 = r21 * r22;
	r20 = r20 + r21;
	r19 = r19 + r20;
	r0->absY = r19;
	r23 = r0->color;
	if( r23 == NULL ) hl_null_access();
	r19 = r23->x;
	r23 = r0->color;
	if( r23 == NULL ) hl_null_access();
	r20 = r23->y;
	r23 = r0->color;
	if( r23 == NULL ) hl_null_access();
	r21 = r23->z;
	r23 = r0->color;
	if( r23 == NULL ) hl_null_access();
	r22 = r23->w;
	r23 = r0->color;
	r16 = r0->dropShadow;
	if( r16 == NULL ) hl_null_access();
	r5 = hl_vfields(r16)[1] ? (*(int*)(hl_vfields(r16)[1])) : (int)hl_dyn_geti(r16->value,173830765/*color*/,&type$3);
	if( r23 == NULL ) hl_null_access();
	r25 = 16;
	r6 = r5 >> r25;
	r25 = 255;
	r6 = r6 & r25;
	r24 = (double)r6;
	r6 = 255;
	r26 = (double)r6;
	r24 = r24 / r26;
	r23->x = r24;
	r25 = 8;
	r6 = r5 >> r25;
	r25 = 255;
	r6 = r6 & r25;
	r24 = (double)r6;
	r6 = 255;
	r26 = (double)r6;
	r24 = r24 / r26;
	r23->y = r24;
	r25 = 255;
	r6 = r5 & r25;
	r24 = (double)r6;
	r6 = 255;
	r26 = (double)r6;
	r24 = r24 / r26;
	r23->z = r24;
	r25 = 24;
	r6 = ((unsigned)r5) >> r25;
	r24 = (double)r6;
	r6 = 255;
	r26 = (double)r6;
	r24 = r24 / r26;
	r23->w = r24;
	r23 = r0->color;
	if( r23 == NULL ) hl_null_access();
	r16 = r0->dropShadow;
	if( r16 == NULL ) hl_null_access();
	r24 = hl_vfields(r16)[0] ? (*(double*)(hl_vfields(r16)[0])) : (double)hl_dyn_getd(r16->value,26650595/*alpha*/);
	r24 = r24 * r22;
	r23->w = r24;
	r3 = r0->glyphs;
	if( r3 == NULL ) hl_null_access();
	h2d_TileGroup_drawWith(r3,r1,((h2d__Drawable)r0));
	r0->absX = r17;
	r0->absY = r18;
	r23 = r0->color;
	if( r23 == NULL ) hl_null_access();
	r23->x = r19;
	r23->y = r20;
	r23->z = r21;
	r23->w = r22;
	label$1794$119:
	r3 = r0->glyphs;
	if( r3 == NULL ) hl_null_access();
	h2d_TileGroup_drawWith(r3,r1,((h2d__Drawable)r0));
	return;
}

String h2d_Text_set_text(h2d__Text r0,String r1) {
	String r2, r4;
	if( r1 ) goto label$1795$3;
	r2 = (String)global$179;
	goto label$1795$4;
	label$1795$3:
	r2 = r1;
	label$1795$4:
	r4 = r0->text;
	if( r2 != r4 && (!r2 || !r4 || String___compare(r2,(vdynamic*)r4) != 0) ) goto label$1795$7;
	return r2;
	label$1795$7:
	r0->text = r2;
	h2d_Text_rebuild(r0);
	return r2;
}

void h2d_Text_rebuild(h2d__Text r0) {
	bool *r5, *r6;
	String r3;
	bool r1;
	hl__types__ArrayBytes_Int r7;
	h2d__Font r4;
	r1 = false;
	r0->calcDone = r1;
	r1 = r0->allocated;
	if( !r1 ) goto label$1796$13;
	r3 = r0->text;
	if( !r3 ) goto label$1796$13;
	r4 = r0->font;
	if( !r4 ) goto label$1796$13;
	r3 = r0->text;
	r5 = NULL;
	r6 = NULL;
	r7 = NULL;
	h2d_Text_initGlyphs(r0,r3,r5,r6,r7);
	label$1796$13:
	return;
}

int h2d_Text_calcTextWidth(h2d__Text r0,String r1) {
	bool *r9, *r10;
	bool r3, r13, r14;
	hl__types__ArrayBytes_Int r11;
	int r4, r5, r6, r7, r8, r12;
	r3 = r0->calcDone;
	if( !r3 ) goto label$1797$19;
	r4 = r0->calcWidth;
	r5 = r0->calcHeight;
	r6 = r0->calcSizeHeight;
	r7 = r0->calcXMin;
	r8 = r0->calcYMin;
	r3 = false;
	r9 = &r3;
	r10 = NULL;
	r11 = NULL;
	h2d_Text_initGlyphs(r0,r1,r9,r10,r11);
	r12 = r0->calcWidth;
	r0->calcWidth = r4;
	r0->calcHeight = r5;
	r0->calcSizeHeight = r6;
	r0->calcXMin = r7;
	r0->calcYMin = r8;
	return r12;
	label$1797$19:
	r13 = false;
	r9 = &r13;
	r10 = NULL;
	r11 = NULL;
	h2d_Text_initGlyphs(r0,r1,r9,r10,r11);
	r14 = false;
	r0->calcDone = r14;
	r4 = r0->calcWidth;
	return r4;
}

String h2d_Text_splitText(h2d__Text r0,String r1,int* r2,int* r3) {
	String r9;
	hxd__Charset r28;
	hl__types__ArrayObj r11;
	hl_type *r13;
	bool r30, r33, r39;
	haxe__ds__IntMap r23;
	h2d__Font r21, r24, r41;
	h2d__FontChar r26, r27, r32, r42;
	double r6, r8;
	vdynamic *r10, *r20, *r22, *r31, *r40;
	varray *r12;
	int r4, r5, r7, r14, r15, r16, r17, r18, r19, r25, r29, r34, r35, r36, r37, r38, r43, r44;
	if( r2 ) goto label$1798$3;
	r4 = 0;
	goto label$1798$4;
	label$1798$3:
	r4 = *r2;
	label$1798$4:
	if( r3 ) goto label$1798$7;
	r5 = 0;
	goto label$1798$8;
	label$1798$7:
	r5 = *r3;
	label$1798$8:
	r6 = r0->realMaxWidth;
	r7 = 0;
	r8 = (double)r7;
	if( !(r6 < r8) ) goto label$1798$13;
	return r1;
	label$1798$13:
	r13 = &type$13;
	r7 = 0;
	r12 = hl_alloc_array(r13,r7);
	r11 = hl_types_ArrayObj_alloc(r12);
	r7 = 0;
	r14 = r4;
	r15 = -1;
	r16 = 0;
	if( r1 == NULL ) hl_null_access();
	r17 = r1->length;
	label$1798$23:
	if( r16 >= r17 ) goto label$1798$206;
	r18 = r16;
	++r16;
	if( r1 == NULL ) hl_null_access();
	r20 = String_charCodeAt(r1,r18);
	r21 = r0->font;
	r19 = r20 ? r20->v.i : 0;
	if( r21 == NULL ) hl_null_access();
	r23 = r21->glyphs;
	if( r23 == NULL ) hl_null_access();
	r10 = haxe_ds_IntMap_get(r23,r19);
	r26 = (h2d__FontChar)r10;
	if( r26 ) goto label$1798$52;
	r28 = r21->charset;
	if( r28 == NULL ) hl_null_access();
	r23 = r21->glyphs;
	r10 = hxd_Charset_resolveChar(r28,r19,r23);
	r27 = (h2d__FontChar)r10;
	r26 = r27;
	if( r27 ) goto label$1798$52;
	r29 = 13;
	if( r19 == r29 ) goto label$1798$48;
	r29 = 10;
	if( r19 != r29 ) goto label$1798$50;
	label$1798$48:
	r27 = r21->nullChar;
	goto label$1798$51;
	label$1798$50:
	r27 = r21->defaultChar;
	label$1798$51:
	r26 = r27;
	label$1798$52:
	r27 = r26;
	r25 = 10;
	r31 = hl_alloc_dynamic(&type$3);
	r31->v.i = r25;
	if( r20 == r31 || (r20 && r31 && (r20->v.i == r31->v.i)) ) goto label$1798$58;
	r30 = false;
	goto label$1798$59;
	label$1798$58:
	r30 = true;
	label$1798$59:
	if( r26 == NULL ) hl_null_access();
	r25 = r26->width;
	r29 = h2d_FontChar_getKerningOffset(r26,r15);
	r25 = r25 + r29;
	r24 = r0->font;
	if( r24 == NULL ) hl_null_access();
	r28 = r24->charset;
	if( r28 == NULL ) hl_null_access();
	r29 = r20 ? r20->v.i : 0;
	r33 = hxd_Charset_isBreakChar(r28,r29);
	if( !r33 ) goto label$1798$192;
	if( r11 == NULL ) hl_null_access();
	r29 = r11->length;
	r34 = 0;
	if( r29 != r34 ) goto label$1798$83;
	r34 = 0;
	if( r34 >= r4 ) goto label$1798$83;
	r6 = (double)r14;
	r8 = r0->realMaxWidth;
	if( !(r8 < r6) ) goto label$1798$83;
	r9 = (String)global$8;
	r29 = hl_types_ArrayObj_push(r11,((vdynamic*)r9));
	r29 = r14 - r4;
	r14 = r29;
	label$1798$83:
	r29 = r14 + r25;
	r34 = r0->letterSpacing;
	r29 = r29 + r34;
	r35 = 1;
	r34 = r18 + r35;
	r35 = r1->length;
	r36 = r15;
	r33 = false;
	label$1798$91:
	r6 = (double)r29;
	r8 = r0->realMaxWidth;
	if( !(r8 >= r6) ) goto label$1798$155;
	if( r34 >= r35 ) goto label$1798$155;
	if( r1 == NULL ) hl_null_access();
	r37 = r34;
	++r34;
	r22 = String_charCodeAt(r1,r37);
	r24 = r0->font;
	if( r24 == NULL ) hl_null_access();
	r28 = r24->charset;
	if( r28 == NULL ) hl_null_access();
	r37 = r22 ? r22->v.i : 0;
	r39 = hxd_Charset_isSpace(r28,r37);
	if( r39 ) goto label$1798$110;
	r37 = 10;
	r40 = hl_alloc_dynamic(&type$3);
	r40->v.i = r37;
	if( r22 != r40 && (!r22 || !r40 || (r22->v.i != r40->v.i)) ) goto label$1798$113;
	label$1798$110:
	r39 = true;
	r33 = r39;
	goto label$1798$155;
	label$1798$113:
	r24 = r0->font;
	r37 = r22 ? r22->v.i : 0;
	if( r24 == NULL ) hl_null_access();
	r23 = r24->glyphs;
	if( r23 == NULL ) hl_null_access();
	r10 = haxe_ds_IntMap_get(r23,r37);
	r32 = (h2d__FontChar)r10;
	if( r32 ) goto label$1798$136;
	r28 = r24->charset;
	if( r28 == NULL ) hl_null_access();
	r23 = r24->glyphs;
	r10 = hxd_Charset_resolveChar(r28,r37,r23);
	r42 = (h2d__FontChar)r10;
	r32 = r42;
	if( r42 ) goto label$1798$136;
	r43 = 13;
	if( r37 == r43 ) goto label$1798$132;
	r43 = 10;
	if( r37 != r43 ) goto label$1798$134;
	label$1798$132:
	r42 = r24->nullChar;
	goto label$1798$135;
	label$1798$134:
	r42 = r24->defaultChar;
	label$1798$135:
	r32 = r42;
	label$1798$136:
	if( r32 == NULL ) hl_null_access();
	r43 = r32->width;
	r44 = r0->letterSpacing;
	r43 = r43 + r44;
	r44 = h2d_FontChar_getKerningOffset(r32,r36);
	r43 = r43 + r44;
	r38 = r29 + r43;
	r29 = r38;
	r38 = r22 ? r22->v.i : 0;
	r36 = r38;
	r41 = r0->font;
	if( r41 == NULL ) hl_null_access();
	r28 = r41->charset;
	if( r28 == NULL ) hl_null_access();
	r38 = r22 ? r22->v.i : 0;
	r39 = hxd_Charset_isBreakChar(r28,r38);
	if( !r39 ) goto label$1798$154;
	goto label$1798$155;
	label$1798$154:
	goto label$1798$91;
	label$1798$155:
	r6 = (double)r29;
	r8 = r0->realMaxWidth;
	if( r8 < r6 ) goto label$1798$163;
	if( r33 ) goto label$1798$192;
	r37 = r29 + r5;
	r6 = (double)r37;
	r8 = r0->realMaxWidth;
	if( !(r8 < r6) ) goto label$1798$192;
	label$1798$163:
	r39 = true;
	r30 = r39;
	r24 = r0->font;
	if( r24 == NULL ) hl_null_access();
	r28 = r24->charset;
	if( r28 == NULL ) hl_null_access();
	r37 = r20 ? r20->v.i : 0;
	r39 = hxd_Charset_isSpace(r28,r37);
	if( !r39 ) goto label$1798$181;
	if( r11 == NULL ) hl_null_access();
	if( r1 == NULL ) hl_null_access();
	r38 = r18 - r7;
	r22 = hl_alloc_dynamic(&type$3);
	r22->v.i = r38;
	r9 = String_substr(r1,r7,r22);
	r37 = hl_types_ArrayObj_push(r11,((vdynamic*)r9));
	r32 = NULL;
	r27 = r32;
	goto label$1798$189;
	label$1798$181:
	if( r11 == NULL ) hl_null_access();
	if( r1 == NULL ) hl_null_access();
	r43 = 1;
	r38 = r18 + r43;
	r38 = r38 - r7;
	r22 = hl_alloc_dynamic(&type$3);
	r22->v.i = r38;
	r9 = String_substr(r1,r7,r22);
	r37 = hl_types_ArrayObj_push(r11,((vdynamic*)r9));
	label$1798$189:
	r38 = 1;
	r37 = r18 + r38;
	r7 = r37;
	label$1798$192:
	if( !r27 ) goto label$1798$197;
	r35 = r0->letterSpacing;
	r34 = r25 + r35;
	r29 = r14 + r34;
	r14 = r29;
	label$1798$197:
	if( !r30 ) goto label$1798$203;
	r29 = 0;
	r14 = r29;
	r29 = -1;
	r15 = r29;
	goto label$1798$205;
	label$1798$203:
	r29 = r20 ? r20->v.i : 0;
	r15 = r29;
	label$1798$205:
	goto label$1798$23;
	label$1798$206:
	if( r1 == NULL ) hl_null_access();
	r17 = r1->length;
	if( r7 >= r17 ) goto label$1798$228;
	if( r11 == NULL ) hl_null_access();
	r16 = r11->length;
	r17 = 0;
	if( r16 != r17 ) goto label$1798$223;
	r17 = 0;
	if( r17 >= r4 ) goto label$1798$223;
	r16 = r14 + r5;
	r17 = r0->letterSpacing;
	r16 = r16 - r17;
	r6 = (double)r16;
	r8 = r0->realMaxWidth;
	if( !(r8 < r6) ) goto label$1798$223;
	r9 = (String)global$8;
	r16 = hl_types_ArrayObj_push(r11,((vdynamic*)r9));
	label$1798$223:
	r17 = r1->length;
	r17 = r17 - r7;
	r20 = hl_alloc_dynamic(&type$3);
	r20->v.i = r17;
	r9 = String_substr(r1,r7,r20);
	r16 = hl_types_ArrayObj_push(r11,((vdynamic*)r9));
	label$1798$228:
	if( r11 == NULL ) hl_null_access();
	r9 = (String)global$205;
	r9 = hl_types_ArrayObj_join(r11,r9);
	return r9;
}

void h2d_Text_initGlyphs(h2d__Text r0,String r1,bool* r2,bool* r3,hl__types__ArrayBytes_Int r4) {
	String r19;
	hxd__Charset r42;
	venum *r15, *r21;
	bool r5, r6, r8, r20, r34, r44;
	haxe__ds__IntMap r39;
	h2d__Tile r49;
	hl__types__ArrayBytes_Int r17;
	h2d__Font r33;
	h3d__Vector r46;
	h2d__FontChar r40, r41;
	h2d___TileGroup__TileLayerContent r45;
	double r23, r24, r47, r48;
	h2d__TileGroup r9;
	int *r35, *r36;
	vdynamic *r32, *r37, *r38, *r43;
	vbyte *r18;
	int r10, r11, r12, r13, r14, r16, r22, r25, r26, r27, r28, r29, r30, r31, r50;
	if( r2 ) goto label$1799$3;
	r5 = true;
	goto label$1799$4;
	label$1799$3:
	r5 = *r2;
	label$1799$4:
	if( r3 ) goto label$1799$7;
	r6 = true;
	goto label$1799$8;
	label$1799$7:
	r6 = *r3;
	label$1799$8:
	if( !r5 ) goto label$1799$12;
	r9 = r0->glyphs;
	if( r9 == NULL ) hl_null_access();
	h2d_TileGroup_clear(r9);
	label$1799$12:
	r10 = 0;
	r11 = 0;
	r12 = 0;
	r13 = 0;
	r14 = -1;
	if( !r6 ) goto label$1799$20;
	r15 = r0->textAlign;
	goto label$1799$21;
	label$1799$20:
	r15 = (venum*)global$433;
	label$1799$21:
	if( r15 == NULL ) hl_null_access();
	r16 = HL__ENUM_INDEX__(r15);
	switch(r16) {
		default:
		case 0:
			goto label$1799$91;
		case 1:
		case 2:
		case 3:
		case 4:
			r16 = 0;
			r18 = hl_alloc_bytes(r16);
			r16 = 0;
			r16 = 0;
			r17 = hl_types_ArrayBase_allocI32(r18,r16);
			r4 = r17;
			r8 = false;
			r2 = &r8;
			r20 = false;
			r3 = &r20;
			h2d_Text_initGlyphs(r0,r1,r2,r3,r17);
			r21 = (venum*)global$434;
			if( r15 == r21 ) goto label$1799$40;
			r21 = (venum*)global$435;
			if( r15 != r21 ) goto label$1799$43;
			label$1799$40:
			r22 = r0->calcWidth;
			r16 = r22;
			goto label$1799$53;
			label$1799$43:
			r23 = r0->realMaxWidth;
			r22 = 0;
			r24 = (double)r22;
			if( !(r23 < r24) ) goto label$1799$50;
			r22 = 0;
			r16 = r22;
			goto label$1799$53;
			label$1799$50:
			r23 = r0->realMaxWidth;
			r22 = (int)r23;
			r16 = r22;
			label$1799$53:
			r21 = (venum*)global$436;
			if( r15 == r21 ) goto label$1799$57;
			r21 = (venum*)global$434;
			if( r15 != r21 ) goto label$1799$59;
			label$1799$57:
			r22 = 1;
			goto label$1799$60;
			label$1799$59:
			r22 = 0;
			label$1799$60:
			r25 = 0;
			if( r17 == NULL ) hl_null_access();
			r26 = r17->length;
			label$1799$63:
			if( r25 >= r26 ) goto label$1799$86;
			r27 = r25;
			++r25;
			if( r4 == NULL ) hl_null_access();
			r31 = r4->length;
			if( ((unsigned)r27) < ((unsigned)r31) ) goto label$1799$72;
			r30 = 0;
			goto label$1799$76;
			label$1799$72:
			r18 = r4->bytes;
			r31 = 2;
			r31 = r27 << r31;
			r30 = *(int*)(r18 + r31);
			label$1799$76:
			r29 = r16 - r30;
			r29 = r29 >> r22;
			r30 = r4->length;
			if( ((unsigned)r27) < ((unsigned)r30) ) goto label$1799$81;
			hl_types_ArrayBytes_Int___expand(r4,r27);
			label$1799$81:
			r18 = r4->bytes;
			r30 = 2;
			r30 = r27 << r30;
			*(int*)(r18 + r30) = r29;
			goto label$1799$63;
			label$1799$86:
			if( r4 == NULL ) hl_null_access();
			r32 = hl_types_ArrayBytes_Int_shift(r4);
			r25 = r32 ? r32->v.i : 0;
			r10 = r25;
			r13 = r25;
	}
	label$1799$91:
	r33 = r0->font;
	if( r33 == NULL ) hl_null_access();
	r16 = r33->lineHeight;
	r22 = r0->lineSpacing;
	r16 = r16 + r22;
	if( r6 ) goto label$1799$101;
	if( r5 ) goto label$1799$101;
	if( !r4 ) goto label$1799$101;
	r34 = true;
	goto label$1799$102;
	label$1799$101:
	r34 = false;
	label$1799$102:
	r22 = 0;
	r35 = NULL;
	r36 = NULL;
	r19 = h2d_Text_splitText(r0,r1,r35,r36);
	r25 = 0;
	if( r19 == NULL ) hl_null_access();
	r26 = r19->length;
	label$1799$109:
	if( r25 >= r26 ) goto label$1799$206;
	if( r19 == NULL ) hl_null_access();
	r27 = r25;
	++r25;
	r32 = String_charCodeAt(r19,r27);
	r33 = r0->font;
	r27 = r32 ? r32->v.i : 0;
	if( r33 == NULL ) hl_null_access();
	r39 = r33->glyphs;
	if( r39 == NULL ) hl_null_access();
	r38 = haxe_ds_IntMap_get(r39,r27);
	r40 = (h2d__FontChar)r38;
	if( r40 ) goto label$1799$138;
	r42 = r33->charset;
	if( r42 == NULL ) hl_null_access();
	r39 = r33->glyphs;
	r38 = hxd_Charset_resolveChar(r42,r27,r39);
	r41 = (h2d__FontChar)r38;
	r40 = r41;
	if( r41 ) goto label$1799$138;
	r29 = 13;
	if( r27 == r29 ) goto label$1799$134;
	r29 = 10;
	if( r27 != r29 ) goto label$1799$136;
	label$1799$134:
	r41 = r33->nullChar;
	goto label$1799$137;
	label$1799$136:
	r41 = r33->defaultChar;
	label$1799$137:
	r40 = r41;
	label$1799$138:
	if( r40 == NULL ) hl_null_access();
	r28 = h2d_FontChar_getKerningOffset(r40,r14);
	r29 = r40->width;
	r29 = r29 + r28;
	r30 = 10;
	r43 = hl_alloc_dynamic(&type$3);
	r43->v.i = r30;
	if( r32 != r43 && (!r32 || !r43 || (r32->v.i != r43->v.i)) ) goto label$1799$168;
	if( r12 >= r10 ) goto label$1799$147;
	r12 = r10;
	label$1799$147:
	if( !r34 ) goto label$1799$150;
	if( r4 == NULL ) hl_null_access();
	r30 = hl_types_ArrayBytes_Int_push(r4,r10);
	label$1799$150:
	if( r15 == NULL ) hl_null_access();
	r30 = HL__ENUM_INDEX__(r15);
	switch(r30) {
		default:
			goto label$1799$163;
		case 0:
			r30 = 0;
			r10 = r30;
			goto label$1799$163;
		case 1:
		case 2:
		case 3:
		case 4:
			if( r4 == NULL ) hl_null_access();
			r37 = hl_types_ArrayBytes_Int_shift(r4);
			r30 = r37 ? r37->v.i : 0;
			r10 = r30;
			if( r30 >= r13 ) goto label$1799$163;
			r13 = r30;
	}
	label$1799$163:
	r30 = r11 + r16;
	r11 = r30;
	r30 = -1;
	r14 = r30;
	goto label$1799$205;
	label$1799$168:
	if( !r40 ) goto label$1799$203;
	if( !r5 ) goto label$1799$189;
	r9 = r0->glyphs;
	if( r9 == NULL ) hl_null_access();
	r45 = r9->content;
	if( r45 == NULL ) hl_null_access();
	r30 = r10 + r28;
	r46 = r9->curColor;
	if( r46 == NULL ) hl_null_access();
	r23 = r46->x;
	r46 = r9->curColor;
	if( r46 == NULL ) hl_null_access();
	r24 = r46->y;
	r46 = r9->curColor;
	if( r46 == NULL ) hl_null_access();
	r47 = r46->z;
	r46 = r9->curColor;
	if( r46 == NULL ) hl_null_access();
	r48 = r46->w;
	r49 = r40->_t;
	h2d__TileGroup_TileLayerContent_add(r45,r30,r11,r23,r24,r47,r48,r49);
	label$1799$189:
	r31 = 0;
	if( r11 != r31 ) goto label$1799$199;
	r49 = r40->_t;
	if( r49 == NULL ) hl_null_access();
	r30 = r49->dy;
	if( r30 >= r22 ) goto label$1799$199;
	r49 = r40->_t;
	if( r49 == NULL ) hl_null_access();
	r30 = r49->dy;
	r22 = r30;
	label$1799$199:
	r50 = r0->letterSpacing;
	r31 = r29 + r50;
	r30 = r10 + r31;
	r10 = r30;
	label$1799$203:
	r30 = r32 ? r32->v.i : 0;
	r14 = r30;
	label$1799$205:
	goto label$1799$109;
	label$1799$206:
	if( !r34 ) goto label$1799$209;
	if( r4 == NULL ) hl_null_access();
	r25 = hl_types_ArrayBytes_Int_push(r4,r10);
	label$1799$209:
	if( r12 >= r10 ) goto label$1799$211;
	r12 = r10;
	label$1799$211:
	r0->calcXMin = r13;
	r0->calcYMin = r22;
	r25 = r12 - r13;
	r0->calcWidth = r25;
	r33 = r0->font;
	if( r33 == NULL ) hl_null_access();
	r26 = r33->lineHeight;
	r25 = r11 + r26;
	r0->calcHeight = r25;
	r33 = r0->font;
	if( r33 == NULL ) hl_null_access();
	r26 = r33->baseLine;
	r27 = 0;
	if( r27 >= r26 ) goto label$1799$229;
	r33 = r0->font;
	if( r33 == NULL ) hl_null_access();
	r26 = r33->baseLine;
	goto label$1799$232;
	label$1799$229:
	r33 = r0->font;
	if( r33 == NULL ) hl_null_access();
	r26 = r33->lineHeight;
	label$1799$232:
	r25 = r11 + r26;
	r0->calcSizeHeight = r25;
	r44 = true;
	r0->calcDone = r44;
	return;
}

void h2d_Text_updateSize(h2d__Text r0) {
	bool *r4, *r5;
	String r3;
	bool r2;
	hl__types__ArrayBytes_Int r6;
	r2 = r0->calcDone;
	if( r2 ) goto label$1800$8;
	r3 = r0->text;
	r2 = false;
	r4 = &r2;
	r5 = NULL;
	r6 = NULL;
	h2d_Text_initGlyphs(r0,r3,r4,r5,r6);
	label$1800$8:
	return;
}

int h2d_Text_get_textHeight(h2d__Text r0) {
	bool *r4, *r5;
	String r3;
	bool r2;
	hl__types__ArrayBytes_Int r6;
	int r7;
	r2 = r0->calcDone;
	if( r2 ) goto label$1801$8;
	r3 = r0->text;
	r2 = false;
	r4 = &r2;
	r5 = NULL;
	r6 = NULL;
	h2d_Text_initGlyphs(r0,r3,r4,r5,r6);
	label$1801$8:
	r7 = r0->calcHeight;
	return r7;
}

int h2d_Text_get_textWidth(h2d__Text r0) {
	bool *r4, *r5;
	String r3;
	bool r2;
	hl__types__ArrayBytes_Int r6;
	int r7;
	r2 = r0->calcDone;
	if( r2 ) goto label$1802$8;
	r3 = r0->text;
	r2 = false;
	r4 = &r2;
	r5 = NULL;
	r6 = NULL;
	h2d_Text_initGlyphs(r0,r3,r4,r5,r6);
	label$1802$8:
	r7 = r0->calcWidth;
	return r7;
}

vdynamic* h2d_Text_set_maxWidth(h2d__Text r0,vdynamic* r1) {
	vdynamic *r3;
	r3 = r0->maxWidth;
	if( r3 != r1 && (!r3 || !r1 || (r3->v.d != r1->v.d)) ) goto label$1803$3;
	return r1;
	label$1803$3:
	r0->maxWidth = r1;
	h2d_Text_updateConstraint(r0);
	return r1;
}

void h2d_Text_updateConstraint(h2d__Text r0) {
	double r1, r4, r6, r7;
	vdynamic *r3;
	int r5;
	r1 = r0->realMaxWidth;
	r3 = r0->maxWidth;
	if( r3 ) goto label$1804$6;
	r4 = r0->constraintWidth;
	r0->realMaxWidth = r4;
	goto label$1804$22;
	label$1804$6:
	r4 = r0->constraintWidth;
	r5 = 0;
	r6 = (double)r5;
	if( !(r4 < r6) ) goto label$1804$14;
	r3 = r0->maxWidth;
	r4 = r3 ? r3->v.d : 0;
	r0->realMaxWidth = r4;
	goto label$1804$22;
	label$1804$14:
	r3 = r0->maxWidth;
	r4 = r3 ? r3->v.d : 0;
	r6 = r0->constraintWidth;
	if( !(r6 < r4) ) goto label$1804$20;
	r7 = r6;
	goto label$1804$21;
	label$1804$20:
	r7 = r4;
	label$1804$21:
	r0->realMaxWidth = r7;
	label$1804$22:
	r4 = r0->realMaxWidth;
	if( r4 == r1 ) goto label$1804$25;
	h2d_Text_rebuild(r0);
	label$1804$25:
	return;
}

int h2d_Text_set_textColor(h2d__Text r0,int r1) {
	h3d__Vector r5;
	double r4, r6, r7;
	int r2, r3;
	r2 = r0->textColor;
	if( r2 != r1 ) goto label$1805$3;
	return r1;
	label$1805$3:
	r0->textColor = r1;
	r5 = r0->color;
	if( r5 == NULL ) hl_null_access();
	r4 = r5->w;
	r5 = r0->color;
	if( r5 == NULL ) hl_null_access();
	r3 = 16;
	r2 = r1 >> r3;
	r3 = 255;
	r2 = r2 & r3;
	r6 = (double)r2;
	r2 = 255;
	r7 = (double)r2;
	r6 = r6 / r7;
	r5->x = r6;
	r3 = 8;
	r2 = r1 >> r3;
	r3 = 255;
	r2 = r2 & r3;
	r6 = (double)r2;
	r2 = 255;
	r7 = (double)r2;
	r6 = r6 / r7;
	r5->y = r6;
	r3 = 255;
	r2 = r1 & r3;
	r6 = (double)r2;
	r2 = 255;
	r7 = (double)r2;
	r6 = r6 / r7;
	r5->z = r6;
	r3 = 24;
	r2 = ((unsigned)r1) >> r3;
	r6 = (double)r2;
	r2 = 255;
	r7 = (double)r2;
	r6 = r6 / r7;
	r5->w = r6;
	r5 = r0->color;
	if( r5 == NULL ) hl_null_access();
	r5->w = r4;
	return r1;
}

void h2d_Text_getBoundsRec(h2d__Text r0,h2d__Object r1,h2d__col__Bounds r2,bool r3) {
	bool *r7, *r8;
	String r6;
	bool r5;
	hl__types__ArrayBytes_Int r9;
	double r13, r14, r16, r18;
	int r10, r11, r12, r15, r17;
	h2d_Object_getBoundsRec(((h2d__Object)r0),r1,r2,r3);
	r5 = r0->calcDone;
	if( r5 ) goto label$1806$9;
	r6 = r0->text;
	r5 = false;
	r7 = &r5;
	r8 = NULL;
	r9 = NULL;
	h2d_Text_initGlyphs(r0,r6,r7,r8,r9);
	label$1806$9:
	if( !r3 ) goto label$1806$20;
	r11 = r0->calcXMin;
	r10 = r11;
	r12 = 0;
	r11 = r12;
	r12 = r0->calcWidth;
	r14 = (double)r12;
	r13 = r14;
	r15 = r0->calcSizeHeight;
	r12 = r15;
	goto label$1806$43;
	label$1806$20:
	r14 = r0->realMaxWidth;
	r15 = 0;
	r16 = (double)r15;
	if( !(r14 >= r16) ) goto label$1806$26;
	r15 = 0;
	goto label$1806$27;
	label$1806$26:
	r15 = r0->calcXMin;
	label$1806$27:
	r10 = r15;
	r15 = r0->calcYMin;
	r11 = r15;
	r14 = r0->realMaxWidth;
	r15 = 0;
	r16 = (double)r15;
	if( !(r14 >= r16) ) goto label$1806$36;
	r14 = r0->realMaxWidth;
	goto label$1806$38;
	label$1806$36:
	r15 = r0->calcWidth;
	r14 = (double)r15;
	label$1806$38:
	r13 = r14;
	r15 = r0->calcHeight;
	r17 = r0->calcYMin;
	r15 = r15 - r17;
	r12 = r15;
	label$1806$43:
	r14 = (double)r10;
	r16 = (double)r11;
	r18 = (double)r12;
	h2d_Object_addBounds(((h2d__Object)r0),r1,r2,r14,r16,r13,r18);
	return;
}

void h2d_Text_new(h2d__Text r0,h2d__Font r1,h2d__Object r2) {
	String r8;
	venum *r6;
	h2d__Font r5;
	double r3;
	int r7;
	r3 = -1.;
	r0->realMaxWidth = r3;
	r3 = -1.;
	r0->constraintWidth = r3;
	h2d_Drawable_new(((h2d__Drawable)r0),r2);
	r5 = h2d_Text_set_font(r0,r1);
	r6 = (venum*)global$433;
	r6 = h2d_Text_set_textAlign(r0,r6);
	r7 = 1;
	r7 = h2d_Text_set_letterSpacing(r0,r7);
	r7 = 0;
	r7 = h2d_Text_set_lineSpacing(r0,r7);
	r8 = (String)global$8;
	r8 = h2d_Text_set_text(r0,r8);
	r7 = 16777215;
	r7 = h2d_Text_set_textColor(r0,r7);
	return;
}

