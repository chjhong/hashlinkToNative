// Generated by HLC 4.0.0 (HL v4)
#include <hl/code.h>

hl__types__ArrayObj haxe_CallStack_makeStack(varray* r0) {
	String r7, r8, r15, r17;
	hl__types__ArrayObj r1;
	venum *r16;
	hl_type *r3;
	bool r14;
	EReg r6, r9;
	vdynamic *r18;
	vbyte *r13;
	int r4, r10, r11, r12;
	varray *r2;
	r3 = &type$954;
	r4 = 0;
	r2 = hl_alloc_array(r3,r4);
	r1 = hl_types_ArrayObj_alloc(r2);
	r6 = (EReg)hl_alloc_obj(EReg__val);
	r7 = (String)global$750;
	r8 = (String)global$8;
	EReg_new(r6,r7,r8);
	r9 = (EReg)hl_alloc_obj(EReg__val);
	r7 = (String)global$751;
	r8 = (String)global$8;
	EReg_new(r9,r7,r8);
	r4 = 0;
	r10 = r0->size;
	r11 = 1;
	r10 = r10 - r11;
	label$3072$16:
	if( r4 >= r10 ) goto label$3072$67;
	r11 = r4;
	++r4;
	r13 = ((vbyte**)(r0 + 1))[r11];
	r7 = (String)hl_alloc_obj(String__val);
	r7->bytes = r13;
	r12 = 0;
	r12 = hl_ucs2length(r13,r12);
	r7->length = r12;
	if( r6 == NULL ) hl_null_access();
	r14 = EReg_match(r6,r7);
	if( !r14 ) goto label$3072$45;
	if( r1 == NULL ) hl_null_access();
	r12 = 1;
	r15 = EReg_matched(r6,r12);
	r12 = 2;
	r17 = EReg_matched(r6,r12);
	r16 = hl_alloc_enum(&type$954,3);
	((haxe_StackItem_Method*)r16)->p0 = r15;
	((haxe_StackItem_Method*)r16)->p1 = r17;
	r12 = 3;
	r15 = EReg_matched(r6,r12);
	r12 = 4;
	r17 = EReg_matched(r6,r12);
	r18 = Std_parseInt(r17);
	r12 = r18 ? r18->v.i : 0;
	r18 = NULL;
	{ venum *tmp;
	tmp = hl_alloc_enum(&type$954,2);
	((haxe_StackItem_FilePos*)tmp)->p0 = r16;
	((haxe_StackItem_FilePos*)tmp)->p1 = r15;
	((haxe_StackItem_FilePos*)tmp)->p2 = r12;
	((haxe_StackItem_FilePos*)tmp)->p3 = r18;
	r16 = tmp; };
	r12 = hl_types_ArrayObj_push(r1,((vdynamic*)r16));
	goto label$3072$66;
	label$3072$45:
	if( r9 == NULL ) hl_null_access();
	r14 = EReg_match(r9,r7);
	if( !r14 ) goto label$3072$63;
	if( r1 == NULL ) hl_null_access();
	r12 = 1;
	r15 = EReg_matched(r9,r12);
	r18 = Std_parseInt(r15);
	r16 = hl_alloc_enum(&type$954,4);
	((haxe_StackItem_LocalFunction*)r16)->p0 = r18;
	r12 = 2;
	r15 = EReg_matched(r9,r12);
	r12 = 3;
	r17 = EReg_matched(r9,r12);
	r18 = Std_parseInt(r17);
	r12 = r18 ? r18->v.i : 0;
	r18 = NULL;
	{ venum *tmp;
	tmp = hl_alloc_enum(&type$954,2);
	((haxe_StackItem_FilePos*)tmp)->p0 = r16;
	((haxe_StackItem_FilePos*)tmp)->p1 = r15;
	((haxe_StackItem_FilePos*)tmp)->p2 = r12;
	((haxe_StackItem_FilePos*)tmp)->p3 = r18;
	r16 = tmp; };
	r12 = hl_types_ArrayObj_push(r1,((vdynamic*)r16));
	goto label$3072$66;
	label$3072$63:
	if( r1 == NULL ) hl_null_access();
	r16 = hl_alloc_enum(&type$954,1);
	((haxe_StackItem_Module*)r16)->p0 = r7;
	r12 = hl_types_ArrayObj_push(r1,((vdynamic*)r16));
	label$3072$66:
	goto label$3072$16;
	label$3072$67:
	return r1;
}

void haxe_CallStack_itemToString(StringBuf r0,venum* r1) {
	String r5;
	venum *r4;
	vdynamic *r6, *r7;
	int r3;
	if( r1 == NULL ) hl_null_access();
	r3 = HL__ENUM_INDEX__(r1);
	switch(r3) {
		default:
			goto label$3074$50;
		case 0:
			if( r0 == NULL ) hl_null_access();
			r5 = (String)global$745;
			StringBuf_add(r0,((vdynamic*)r5));
			goto label$3074$50;
		case 1:
			if( r0 == NULL ) hl_null_access();
			r5 = (String)global$746;
			StringBuf_add(r0,((vdynamic*)r5));
			r5 = ((haxe_StackItem_Module*)r1)->p0;
			StringBuf_add(r0,((vdynamic*)r5));
			goto label$3074$50;
		case 2:
			r6 = ((haxe_StackItem_FilePos*)r1)->p3;
			r4 = ((haxe_StackItem_FilePos*)r1)->p0;
			if( !r4 ) goto label$3074$21;
			haxe_CallStack_itemToString(r0,r4);
			if( r0 == NULL ) hl_null_access();
			r5 = (String)global$747;
			StringBuf_add(r0,((vdynamic*)r5));
			label$3074$21:
			if( r0 == NULL ) hl_null_access();
			r5 = ((haxe_StackItem_FilePos*)r1)->p1;
			StringBuf_add(r0,((vdynamic*)r5));
			r5 = (String)global$509;
			StringBuf_add(r0,((vdynamic*)r5));
			r3 = ((haxe_StackItem_FilePos*)r1)->p2;
			r7 = hl_alloc_dynamic(&type$3);
			r7->v.i = r3;
			StringBuf_add(r0,((vdynamic*)r7));
			if( !r6 ) goto label$3074$33;
			r5 = (String)global$748;
			StringBuf_add(r0,((vdynamic*)r5));
			StringBuf_add(r0,((vdynamic*)r6));
			label$3074$33:
			if( !r4 ) goto label$3074$36;
			r5 = (String)global$177;
			StringBuf_add(r0,((vdynamic*)r5));
			label$3074$36:
			goto label$3074$50;
		case 3:
			if( r0 == NULL ) hl_null_access();
			r5 = ((haxe_StackItem_Method*)r1)->p0;
			StringBuf_add(r0,((vdynamic*)r5));
			r5 = (String)global$210;
			StringBuf_add(r0,((vdynamic*)r5));
			r5 = ((haxe_StackItem_Method*)r1)->p1;
			StringBuf_add(r0,((vdynamic*)r5));
			goto label$3074$50;
		case 4:
			if( r0 == NULL ) hl_null_access();
			r5 = (String)global$749;
			StringBuf_add(r0,((vdynamic*)r5));
			r6 = ((haxe_StackItem_LocalFunction*)r1)->p0;
			StringBuf_add(r0,((vdynamic*)r6));
	}
	label$3074$50:
	return;
}

String haxe_CallStack_toString(hl__types__ArrayObj r0) {
	String r9;
	venum *r6;
	StringBuf r1;
	vdynamic *r7;
	varray *r8;
	int r3, r4, r5;
	r1 = (StringBuf)hl_alloc_obj(StringBuf__val);
	StringBuf_new(r1);
	r3 = 0;
	label$3073$3:
	if( r0 == NULL ) hl_null_access();
	r5 = r0->length;
	if( r3 >= r5 ) goto label$3073$21;
	r4 = r3;
	++r3;
	r5 = r0->length;
	if( ((unsigned)r4) < ((unsigned)r5) ) goto label$3073$13;
	r6 = NULL;
	goto label$3073$16;
	label$3073$13:
	r8 = r0->array;
	r7 = ((vdynamic**)(r8 + 1))[r4];
	r6 = (venum*)r7;
	label$3073$16:
	if( r1 == NULL ) hl_null_access();
	r9 = (String)global$744;
	StringBuf_add(r1,((vdynamic*)r9));
	haxe_CallStack_itemToString(r1,r6);
	goto label$3073$3;
	label$3073$21:
	if( r1 == NULL ) hl_null_access();
	r9 = StringBuf_toString(r1);
	return r9;
}

hl__types__ArrayObj haxe_CallStack_exceptionStack() {
	hl__types__ArrayObj r0;
	varray *r1;
	r1 = hl_exception_stack();
	r0 = haxe_CallStack_makeStack(r1);
	return r0;
}

