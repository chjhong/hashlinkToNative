// Generated by HLC 4.0.0 (HL v4)
#include <hl/code.h>

void haxe_xml_Printer_writeNode(haxe__xml__Printer r0,Xml r1,String r2) {
	String r7, r8, r17;
	hl__types__ArrayObj r19;
	bool r14;
	EReg r21;
	$Xml r10;
	Xml r5;
	StringBuf r6;
	vclosure *r15, *r16, *r20;
	vdynamic *r13, *r18;
	int *r11;
	vbyte *r12;
	int r4, r9;
	if( r1 == NULL ) hl_null_access();
	r4 = r1->nodeType;
	switch(r4) {
		default:
			goto label$3168$344;
		case 0:
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r8 = (String)global$872;
			r7 = String___add__(r2,r8);
			StringBuf_add(r6,((vdynamic*)r7));
			r4 = r1->nodeType;
			r10 = ($Xml)global$224;
			r9 = r10->Element;
			if( r4 == r9 ) goto label$3168$20;
			r7 = (String)global$225;
			r4 = r1->nodeType;
			r11 = &r4;
			r12 = hl_itos(r4,r11);
			r8 = String___alloc__(r12,r4);
			r7 = String___add__(r7,r8);
			hl_throw((vdynamic*)r7);
			label$3168$20:
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r7 = r1->nodeName;
			StringBuf_add(r6,((vdynamic*)r7));
			r13 = Xml_attributes(r1);
			label$3168$25:
			if( r13 == NULL ) hl_null_access();
			r15 = (vclosure*)hl_dyn_getp((vdynamic*)r13,407283053/*hasNext*/,&type$118);
			if( r15 == NULL ) hl_null_access();
			r14 = r15->hasValue ? ((bool (*)(vdynamic*))r15->fun)((vdynamic*)r15->value) : ((bool (*)(void))r15->fun)();
			if( !r14 ) goto label$3168$54;
			r16 = (vclosure*)hl_dyn_getp((vdynamic*)r13,151160317/*next*/,&type$378);
			if( r16 == NULL ) hl_null_access();
			r7 = r16->hasValue ? ((String (*)(vdynamic*))r16->fun)((vdynamic*)r16->value) : ((String (*)(void))r16->fun)();
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r8 = (String)global$192;
			r8 = String___add__(r8,r7);
			r17 = (String)global$873;
			r8 = String___add__(r8,r17);
			StringBuf_add(r6,((vdynamic*)r8));
			if( r1 == NULL ) hl_null_access();
			r8 = Xml_get(r1,r7);
			r14 = true;
			r18 = hl_alloc_dynbool(r14);
			r8 = StringTools_htmlEscape(r8,r18);
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			StringBuf_add(r6,((vdynamic*)r8));
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r8 = (String)global$194;
			StringBuf_add(r6,((vdynamic*)r8));
			goto label$3168$25;
			label$3168$54:
			r14 = haxe_xml_Printer_hasChildren(r0,r1);
			if( !r14 ) goto label$3168$134;
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r7 = (String)global$739;
			StringBuf_add(r6,((vdynamic*)r7));
			r14 = r0->pretty;
			if( !r14 ) goto label$3168$66;
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r7 = (String)global$205;
			StringBuf_add(r6,((vdynamic*)r7));
			label$3168$66:
			if( r1 == NULL ) hl_null_access();
			r4 = r1->nodeType;
			r10 = ($Xml)global$224;
			r9 = r10->Document;
			if( r4 == r9 ) goto label$3168$82;
			r4 = r1->nodeType;
			r10 = ($Xml)global$224;
			r9 = r10->Element;
			if( r4 == r9 ) goto label$3168$82;
			r7 = (String)global$227;
			r4 = r1->nodeType;
			r11 = &r4;
			r12 = hl_itos(r4,r11);
			r8 = String___alloc__(r12,r4);
			r7 = String___add__(r7,r8);
			hl_throw((vdynamic*)r7);
			label$3168$82:
			r19 = r1->children;
			if( r19 == NULL ) hl_null_access();
			r13 = hl_types_ArrayObj_iterator(r19);
			label$3168$85:
			if( r13 == NULL ) hl_null_access();
			r15 = (vclosure*)hl_dyn_getp((vdynamic*)r13,407283053/*hasNext*/,&type$118);
			if( r15 == NULL ) hl_null_access();
			r14 = r15->hasValue ? ((bool (*)(vdynamic*))r15->fun)((vdynamic*)r15->value) : ((bool (*)(void))r15->fun)();
			if( !r14 ) goto label$3168$102;
			r20 = (vclosure*)hl_dyn_getp((vdynamic*)r13,151160317/*next*/,&type$385);
			if( r20 == NULL ) hl_null_access();
			r5 = r20->hasValue ? ((Xml (*)(vdynamic*))r20->fun)((vdynamic*)r20->value) : ((Xml (*)(void))r20->fun)();
			r14 = r0->pretty;
			if( !r14 ) goto label$3168$99;
			r8 = (String)global$193;
			r7 = String___add__(r2,r8);
			goto label$3168$100;
			label$3168$99:
			r7 = r2;
			label$3168$100:
			haxe_xml_Printer_writeNode(r0,r5,r7);
			goto label$3168$85;
			label$3168$102:
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r8 = (String)global$874;
			r7 = String___add__(r2,r8);
			StringBuf_add(r6,((vdynamic*)r7));
			if( r1 == NULL ) hl_null_access();
			r4 = r1->nodeType;
			r10 = ($Xml)global$224;
			r9 = r10->Element;
			if( r4 == r9 ) goto label$3168$119;
			r7 = (String)global$225;
			r4 = r1->nodeType;
			r11 = &r4;
			r12 = hl_itos(r4,r11);
			r8 = String___alloc__(r12,r4);
			r7 = String___add__(r7,r8);
			hl_throw((vdynamic*)r7);
			label$3168$119:
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r7 = r1->nodeName;
			StringBuf_add(r6,((vdynamic*)r7));
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r7 = (String)global$739;
			StringBuf_add(r6,((vdynamic*)r7));
			r14 = r0->pretty;
			if( !r14 ) goto label$3168$133;
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r7 = (String)global$205;
			StringBuf_add(r6,((vdynamic*)r7));
			label$3168$133:
			goto label$3168$144;
			label$3168$134:
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r7 = (String)global$875;
			StringBuf_add(r6,((vdynamic*)r7));
			r14 = r0->pretty;
			if( !r14 ) goto label$3168$144;
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r7 = (String)global$205;
			StringBuf_add(r6,((vdynamic*)r7));
			label$3168$144:
			goto label$3168$344;
		case 1:
			r4 = r1->nodeType;
			r10 = ($Xml)global$224;
			r9 = r10->Document;
			if( r4 == r9 ) goto label$3168$153;
			r4 = r1->nodeType;
			r10 = ($Xml)global$224;
			r9 = r10->Element;
			if( r4 != r9 ) goto label$3168$160;
			label$3168$153:
			r7 = (String)global$226;
			r4 = r1->nodeType;
			r11 = &r4;
			r12 = hl_itos(r4,r11);
			r8 = String___alloc__(r12,r4);
			r7 = String___add__(r7,r8);
			hl_throw((vdynamic*)r7);
			label$3168$160:
			r7 = r1->nodeValue;
			if( r7 == NULL ) hl_null_access();
			r4 = r7->length;
			r9 = 0;
			if( r4 == r9 ) goto label$3168$177;
			r18 = NULL;
			r17 = StringTools_htmlEscape(r7,r18);
			r8 = String___add__(r2,r17);
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			StringBuf_add(r6,((vdynamic*)r8));
			r14 = r0->pretty;
			if( !r14 ) goto label$3168$177;
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r8 = (String)global$205;
			StringBuf_add(r6,((vdynamic*)r8));
			label$3168$177:
			goto label$3168$344;
		case 2:
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r8 = (String)global$876;
			r7 = String___add__(r2,r8);
			StringBuf_add(r6,((vdynamic*)r7));
			r4 = r1->nodeType;
			r10 = ($Xml)global$224;
			r9 = r10->Document;
			if( r4 == r9 ) goto label$3168$191;
			r4 = r1->nodeType;
			r10 = ($Xml)global$224;
			r9 = r10->Element;
			if( r4 != r9 ) goto label$3168$198;
			label$3168$191:
			r7 = (String)global$226;
			r4 = r1->nodeType;
			r11 = &r4;
			r12 = hl_itos(r4,r11);
			r8 = String___alloc__(r12,r4);
			r7 = String___add__(r7,r8);
			hl_throw((vdynamic*)r7);
			label$3168$198:
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r7 = r1->nodeValue;
			StringBuf_add(r6,((vdynamic*)r7));
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r7 = (String)global$877;
			StringBuf_add(r6,((vdynamic*)r7));
			r14 = r0->pretty;
			if( !r14 ) goto label$3168$212;
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r7 = (String)global$205;
			StringBuf_add(r6,((vdynamic*)r7));
			label$3168$212:
			goto label$3168$344;
		case 3:
			r4 = r1->nodeType;
			r10 = ($Xml)global$224;
			r9 = r10->Document;
			if( r4 == r9 ) goto label$3168$221;
			r4 = r1->nodeType;
			r10 = ($Xml)global$224;
			r9 = r10->Element;
			if( r4 != r9 ) goto label$3168$228;
			label$3168$221:
			r7 = (String)global$226;
			r4 = r1->nodeType;
			r11 = &r4;
			r12 = hl_itos(r4,r11);
			r8 = String___alloc__(r12,r4);
			r7 = String___add__(r7,r8);
			hl_throw((vdynamic*)r7);
			label$3168$228:
			r7 = r1->nodeValue;
			r21 = (EReg)hl_alloc_obj(EReg__val);
			r8 = (String)global$878;
			r17 = (String)global$7;
			EReg_new(r21,r8,r17);
			r17 = (String)global$8;
			r8 = EReg_replace(r21,r7,r17);
			r7 = r8;
			r8 = (String)global$879;
			r8 = String___add__(r8,r7);
			r17 = (String)global$880;
			r8 = String___add__(r8,r17);
			r7 = r8;
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			StringBuf_add(r6,((vdynamic*)r2));
			r8 = StringTools_trim(r7);
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			StringBuf_add(r6,((vdynamic*)r8));
			r14 = r0->pretty;
			if( !r14 ) goto label$3168$254;
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r8 = (String)global$205;
			StringBuf_add(r6,((vdynamic*)r8));
			label$3168$254:
			goto label$3168$344;
		case 4:
			r4 = r1->nodeType;
			r10 = ($Xml)global$224;
			r9 = r10->Document;
			if( r4 == r9 ) goto label$3168$263;
			r4 = r1->nodeType;
			r10 = ($Xml)global$224;
			r9 = r10->Element;
			if( r4 != r9 ) goto label$3168$270;
			label$3168$263:
			r7 = (String)global$226;
			r4 = r1->nodeType;
			r11 = &r4;
			r12 = hl_itos(r4,r11);
			r8 = String___alloc__(r12,r4);
			r7 = String___add__(r7,r8);
			hl_throw((vdynamic*)r7);
			label$3168$270:
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r7 = (String)global$881;
			r8 = r1->nodeValue;
			r7 = String___add__(r7,r8);
			r8 = (String)global$739;
			r7 = String___add__(r7,r8);
			StringBuf_add(r6,((vdynamic*)r7));
			r14 = r0->pretty;
			if( !r14 ) goto label$3168$284;
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r7 = (String)global$205;
			StringBuf_add(r6,((vdynamic*)r7));
			label$3168$284:
			goto label$3168$344;
		case 5:
			r4 = r1->nodeType;
			r10 = ($Xml)global$224;
			r9 = r10->Document;
			if( r4 == r9 ) goto label$3168$293;
			r4 = r1->nodeType;
			r10 = ($Xml)global$224;
			r9 = r10->Element;
			if( r4 != r9 ) goto label$3168$300;
			label$3168$293:
			r7 = (String)global$226;
			r4 = r1->nodeType;
			r11 = &r4;
			r12 = hl_itos(r4,r11);
			r8 = String___alloc__(r12,r4);
			r7 = String___add__(r7,r8);
			hl_throw((vdynamic*)r7);
			label$3168$300:
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r7 = (String)global$882;
			r8 = r1->nodeValue;
			r7 = String___add__(r7,r8);
			r8 = (String)global$883;
			r7 = String___add__(r7,r8);
			StringBuf_add(r6,((vdynamic*)r7));
			r14 = r0->pretty;
			if( !r14 ) goto label$3168$314;
			r6 = r0->output;
			if( r6 == NULL ) hl_null_access();
			r7 = (String)global$205;
			StringBuf_add(r6,((vdynamic*)r7));
			label$3168$314:
			goto label$3168$344;
		case 6:
			r4 = r1->nodeType;
			r10 = ($Xml)global$224;
			r9 = r10->Document;
			if( r4 == r9 ) goto label$3168$330;
			r4 = r1->nodeType;
			r10 = ($Xml)global$224;
			r9 = r10->Element;
			if( r4 == r9 ) goto label$3168$330;
			r7 = (String)global$227;
			r4 = r1->nodeType;
			r11 = &r4;
			r12 = hl_itos(r4,r11);
			r8 = String___alloc__(r12,r4);
			r7 = String___add__(r7,r8);
			hl_throw((vdynamic*)r7);
			label$3168$330:
			r19 = r1->children;
			if( r19 == NULL ) hl_null_access();
			r13 = hl_types_ArrayObj_iterator(r19);
			label$3168$333:
			if( r13 == NULL ) hl_null_access();
			r15 = (vclosure*)hl_dyn_getp((vdynamic*)r13,407283053/*hasNext*/,&type$118);
			if( r15 == NULL ) hl_null_access();
			r14 = r15->hasValue ? ((bool (*)(vdynamic*))r15->fun)((vdynamic*)r15->value) : ((bool (*)(void))r15->fun)();
			if( !r14 ) goto label$3168$344;
			r20 = (vclosure*)hl_dyn_getp((vdynamic*)r13,151160317/*next*/,&type$385);
			if( r20 == NULL ) hl_null_access();
			r5 = r20->hasValue ? ((Xml (*)(vdynamic*))r20->fun)((vdynamic*)r20->value) : ((Xml (*)(void))r20->fun)();
			haxe_xml_Printer_writeNode(r0,r5,r2);
			goto label$3168$333;
	}
	label$3168$344:
	return;
}

bool haxe_xml_Printer_hasChildren(haxe__xml__Printer r0,Xml r1) {
	String r6, r9;
	hl__types__ArrayObj r11;
	bool r12;
	$Xml r5;
	Xml r3;
	vclosure *r13, *r14;
	vdynamic *r10;
	int *r7;
	vbyte *r8;
	int r2, r4;
	if( r1 == NULL ) hl_null_access();
	r2 = r1->nodeType;
	r5 = ($Xml)global$224;
	r4 = r5->Document;
	if( r2 == r4 ) goto label$3169$16;
	r2 = r1->nodeType;
	r5 = ($Xml)global$224;
	r4 = r5->Element;
	if( r2 == r4 ) goto label$3169$16;
	r6 = (String)global$227;
	r2 = r1->nodeType;
	r7 = &r2;
	r8 = hl_itos(r2,r7);
	r9 = String___alloc__(r8,r2);
	r6 = String___add__(r6,r9);
	hl_throw((vdynamic*)r6);
	label$3169$16:
	r11 = r1->children;
	if( r11 == NULL ) hl_null_access();
	r10 = hl_types_ArrayObj_iterator(r11);
	label$3169$19:
	if( r10 == NULL ) hl_null_access();
	r13 = (vclosure*)hl_dyn_getp((vdynamic*)r10,407283053/*hasNext*/,&type$118);
	if( r13 == NULL ) hl_null_access();
	r12 = r13->hasValue ? ((bool (*)(vdynamic*))r13->fun)((vdynamic*)r13->value) : ((bool (*)(void))r13->fun)();
	if( !r12 ) goto label$3169$58;
	r14 = (vclosure*)hl_dyn_getp((vdynamic*)r10,151160317/*next*/,&type$385);
	if( r14 == NULL ) hl_null_access();
	r3 = r14->hasValue ? ((Xml (*)(vdynamic*))r14->fun)((vdynamic*)r14->value) : ((Xml (*)(void))r14->fun)();
	if( r3 == NULL ) hl_null_access();
	r2 = r3->nodeType;
	switch(r2) {
		default:
			goto label$3169$57;
		case 0:
		case 1:
			r12 = true;
			return r12;
		case 2:
		case 3:
			r2 = r3->nodeType;
			r5 = ($Xml)global$224;
			r4 = r5->Document;
			if( r2 == r4 ) goto label$3169$42;
			r2 = r3->nodeType;
			r5 = ($Xml)global$224;
			r4 = r5->Element;
			if( r2 != r4 ) goto label$3169$49;
			label$3169$42:
			r6 = (String)global$226;
			r2 = r3->nodeType;
			r7 = &r2;
			r8 = hl_itos(r2,r7);
			r9 = String___alloc__(r8,r2);
			r6 = String___add__(r6,r9);
			hl_throw((vdynamic*)r6);
			label$3169$49:
			r6 = r3->nodeValue;
			r6 = StringTools_ltrim(r6);
			if( r6 == NULL ) hl_null_access();
			r2 = r6->length;
			r4 = 0;
			if( r2 == r4 ) goto label$3169$57;
			r12 = true;
			return r12;
	}
	label$3169$57:
	goto label$3169$19;
	label$3169$58:
	r12 = false;
	return r12;
}

void haxe_xml_Printer_new(haxe__xml__Printer r0,bool r1) {
	StringBuf r2;
	r2 = (StringBuf)hl_alloc_obj(StringBuf__val);
	StringBuf_new(r2);
	r0->output = r2;
	r0->pretty = r1;
	return;
}

String haxe_xml_Printer_print(Xml r0,vdynamic* r1) {
	String r5;
	bool r2;
	haxe__xml__Printer r3;
	StringBuf r6;
	if( r1 ) goto label$2086$3;
	r2 = false;
	r1 = hl_alloc_dynbool(r2);
	label$2086$3:
	r3 = (haxe__xml__Printer)hl_alloc_obj(haxe__xml__Printer__val);
	r2 = r1 ? r1->v.b : 0;
	haxe_xml_Printer_new(r3,r2);
	r5 = (String)global$8;
	haxe_xml_Printer_writeNode(r3,r0,r5);
	r6 = r3->output;
	if( r6 == NULL ) hl_null_access();
	r5 = StringBuf_toString(r6);
	return r5;
}

