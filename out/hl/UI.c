// Generated by HLC 4.0.0 (HL v4)
#include <hl/code.h>

String hl_UI_chooseFile(bool r0,vvirtual* r1) {
	ui_window *r30;
	String r5, r6, r7, r11, r12;
	vdynobj *r2;
	vvirtual *r23;
	hl__types__ArrayObj r8, r22, r25;
	hl_type *r18;
	haxe__io__Path r10;
	bool r9;
	vdynamic *r3, *r13, *r28;
	hl__Window r29;
	varray *r17, *r24;
	int r15, r16, r19, r20, r21, r26, r27;
	vbyte *r14;
	r2 = hl_alloc_dynobj();
	r3 = ((vdynamic*)r2);
	if( r1 == NULL ) hl_null_access();
	r5 = hl_vfields(r1)[0] ? (*(String*)(hl_vfields(r1)[0])) : (String)hl_dyn_getp(r1->value,37969014/*fileName*/,&type$13);
	if( !r5 ) goto label$3223$44;
	r5 = hl_vfields(r1)[0] ? (*(String*)(hl_vfields(r1)[0])) : (String)hl_dyn_getp(r1->value,37969014/*fileName*/,&type$13);
	r5 = sys_FileSystem_absolutePath(r5);
	r6 = Sys_systemName();
	r7 = (String)global$206;
	if( r6 != r7 && (!r6 || !r7 || String___compare(r6,(vdynamic*)r7) != 0) ) goto label$3223$17;
	if( r5 == NULL ) hl_null_access();
	r7 = (String)global$207;
	r8 = String_split(r5,r7);
	if( r8 == NULL ) hl_null_access();
	r6 = (String)global$196;
	r6 = hl_types_ArrayObj_join(r8,r6);
	r5 = r6;
	label$3223$17:
	r6 = NULL;
	r9 = sys_FileSystem_isDirectory(r5);
	if( !r9 ) goto label$3223$23;
	r6 = r5;
	r7 = NULL;
	goto label$3223$36;
	label$3223$23:
	r10 = (haxe__io__Path)hl_alloc_obj(haxe__io__Path__val);
	haxe_io_Path_new(r10,r5);
	r7 = r10->dir;
	r6 = r7;
	r7 = r10->file;
	r11 = r10->ext;
	if( r11 ) goto label$3223$32;
	r11 = (String)global$8;
	goto label$3223$35;
	label$3223$32:
	r11 = (String)global$210;
	r12 = r10->ext;
	r11 = String___add__(r11,r12);
	label$3223$35:
	r7 = String___add__(r7,r11);
	label$3223$36:
	if( !r7 ) goto label$3223$40;
	if( r7 == NULL ) hl_null_access();
	r14 = r7->bytes;
	hl_dyn_setp((vdynamic*)r2,37969014/*fileName*/,&type$14,r14);
	label$3223$40:
	if( !r6 ) goto label$3223$44;
	if( r6 == NULL ) hl_null_access();
	r14 = r6->bytes;
	hl_dyn_setp((vdynamic*)r2,272953965/*directory*/,&type$14,r14);
	label$3223$44:
	r5 = hl_vfields(r1)[3] ? (*(String*)(hl_vfields(r1)[3])) : (String)hl_dyn_getp(r1->value,272307608/*title*/,&type$13);
	if( !r5 ) goto label$3223$50;
	r5 = hl_vfields(r1)[3] ? (*(String*)(hl_vfields(r1)[3])) : (String)hl_dyn_getp(r1->value,272307608/*title*/,&type$13);
	if( r5 == NULL ) hl_null_access();
	r14 = r5->bytes;
	hl_dyn_setp((vdynamic*)r2,272307608/*title*/,&type$14,r14);
	label$3223$50:
	r8 = hl_vfields(r1)[2] ? (*(hl__types__ArrayObj*)(hl_vfields(r1)[2])) : (hl__types__ArrayObj)hl_dyn_getp(r1->value,155623867/*filters*/,&type$46);
	if( !r8 ) goto label$3223$119;
	r8 = hl_vfields(r1)[2] ? (*(hl__types__ArrayObj*)(hl_vfields(r1)[2])) : (hl__types__ArrayObj)hl_dyn_getp(r1->value,155623867/*filters*/,&type$46);
	if( r8 == NULL ) hl_null_access();
	r15 = r8->length;
	r16 = 2;
	r15 = r15 * r16;
	r18 = &type$14;
	r17 = hl_alloc_array(r18,r15);
	r16 = 0;
	r19 = 0;
	r8 = hl_vfields(r1)[2] ? (*(hl__types__ArrayObj*)(hl_vfields(r1)[2])) : (hl__types__ArrayObj)hl_dyn_getp(r1->value,155623867/*filters*/,&type$46);
	label$3223$62:
	if( r8 == NULL ) hl_null_access();
	r21 = r8->length;
	if( r19 >= r21 ) goto label$3223$114;
	r21 = r8->length;
	if( ((unsigned)r19) < ((unsigned)r21) ) goto label$3223$70;
	r23 = NULL;
	goto label$3223$73;
	label$3223$70:
	r24 = r8->array;
	r13 = ((vdynamic**)(r24 + 1))[r19];
	r23 = hl_to_virtual(&type$3059,(vdynamic*)r13);
	label$3223$73:
	++r19;
	r20 = r16;
	++r16;
	if( r23 == NULL ) hl_null_access();
	r5 = hl_vfields(r23)[1] ? (*(String*)(hl_vfields(r23)[1])) : (String)hl_dyn_getp(r23->value,150958933/*name*/,&type$13);
	if( r5 == NULL ) hl_null_access();
	r14 = r5->bytes;
	((vbyte**)(r17 + 1))[r20] = r14;
	r20 = r16;
	++r16;
	r18 = &type$13;
	r21 = 0;
	r24 = hl_alloc_array(r18,r21);
	r22 = hl_types_ArrayObj_alloc(r24);
	r21 = 0;
	r25 = hl_vfields(r23)[0] ? (*(hl__types__ArrayObj*)(hl_vfields(r23)[0])) : (hl__types__ArrayObj)hl_dyn_getp(r23->value,52298172/*exts*/,&type$46);
	label$3223$89:
	if( r25 == NULL ) hl_null_access();
	r27 = r25->length;
	if( r21 >= r27 ) goto label$3223$107;
	if( r22 == NULL ) hl_null_access();
	r5 = (String)global$894;
	r26 = r21;
	++r21;
	r27 = r25->length;
	if( ((unsigned)r26) < ((unsigned)r27) ) goto label$3223$101;
	r6 = NULL;
	goto label$3223$104;
	label$3223$101:
	r24 = r25->array;
	r13 = ((vdynamic**)(r24 + 1))[r26];
	r6 = (String)r13;
	label$3223$104:
	r5 = String___add__(r5,r6);
	r26 = hl_types_ArrayObj_push(r22,((vdynamic*)r5));
	goto label$3223$89;
	label$3223$107:
	if( r22 == NULL ) hl_null_access();
	r5 = (String)global$868;
	r5 = hl_types_ArrayObj_join(r22,r5);
	if( r5 == NULL ) hl_null_access();
	r14 = r5->bytes;
	((vbyte**)(r17 + 1))[r20] = r14;
	goto label$3223$62;
	label$3223$114:
	if( r3 == NULL ) hl_null_access();
	hl_dyn_setp((vdynamic*)r3,155623867/*filters*/,&type$11,r17);
	if( r1 == NULL ) hl_null_access();
	r28 = hl_vfields(r1)[1] ? (*(vdynamic**)(hl_vfields(r1)[1])) : (vdynamic*)hl_dyn_getp(r1->value,231141833/*filterIndex*/,&type$127);
	hl_dyn_setp((vdynamic*)r3,231141833/*filterIndex*/,&type$127,r28);
	label$3223$119:
	r29 = hl_vfields(r1)[4] ? (*(hl__Window*)(hl_vfields(r1)[4])) : (hl__Window)hl_dyn_getp(r1->value,311203066/*window*/,&type$992);
	if( !r29 ) goto label$3223$125;
	r29 = hl_vfields(r1)[4] ? (*(hl__Window*)(hl_vfields(r1)[4])) : (hl__Window)hl_dyn_getp(r1->value,311203066/*window*/,&type$992);
	if( r29 == NULL ) hl_null_access();
	r30 = r29->h;
	hl_dyn_setp((vdynamic*)r3,311203066/*window*/,&type$993,r30);
	label$3223$125:
	r14 = ui_ui_choose_file(r0,r3);
	if( r14 ) goto label$3223$129;
	r5 = NULL;
	return r5;
	label$3223$129:
	r5 = (String)hl_alloc_obj(String__val);
	r5->bytes = r14;
	r15 = 0;
	r15 = hl_ucs2length(r14,r15);
	r5->length = r15;
	return r5;
}

String hl_UI_saveFile(vvirtual* r0) {
	String r1;
	bool r2;
	r2 = true;
	r1 = hl_UI_chooseFile(r2,r0);
	return r1;
}

String hl_UI_loadFile(vvirtual* r0) {
	String r1;
	bool r2;
	r2 = false;
	r1 = hl_UI_chooseFile(r2,r0);
	return r1;
}

