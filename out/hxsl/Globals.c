// Generated by HLC 4.0.0 (HL v4)
#include <hl/code.h>

void hxsl_Globals_set(hxsl__Globals r0,String r1,vdynamic* r2) {
	haxe__ds__IntMap r4;
	vdynamic *r5;
	int r6;
	r4 = r0->map;
	if( r4 == NULL ) hl_null_access();
	r5 = hxsl_Globals_allocID(r1);
	r6 = r5 ? r5->v.i : 0;
	haxe_ds_IntMap_set(r4,r6,r2);
	return;
}

vdynamic* hxsl_Globals_get(hxsl__Globals r0,String r1) {
	haxe__ds__IntMap r3;
	vdynamic *r2, *r4;
	int r5;
	r3 = r0->map;
	if( r3 == NULL ) hl_null_access();
	r4 = hxsl_Globals_allocID(r1);
	r5 = r4 ? r4->v.i : 0;
	r2 = haxe_ds_IntMap_get(r3,r5);
	return r2;
}

void hxsl_Globals_fastSet(hxsl__Globals r0,int r1,vdynamic* r2) {
	haxe__ds__IntMap r4;
	r4 = r0->map;
	if( r4 == NULL ) hl_null_access();
	haxe_ds_IntMap_set(r4,r1,r2);
	return;
}

vdynamic* hxsl_Globals_fastGet(hxsl__Globals r0,int r1) {
	haxe__ds__IntMap r3;
	vdynamic *r2;
	r3 = r0->map;
	if( r3 == NULL ) hl_null_access();
	r2 = haxe_ds_IntMap_get(r3,r1);
	return r2;
}

void hxsl_Globals_resetChannels(hxsl__Globals r0) {
	int r1;
	r1 = 0;
	r0->maxChannels = r1;
	return;
}

int hxsl_Globals_allocChannelID(hxsl__Globals r0,h3d__mat__Texture r1) {
	String r12;
	hxsl__$Tools r11;
	hl__types__ArrayObj r6;
	vdynamic *r9;
	varray *r10;
	h3d__mat__Texture r8;
	int r2, r4, r5, r7;
	r2 = 0;
	r4 = r0->maxChannels;
	label$908$2:
	if( r2 >= r4 ) goto label$908$18;
	r5 = r2;
	++r2;
	r6 = r0->channels;
	if( r6 == NULL ) hl_null_access();
	r7 = r6->length;
	if( ((unsigned)r5) < ((unsigned)r7) ) goto label$908$12;
	r8 = NULL;
	goto label$908$15;
	label$908$12:
	r10 = r6->array;
	r9 = ((vdynamic**)(r10 + 1))[r5];
	r8 = (h3d__mat__Texture)r9;
	label$908$15:
	if( r8 != r1 ) goto label$908$17;
	return r5;
	label$908$17:
	goto label$908$2;
	label$908$18:
	r2 = r0->maxChannels;
	r4 = 1;
	r11 = (hxsl__$Tools)global$1346;
	r5 = r11->MAX_CHANNELS_BITS;
	r4 = r4 << r5;
	if( r2 != r4 ) goto label$908$26;
	r12 = (String)global$1440;
	hl_throw((vdynamic*)r12);
	label$908$26:
	r2 = r0->maxChannels;
	r4 = r2;
	++r2;
	r0->maxChannels = r2;
	r6 = r0->channels;
	if( r6 == NULL ) hl_null_access();
	r5 = r6->length;
	if( ((unsigned)r4) < ((unsigned)r5) ) goto label$908$35;
	hl_types_ArrayObj___expand(r6,r4);
	label$908$35:
	r10 = r6->array;
	((h3d__mat__Texture*)(r10 + 1))[r4] = r1;
	return r4;
}

void hxsl_Globals_new(hxsl__Globals r0) {
	hl__types__ArrayObj r1;
	hl_type *r3;
	haxe__ds__IntMap r5;
	int r4;
	varray *r2;
	r3 = &type$93;
	r4 = 0;
	r2 = hl_alloc_array(r3,r4);
	r1 = hl_types_ArrayObj_alloc(r2);
	r0->channels = r1;
	r5 = (haxe__ds__IntMap)hl_alloc_obj(haxe__ds__IntMap__val);
	haxe_ds_IntMap_new(r5);
	r0->map = r5;
	return;
}

String hxsl_Globals_getIDName(int r0) {
	String r4;
	hl__types__ArrayObj r1;
	hxsl__$Globals r2;
	vdynamic *r5;
	varray *r6;
	int r3;
	r2 = (hxsl__$Globals)global$84;
	r1 = r2->ALL;
	if( r1 == NULL ) hl_null_access();
	r3 = r1->length;
	if( ((unsigned)r0) < ((unsigned)r3) ) goto label$910$7;
	r4 = NULL;
	goto label$910$10;
	label$910$7:
	r6 = r1->array;
	r5 = ((vdynamic**)(r6 + 1))[r0];
	r4 = (String)r5;
	label$910$10:
	return r4;
}

vdynamic* hxsl_Globals_allocID(String r0) {
	hl__types__ArrayObj r4;
	haxe__ds__StringMap r2;
	hl_type *r6;
	hxsl__$Globals r3;
	vdynamic *r8, *r9, *r10;
	int r7;
	varray *r5;
	r3 = (hxsl__$Globals)global$84;
	r2 = r3->MAP;
	if( r2 ) goto label$909$13;
	r2 = (haxe__ds__StringMap)hl_alloc_obj(haxe__ds__StringMap__val);
	haxe_ds_StringMap_new(r2);
	r3 = (hxsl__$Globals)global$84;
	r3->MAP = r2;
	r6 = &type$13;
	r7 = 0;
	r5 = hl_alloc_array(r6,r7);
	r4 = hl_types_ArrayObj_alloc(r5);
	r3 = (hxsl__$Globals)global$84;
	r3->ALL = r4;
	label$909$13:
	r3 = (hxsl__$Globals)global$84;
	r2 = r3->MAP;
	if( r2 == NULL ) hl_null_access();
	r8 = haxe_ds_StringMap_get(r2,r0);
	r9 = (vdynamic*)r8;
	if( r9 ) goto label$909$33;
	r3 = (hxsl__$Globals)global$84;
	r4 = r3->ALL;
	if( r4 == NULL ) hl_null_access();
	r7 = r4->length;
	r10 = hl_alloc_dynamic(&type$3);
	r10->v.i = r7;
	r9 = r10;
	r3 = (hxsl__$Globals)global$84;
	r4 = r3->ALL;
	if( r4 == NULL ) hl_null_access();
	r7 = hl_types_ArrayObj_push(r4,((vdynamic*)r0));
	r3 = (hxsl__$Globals)global$84;
	r2 = r3->MAP;
	if( r2 == NULL ) hl_null_access();
	haxe_ds_StringMap_set(r2,r0,((vdynamic*)r10));
	label$909$33:
	return r9;
}

