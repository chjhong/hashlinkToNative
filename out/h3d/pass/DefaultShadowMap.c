// Generated by HLC 4.0.0 (HL v4)
#include <hl/code.h>

h3d__pass__Object h3d_pass_DefaultShadowMap_draw(h3d__pass__DefaultShadowMap r0,h3d__pass__Object r1) {
	vvirtual *r6;
	venum *r9, *r10, *r11;
	h3d__mat__$Texture r12;
	h3d__Vector r14;
	h3d__pass__Object r2;
	double r15;
	vdynamic *r16;
	h3d__scene__RenderContext r4;
	h3d__Matrix r13;
	h3d__shader__DirShadow r8;
	h3d__mat__Texture r7;
	int r5;
	r2 = h3d_pass_DirShadowMap_draw(((h3d__pass__DirShadowMap)r0),r1);
	r4 = r0->ctx;
	if( r4 == NULL ) hl_null_access();
	r5 = r0->shadowMapId;
	r6 = hl_alloc_virtual(&type$2344);
	r8 = r0->dshader;
	if( r8 == NULL ) hl_null_access();
	r7 = r8->shadowMap__;
	if( hl_vfields(r6)[1] ) *(h3d__mat__Texture*)(hl_vfields(r6)[1]) = (h3d__mat__Texture)r7; else hl_dyn_setp(r6->value,-18823348/*texture*/,&type$93,r7);
	r10 = r0->format;
	r12 = (h3d__mat__$Texture)global$31;
	r11 = r12->nativeFormat;
	if( r10 != r11 ) goto label$2785$15;
	r9 = (venum*)global$622;
	goto label$2785$16;
	label$2785$15:
	r9 = (venum*)global$658;
	label$2785$16:
	if( hl_vfields(r6)[0] ) *(venum**)(hl_vfields(r6)[0]) = (venum*)r9; else hl_dyn_setp(r6->value,-321781698/*channel*/,&type$573,r9);
	h3d_scene_RenderContext_setGlobalID(r4,r5,((vdynamic*)r6));
	r4 = r0->ctx;
	if( r4 == NULL ) hl_null_access();
	r5 = r0->shadowProjId;
	r13 = h3d_pass_Shadows_getShadowProj(((h3d__pass__Shadows)r0));
	h3d_scene_RenderContext_setGlobalID(r4,r5,((vdynamic*)r13));
	r4 = r0->ctx;
	if( r4 == NULL ) hl_null_access();
	r5 = r0->shadowColorId;
	r14 = r0->color;
	h3d_scene_RenderContext_setGlobalID(r4,r5,((vdynamic*)r14));
	r4 = r0->ctx;
	if( r4 == NULL ) hl_null_access();
	r5 = r0->shadowPowerId;
	r15 = r0->power;
	r16 = hl_alloc_dynamic(&type$6);
	r16->v.d = r15;
	h3d_scene_RenderContext_setGlobalID(r4,r5,r16);
	r4 = r0->ctx;
	if( r4 == NULL ) hl_null_access();
	r5 = r0->shadowBiasId;
	r15 = r0->bias;
	r16 = hl_alloc_dynamic(&type$6);
	r16->v.d = r15;
	h3d_scene_RenderContext_setGlobalID(r4,r5,r16);
	return r1;
}

void h3d_pass_DefaultShadowMap_new(h3d__pass__DefaultShadowMap r0,int* r1,venum* r2) {
	String r14;
	venum *r12;
	h3d__Vector r7;
	h3d__scene__Light r5;
	vdynamic *r13;
	double *r8, *r9, *r10, *r11;
	int r3, r6;
	if( r1 ) goto label$2830$3;
	r3 = 1024;
	goto label$2830$4;
	label$2830$3:
	r3 = *r1;
	label$2830$4:
	if( !r2 ) goto label$2830$6;
	r0->format = r2;
	label$2830$6:
	r5 = NULL;
	h3d_pass_DirShadowMap_new(((h3d__pass__DirShadowMap)r0),r5);
	r6 = h3d_pass_DirShadowMap_set_size(((h3d__pass__DirShadowMap)r0),r3);
	r7 = (h3d__Vector)hl_alloc_obj(h3d__Vector__val);
	r8 = NULL;
	r9 = NULL;
	r10 = NULL;
	r11 = NULL;
	h3d_Vector_new(r7,r8,r9,r10,r11);
	r0->color = r7;
	r12 = (venum*)global$656;
	r12 = h3d_pass_DirShadowMap_set_mode(((h3d__pass__DirShadowMap)r0),r12);
	r14 = (String)global$663;
	r13 = hxsl_Globals_allocID(r14);
	r6 = r13 ? r13->v.i : 0;
	r0->shadowMapId = r6;
	r14 = (String)global$664;
	r13 = hxsl_Globals_allocID(r14);
	r6 = r13 ? r13->v.i : 0;
	r0->shadowProjId = r6;
	r14 = (String)global$665;
	r13 = hxsl_Globals_allocID(r14);
	r6 = r13 ? r13->v.i : 0;
	r0->shadowColorId = r6;
	r14 = (String)global$666;
	r13 = hxsl_Globals_allocID(r14);
	r6 = r13 ? r13->v.i : 0;
	r0->shadowPowerId = r6;
	r14 = (String)global$667;
	r13 = hxsl_Globals_allocID(r14);
	r6 = r13 ? r13->v.i : 0;
	r0->shadowBiasId = r6;
	return;
}

