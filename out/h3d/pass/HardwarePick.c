// Generated by HLC 4.0.0 (HL v4)
#include <hl/code.h>

void h3d_pass_HardwarePick_dispose(h3d__pass__HardwarePick r0) {
	h3d__mat__DepthBuffer r3;
	h3d__mat__Texture r2;
	h3d_pass_Base_dispose(((h3d__pass__Base)r0));
	r2 = r0->texOut;
	if( r2 == NULL ) hl_null_access();
	h3d_mat_Texture_dispose(r2);
	r2 = r0->texOut;
	if( r2 == NULL ) hl_null_access();
	r3 = r2->depthBuffer;
	if( r3 == NULL ) hl_null_access();
	h3d_mat_DepthBuffer_dispose(r3);
	return;
}

hl__types__ArrayObj h3d_pass_HardwarePick_getOutputs(h3d__pass__HardwarePick r0) {
	String r6;
	hl__types__ArrayObj r1;
	venum *r5;
	hl_type *r3;
	vdynamic *r7;
	int r4;
	varray *r2;
	r3 = &type$2397;
	r4 = 1;
	r2 = hl_alloc_array(r3,r4);
	r6 = (String)global$669;
	r7 = NULL;
	r5 = hl_alloc_enum(&type$2397,1);
	((hxsl_Output_Value*)r5)->p0 = r6;
	((hxsl_Output_Value*)r5)->p1 = r7;
	r4 = 0;
	((venum**)(r2 + 1))[r4] = r5;
	r1 = hl_types_ArrayObj_alloc(r2);
	return r1;
}

void h3d_pass_HardwarePick_drawObject(h3d__pass__HardwarePick r0,h3d__pass__Object r1) {
	h3d__pass___HardwarePick__FixedColor r4;
	h3d__Vector r3;
	double r7, r9;
	int r5, r6, r8;
	h3d_pass_Default_drawObject(((h3d__pass__Default)r0),r1);
	r4 = r0->fixedColor;
	if( r4 == NULL ) hl_null_access();
	r3 = r4->colorID__;
	r5 = -16777216;
	r6 = r0->colorID;
	++r6;
	r0->colorID = r6;
	r5 = r5 | r6;
	if( r3 == NULL ) hl_null_access();
	r8 = 16;
	r6 = r5 >> r8;
	r8 = 255;
	r6 = r6 & r8;
	r7 = (double)r6;
	r6 = 255;
	r9 = (double)r6;
	r7 = r7 / r9;
	r3->x = r7;
	r8 = 8;
	r6 = r5 >> r8;
	r8 = 255;
	r6 = r6 & r8;
	r7 = (double)r6;
	r6 = 255;
	r9 = (double)r6;
	r7 = r7 / r9;
	r3->y = r7;
	r8 = 255;
	r6 = r5 & r8;
	r7 = (double)r6;
	r6 = 255;
	r9 = (double)r6;
	r7 = r7 / r9;
	r3->z = r7;
	r8 = 24;
	r6 = ((unsigned)r5) >> r8;
	r7 = (double)r6;
	r6 = 255;
	r9 = (double)r6;
	r7 = r7 / r9;
	r3->w = r7;
	return;
}

void h3d_pass_HardwarePick_nextID(h3d__pass__HardwarePick r0) {
	h3d__pass___HardwarePick__FixedColor r2;
	h3d__Vector r1;
	double r6, r8;
	int r4, r5, r7;
	r2 = r0->fixedColor;
	if( r2 == NULL ) hl_null_access();
	r1 = r2->colorID__;
	r4 = -16777216;
	r5 = r0->colorID;
	++r5;
	r0->colorID = r5;
	r4 = r4 | r5;
	if( r1 == NULL ) hl_null_access();
	r7 = 16;
	r5 = r4 >> r7;
	r7 = 255;
	r5 = r5 & r7;
	r6 = (double)r5;
	r5 = 255;
	r8 = (double)r5;
	r6 = r6 / r8;
	r1->x = r6;
	r7 = 8;
	r5 = r4 >> r7;
	r7 = 255;
	r5 = r5 & r7;
	r6 = (double)r5;
	r5 = 255;
	r8 = (double)r5;
	r6 = r6 / r8;
	r1->y = r6;
	r7 = 255;
	r5 = r4 & r7;
	r6 = (double)r5;
	r5 = 255;
	r8 = (double)r5;
	r6 = r6 / r8;
	r1->z = r6;
	r7 = 24;
	r5 = ((unsigned)r4) >> r7;
	r6 = (double)r5;
	r5 = 255;
	r8 = (double)r5;
	r6 = r6 / r8;
	r1->w = r6;
	return;
}

h3d__pass__Object h3d_pass_HardwarePick_draw(h3d__pass__HardwarePick r0,h3d__pass__Object r1) {
	hxd__Pixels r28;
	venum *r26, *r27;
	h3d__pass___HardwarePick__FixedColor r11;
	h3d__Engine r14;
	h3d__Vector r10;
	h3d__pass__Object r2, r4, r24, r25;
	hxsl__ShaderList r22;
	h3d__mat__Pass r5, r8;
	double r12, r13;
	vdynamic *r19, *r20, *r21;
	int *r17, *r18;
	h3d__scene__RenderContext r15, r23;
	h3d__mat__Texture r16;
	int r6, r7, r9;
	r2 = r1;
	label$1219$1:
	if( !r2 ) goto label$1219$23;
	if( r2 == NULL ) hl_null_access();
	r5 = r2->pass;
	if( r5 == NULL ) hl_null_access();
	r6 = r5->bits;
	r7 = -268435393;
	r6 = r6 & r7;
	r5->bits = r6;
	r5 = r2->pass;
	if( r5 == NULL ) hl_null_access();
	r6 = r5->bits;
	r8 = r0->material;
	if( r8 == NULL ) hl_null_access();
	r7 = r8->bits;
	r9 = 268435392;
	r7 = r7 & r9;
	r6 = r6 | r7;
	r5->bits = r6;
	r4 = r2->next;
	r2 = r4;
	goto label$1219$1;
	label$1219$23:
	r6 = 0;
	r0->colorID = r6;
	r11 = r0->fixedColor;
	if( r11 == NULL ) hl_null_access();
	r10 = r11->colorID__;
	r6 = -16777216;
	r7 = r0->colorID;
	++r7;
	r0->colorID = r7;
	r6 = r6 | r7;
	if( r10 == NULL ) hl_null_access();
	r9 = 16;
	r7 = r6 >> r9;
	r9 = 255;
	r7 = r7 & r9;
	r12 = (double)r7;
	r7 = 255;
	r13 = (double)r7;
	r12 = r12 / r13;
	r10->x = r12;
	r9 = 8;
	r7 = r6 >> r9;
	r9 = 255;
	r7 = r7 & r9;
	r12 = (double)r7;
	r7 = 255;
	r13 = (double)r7;
	r12 = r12 / r13;
	r10->y = r12;
	r9 = 255;
	r7 = r6 & r9;
	r12 = (double)r7;
	r7 = 255;
	r13 = (double)r7;
	r12 = r12 / r13;
	r10->z = r12;
	r9 = 24;
	r7 = ((unsigned)r6) >> r9;
	r12 = (double)r7;
	r7 = 255;
	r13 = (double)r7;
	r12 = r12 / r13;
	r10->w = r12;
	r11 = r0->fixedColor;
	if( r11 == NULL ) hl_null_access();
	r10 = r11->viewport__;
	if( r10 == NULL ) hl_null_access();
	r12 = r0->pickX;
	r6 = 2;
	r13 = (double)r6;
	r12 = r12 * r13;
	r15 = r0->ctx;
	if( r15 == NULL ) hl_null_access();
	r14 = r15->engine;
	if( r14 == NULL ) hl_null_access();
	r6 = r14->width;
	r13 = (double)r6;
	r12 = r12 / r13;
	r6 = 1;
	r13 = (double)r6;
	r12 = r12 - r13;
	r12 = -r12;
	r10->x = r12;
	r12 = r0->pickY;
	r6 = 2;
	r13 = (double)r6;
	r12 = r12 * r13;
	r15 = r0->ctx;
	if( r15 == NULL ) hl_null_access();
	r14 = r15->engine;
	if( r14 == NULL ) hl_null_access();
	r6 = r14->height;
	r13 = (double)r6;
	r12 = r12 / r13;
	r6 = 1;
	r13 = (double)r6;
	r12 = r12 - r13;
	r10->y = r12;
	r15 = r0->ctx;
	if( r15 == NULL ) hl_null_access();
	r14 = r15->engine;
	if( r14 == NULL ) hl_null_access();
	r6 = r14->width;
	r12 = (double)r6;
	r16 = r0->texOut;
	if( r16 == NULL ) hl_null_access();
	r6 = r16->width;
	r13 = (double)r6;
	r12 = r12 / r13;
	r10->z = r12;
	r15 = r0->ctx;
	if( r15 == NULL ) hl_null_access();
	r14 = r15->engine;
	if( r14 == NULL ) hl_null_access();
	r6 = r14->height;
	r12 = (double)r6;
	r16 = r0->texOut;
	if( r16 == NULL ) hl_null_access();
	r6 = r16->height;
	r13 = (double)r6;
	r12 = r12 / r13;
	r10->w = r12;
	r15 = r0->ctx;
	if( r15 == NULL ) hl_null_access();
	r14 = r15->engine;
	if( r14 == NULL ) hl_null_access();
	r16 = r0->texOut;
	r17 = NULL;
	r18 = NULL;
	h3d_Engine_pushTarget(r14,r16,r17,r18);
	r15 = r0->ctx;
	if( r15 == NULL ) hl_null_access();
	r14 = r15->engine;
	if( r14 == NULL ) hl_null_access();
	r6 = -16777216;
	r19 = hl_alloc_dynamic(&type$3);
	r19->v.i = r6;
	r6 = 1;
	r12 = (double)r6;
	r20 = hl_alloc_dynamic(&type$6);
	r20->v.d = r12;
	r21 = NULL;
	h3d_Engine_clear(r14,r19,r20,r21);
	r15 = r0->ctx;
	if( r15 == NULL ) hl_null_access();
	r23 = r0->ctx;
	if( r23 == NULL ) hl_null_access();
	r11 = r0->fixedColor;
	r22 = NULL;
	r22 = h3d_scene_RenderContext_allocShaderList(r23,((hxsl__Shader)r11),r22);
	r15->extraShaders = r22;
	r4 = h3d_pass_Default_draw(((h3d__pass__Default)r0),r1);
	r15 = r0->ctx;
	if( r15 == NULL ) hl_null_access();
	r22 = NULL;
	r15->extraShaders = r22;
	r15 = r0->ctx;
	if( r15 == NULL ) hl_null_access();
	r14 = r15->engine;
	if( r14 == NULL ) hl_null_access();
	h3d_Engine_popTarget(r14);
	r24 = r4;
	label$1219$163:
	if( !r24 ) goto label$1219$211;
	if( r24 == NULL ) hl_null_access();
	r5 = r24->pass;
	if( r5 == NULL ) hl_null_access();
	r8 = r24->pass;
	if( r8 == NULL ) hl_null_access();
	r26 = r8->blendSrc;
	r26 = h3d_mat_Pass_set_blendSrc(r5,r26);
	r5 = r24->pass;
	if( r5 == NULL ) hl_null_access();
	r8 = r24->pass;
	if( r8 == NULL ) hl_null_access();
	r26 = r8->blendDst;
	r26 = h3d_mat_Pass_set_blendDst(r5,r26);
	r5 = r24->pass;
	if( r5 == NULL ) hl_null_access();
	r8 = r24->pass;
	if( r8 == NULL ) hl_null_access();
	r27 = r8->blendOp;
	r27 = h3d_mat_Pass_set_blendOp(r5,r27);
	r5 = r24->pass;
	if( r5 == NULL ) hl_null_access();
	r8 = r24->pass;
	if( r8 == NULL ) hl_null_access();
	r26 = r8->blendAlphaSrc;
	r26 = h3d_mat_Pass_set_blendAlphaSrc(r5,r26);
	r5 = r24->pass;
	if( r5 == NULL ) hl_null_access();
	r8 = r24->pass;
	if( r8 == NULL ) hl_null_access();
	r26 = r8->blendAlphaDst;
	r26 = h3d_mat_Pass_set_blendAlphaDst(r5,r26);
	r5 = r24->pass;
	if( r5 == NULL ) hl_null_access();
	r8 = r24->pass;
	if( r8 == NULL ) hl_null_access();
	r27 = r8->blendAlphaOp;
	r27 = h3d_mat_Pass_set_blendAlphaOp(r5,r27);
	r5 = r24->pass;
	if( r5 == NULL ) hl_null_access();
	r8 = r24->pass;
	if( r8 == NULL ) hl_null_access();
	r6 = r8->colorMask;
	r5->colorMask = r6;
	r25 = r24->next;
	r24 = r25;
	goto label$1219$163;
	label$1219$211:
	r15 = r0->ctx;
	if( r15 == NULL ) hl_null_access();
	r14 = r15->engine;
	if( r14 == NULL ) hl_null_access();
	r19 = NULL;
	r20 = NULL;
	r6 = 0;
	r21 = hl_alloc_dynamic(&type$3);
	r21->v.i = r6;
	h3d_Engine_clear(r14,r19,r20,r21);
	r16 = r0->texOut;
	if( r16 == NULL ) hl_null_access();
	r17 = NULL;
	r18 = NULL;
	r28 = h3d_mat_Texture_capturePixels(r16,r17,r18);
	if( r28 == NULL ) hl_null_access();
	r6 = r28->width;
	r7 = 1;
	r6 = r6 >> r7;
	r7 = r28->height;
	r9 = 1;
	r7 = r7 >> r9;
	r6 = hxd_Pixels_getPixel(r28,r6,r7);
	r7 = 16777215;
	r6 = r6 & r7;
	r7 = 1;
	r6 = r6 - r7;
	r0->pickedIndex = r6;
	return r4;
}

void h3d_pass_HardwarePick_new(h3d__pass__HardwarePick r0) {
	String r4;
	h3d__mat__DepthBuffer r20;
	vvirtual *r19;
	hl__types__ArrayObj r13;
	hl_type *r15;
	venum *r8, *r9, *r10, *r17, *r18, *r21;
	h3d__pass___HardwarePick__FixedColor r2;
	hxsl__ShaderList r6;
	h3d__mat__Pass r5, r7;
	varray *r14;
	h3d__mat__Texture r11;
	int r1, r12, r16;
	r1 = -1;
	r0->pickedIndex = r1;
	r2 = (h3d__pass___HardwarePick__FixedColor)hl_alloc_obj(h3d__pass___HardwarePick__FixedColor__val);
	h3d_pass__HardwarePick_FixedColor_new(r2);
	r0->fixedColor = r2;
	r4 = (String)global$668;
	h3d_pass_Default_new(((h3d__pass__Default)r0),r4);
	r5 = (h3d__mat__Pass)hl_alloc_obj(h3d__mat__Pass__val);
	r4 = (String)global$8;
	r6 = NULL;
	r7 = NULL;
	h3d_mat_Pass_new(r5,r4,r6,r7);
	r0->material = r5;
	r5 = r0->material;
	r8 = (venum*)global$586;
	r9 = (venum*)global$587;
	if( r5 == NULL ) hl_null_access();
	r10 = h3d_mat_Pass_set_blendSrc(r5,r8);
	r10 = h3d_mat_Pass_set_blendAlphaSrc(r5,r8);
	r10 = h3d_mat_Pass_set_blendDst(r5,r9);
	r10 = h3d_mat_Pass_set_blendAlphaDst(r5,r9);
	r11 = (h3d__mat__Texture)hl_alloc_obj(h3d__mat__Texture__val);
	r1 = 3;
	r12 = 3;
	r15 = &type$497;
	r16 = 1;
	r14 = hl_alloc_array(r15,r16);
	r17 = (venum*)global$432;
	r16 = 0;
	((venum**)(r14 + 1))[r16] = r17;
	r13 = hl_types_ArrayObj_alloc(r14);
	r18 = NULL;
	r19 = NULL;
	h3d_mat_Texture_new(r11,r1,r12,r13,r18,r19);
	r0->texOut = r11;
	r11 = r0->texOut;
	if( r11 == NULL ) hl_null_access();
	r20 = (h3d__mat__DepthBuffer)hl_alloc_obj(h3d__mat__DepthBuffer__val);
	r1 = 3;
	r12 = 3;
	r21 = NULL;
	h3d_mat_DepthBuffer_new(r20,r1,r12,r21);
	r11->depthBuffer = r20;
	return;
}

