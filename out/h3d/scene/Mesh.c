// Generated by HLC 4.0.0 (HL v4)
#include <hl/code.h>

hl__types__ArrayObj h3d_scene_Mesh_getMeshMaterials(h3d__scene__Mesh r0) {
	hl__types__ArrayObj r1;
	hl_type *r3;
	h3d__mat__Material r5;
	int r4;
	varray *r2;
	r3 = &type$298;
	r4 = 1;
	r2 = hl_alloc_array(r3,r4);
	r5 = r0->material;
	r4 = 0;
	((h3d__mat__Material*)(r2 + 1))[r4] = r5;
	r1 = hl_types_ArrayObj_alloc(r2);
	return r1;
}

h3d__col__Bounds h3d_scene_Mesh_getBoundsRec(h3d__scene__Mesh r0,h3d__col__Bounds r1) {
	h3d__prim__Primitive r4;
	h3d__col__Bounds r2, r7;
	double r8, r10;
	h3d__Matrix r9;
	int r5, r6;
	r2 = h3d_scene_Object_getBoundsRec(((h3d__scene__Object)r0),r1);
	r1 = r2;
	r4 = r0->primitive;
	if( !r4 ) goto label$1540$9;
	r5 = r0->flags;
	r6 = 512;
	r5 = r5 & r6;
	r6 = 0;
	if( r5 == r6 ) goto label$1540$10;
	label$1540$9:
	return r2;
	label$1540$10:
	r4 = r0->primitive;
	if( r4 == NULL ) hl_null_access();
	r2 = ((h3d__col__Bounds (*)(h3d__prim__Primitive))r4->$type->vobj_proto[3])(r4);
	r7 = (h3d__col__Bounds)hl_alloc_obj(h3d__col__Bounds__val);
	h3d_col_Bounds_new(r7);
	if( r2 == NULL ) hl_null_access();
	r8 = r2->xMin;
	r7->xMin = r8;
	r8 = r2->xMax;
	r7->xMax = r8;
	r8 = r2->yMin;
	r7->yMin = r8;
	r8 = r2->yMax;
	r7->yMax = r8;
	r8 = r2->zMin;
	r7->zMin = r8;
	r8 = r2->zMax;
	r7->zMax = r8;
	r9 = r0->absPos;
	h3d_col_Bounds_transform(r7,r9);
	r8 = r7->xMin;
	if( r1 == NULL ) hl_null_access();
	r10 = r1->xMin;
	if( !(r8 < r10) ) goto label$1540$36;
	r8 = r7->xMin;
	r1->xMin = r8;
	label$1540$36:
	r8 = r7->xMax;
	r10 = r1->xMax;
	if( !(r10 < r8) ) goto label$1540$41;
	r8 = r7->xMax;
	r1->xMax = r8;
	label$1540$41:
	r8 = r7->yMin;
	r10 = r1->yMin;
	if( !(r8 < r10) ) goto label$1540$46;
	r8 = r7->yMin;
	r1->yMin = r8;
	label$1540$46:
	r8 = r7->yMax;
	r10 = r1->yMax;
	if( !(r10 < r8) ) goto label$1540$51;
	r8 = r7->yMax;
	r1->yMax = r8;
	label$1540$51:
	r8 = r7->zMin;
	r10 = r1->zMin;
	if( !(r8 < r10) ) goto label$1540$56;
	r8 = r7->zMin;
	r1->zMin = r8;
	label$1540$56:
	r8 = r7->zMax;
	r10 = r1->zMax;
	if( !(r10 < r8) ) goto label$1540$61;
	r8 = r7->zMax;
	r1->zMax = r8;
	label$1540$61:
	return r1;
}

h3d__scene__Object h3d_scene_Mesh_clone(h3d__scene__Mesh r0,h3d__scene__Object r1) {
	h3d__prim__Primitive r4;
	h3d__mat__Material r5;
	h3d__scene__Mesh r2;
	h3d__mat__BaseMaterial r7;
	h3d__scene__Object r3;
	if( r1 ) goto label$1541$7;
	r2 = (h3d__scene__Mesh)hl_alloc_obj(h3d__scene__Mesh__val);
	r4 = NULL;
	r5 = r0->material;
	r3 = NULL;
	h3d_scene_Mesh_new(r2,r4,r5,r3);
	goto label$1541$8;
	label$1541$7:
	r2 = (h3d__scene__Mesh)hl_dyn_castp(&r1,&type$1302,&type$1849);
	label$1541$8:
	if( r2 == NULL ) hl_null_access();
	r4 = r0->primitive;
	r2->primitive = r4;
	r5 = r0->material;
	if( r5 == NULL ) hl_null_access();
	r7 = NULL;
	r7 = h3d_mat_Material_clone(r5,r7);
	r5 = (h3d__mat__Material)hl_dyn_castp(&r7,&type$290,&type$298);
	r2->material = r5;
	r3 = h3d_scene_Object_clone(((h3d__scene__Object)r0),((h3d__scene__Object)r2));
	return ((h3d__scene__Object)r2);
}

vvirtual* h3d_scene_Mesh_getLocalCollider(h3d__scene__Mesh r0) {
	h3d__prim__Primitive r2;
	vvirtual *r1;
	r2 = r0->primitive;
	if( r2 == NULL ) hl_null_access();
	r1 = ((vvirtual* (*)(h3d__prim__Primitive))r2->$type->vobj_proto[2])(r2);
	return r1;
}

void h3d_scene_Mesh_draw(h3d__scene__Mesh r0,h3d__scene__RenderContext r1) {
	h3d__prim__Primitive r3;
	h3d__Engine r4;
	r3 = r0->primitive;
	if( r3 == NULL ) hl_null_access();
	if( r1 == NULL ) hl_null_access();
	r4 = r1->engine;
	((void (*)(h3d__prim__Primitive,h3d__Engine))r3->$type->vobj_proto[6])(r3,r4);
	return;
}

void h3d_scene_Mesh_emit(h3d__scene__Mesh r0,h3d__scene__RenderContext r1) {
	h3d__mat__Material r3;
	h3d__pass__Object r6;
	h3d__mat__Pass r2, r5;
	int r7;
	r3 = r0->material;
	if( r3 == NULL ) hl_null_access();
	r2 = r3->passes;
	label$1544$3:
	if( !r2 ) goto label$1544$14;
	if( r1 == NULL ) hl_null_access();
	r6 = h3d_scene_RenderContext_emitPass(r1,r2,((h3d__scene__Object)r0));
	if( r6 == NULL ) hl_null_access();
	r7 = 0;
	r6->index = r7;
	if( r2 == NULL ) hl_null_access();
	r5 = r2->nextPass;
	r2 = r5;
	goto label$1544$3;
	label$1544$14:
	return;
}

h3d__mat__Material h3d_scene_Mesh_getMaterialByName(h3d__scene__Mesh r0,String r1) {
	String r3;
	h3d__mat__Material r2;
	r2 = r0->material;
	if( !r2 ) goto label$1545$8;
	r2 = r0->material;
	if( r2 == NULL ) hl_null_access();
	r3 = r2->name;
	if( r3 != r1 && (!r3 || !r1 || String___compare(r3,(vdynamic*)r1) != 0) ) goto label$1545$8;
	r2 = r0->material;
	return r2;
	label$1545$8:
	r2 = h3d_scene_Object_getMaterialByName(((h3d__scene__Object)r0),r1);
	return r2;
}

hl__types__ArrayObj h3d_scene_Mesh_getMaterials(h3d__scene__Mesh r0,hl__types__ArrayObj r1) {
	hl__types__ArrayObj r2;
	hl_type *r4;
	h3d__mat__Material r6;
	vdynamic *r7;
	int r5, r8;
	varray *r3;
	if( r1 ) goto label$1546$6;
	r4 = &type$298;
	r5 = 0;
	r3 = hl_alloc_array(r4,r5);
	r2 = hl_types_ArrayObj_alloc(r3);
	r1 = r2;
	label$1546$6:
	r6 = r0->material;
	if( !r6 ) goto label$1546$16;
	if( r1 == NULL ) hl_null_access();
	r6 = r0->material;
	r7 = NULL;
	r5 = hl_types_ArrayObj_indexOf(r1,((vdynamic*)r6),r7);
	r8 = 0;
	if( r5 >= r8 ) goto label$1546$16;
	r6 = r0->material;
	r5 = hl_types_ArrayObj_push(r1,((vdynamic*)r6));
	label$1546$16:
	r2 = h3d_scene_Object_getMaterials(((h3d__scene__Object)r0),r1);
	return r2;
}

void h3d_scene_Mesh_dispose(h3d__scene__Mesh r0) {
	h3d__prim__Primitive r2;
	r2 = r0->primitive;
	if( !r2 ) goto label$1547$5;
	r2 = r0->primitive;
	if( r2 == NULL ) hl_null_access();
	((void (*)(h3d__prim__Primitive))r2->$type->vobj_proto[7])(r2);
	label$1547$5:
	h3d_scene_Object_dispose(((h3d__scene__Object)r0));
	return;
}

void h3d_scene_Mesh_new(h3d__scene__Mesh r0,h3d__prim__Primitive r1,h3d__mat__Material r2,h3d__scene__Object r3) {
	String r9;
	h3d__mat__Material r5;
	h3d__mat__$MaterialSetup r7;
	h3d__mat__MaterialSetup r6;
	vdynamic *r8;
	h3d_scene_Object_new(((h3d__scene__Object)r0),r3);
	r0->primitive = r1;
	if( r2 ) goto label$1548$12;
	r7 = (h3d__mat__$MaterialSetup)global$558;
	r6 = r7->current;
	if( r6 == NULL ) hl_null_access();
	r5 = h3d_mat_MaterialSetup_createMaterial(r6);
	r2 = r5;
	if( r5 == NULL ) hl_null_access();
	r9 = NULL;
	r8 = h3d_mat_Material_getDefaultProps(r5,r9);
	r8 = hxd_impl_AnyProps_set_props(((hxd__impl__AnyProps)r5),r8);
	label$1548$12:
	r0->material = r2;
	return;
}

