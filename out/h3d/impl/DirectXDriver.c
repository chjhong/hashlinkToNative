// Generated by HLC 4.0.0 (HL v4)
#include <hl/code.h>

void h3d_impl_DirectXDriver_reset(h3d__impl__DirectXDriver r0) {
	String r26, r27;
	h3d__mat__DepthBuffer r30;
	hl__types__ArrayObj r14;
	vvirtual *r12, *r17;
	dx_pointer *r10;
	dx_driver *r22;
	venum *r21, *r32;
	bool r1;
	h3d__impl__PipelineState r20;
	haxe__ds__IntMap r4;
	h3d__impl___DirectXDriver__CompiledShader r8;
	dx__Window r23;
	h3d__impl___DirectXDriver__ShaderContext r11;
	float r36;
	double r28, r29;
	vclosure *r6, *r9, *r13, *r19;
	int *r24, *r25;
	vdynamic *r5, *r7;
	vbyte *r34;
	varray *r18;
	int r2, r15, r16, r31, r33, r35;
	hl_trap_ctx trap$0;
	r1 = false;
	r0->allowDraw = r1;
	r2 = 1;
	r0->targetsCount = r2;
	r2 = -1;
	r0->currentMaterialBits = r2;
	r2 = -1;
	r0->currentStencilMaskBits = r2;
	r2 = -1;
	r0->currentStencilOpBits = r2;
	r4 = r0->shaders;
	if( !r4 ) goto label$2487$36;
	r4 = r0->shaders;
	if( r4 == NULL ) hl_null_access();
	r5 = haxe_ds_IntMap_iterator(r4);
	label$2487$15:
	if( r5 == NULL ) hl_null_access();
	r6 = (vclosure*)hl_dyn_getp((vdynamic*)r5,407283053/*hasNext*/,&type$118);
	if( r6 == NULL ) hl_null_access();
	r1 = r6->hasValue ? ((bool (*)(vdynamic*))r6->fun)((vdynamic*)r6->value) : ((bool (*)(void))r6->fun)();
	if( !r1 ) goto label$2487$36;
	r9 = (vclosure*)hl_dyn_getp((vdynamic*)r5,151160317/*next*/,&type$2100);
	if( r9 == NULL ) hl_null_access();
	r8 = r9->hasValue ? ((h3d__impl___DirectXDriver__CompiledShader (*)(vdynamic*))r9->fun)((vdynamic*)r9->value) : ((h3d__impl___DirectXDriver__CompiledShader (*)(void))r9->fun)();
	if( r8 == NULL ) hl_null_access();
	r11 = r8->fragment;
	if( r11 == NULL ) hl_null_access();
	r10 = r11->shader;
	directx_release_pointer(r10);
	r11 = r8->vertex;
	if( r11 == NULL ) hl_null_access();
	r10 = r11->shader;
	directx_release_pointer(r10);
	r10 = r8->layout;
	directx_release_pointer(r10);
	goto label$2487$15;
	label$2487$36:
	r4 = r0->depthStates;
	if( !r4 ) goto label$2487$76;
	r4 = r0->depthStates;
	if( r4 == NULL ) hl_null_access();
	r5 = haxe_ds_IntMap_iterator(r4);
	label$2487$41:
	if( r5 == NULL ) hl_null_access();
	r6 = (vclosure*)hl_dyn_getp((vdynamic*)r5,407283053/*hasNext*/,&type$118);
	if( r6 == NULL ) hl_null_access();
	r1 = r6->hasValue ? ((bool (*)(vdynamic*))r6->fun)((vdynamic*)r6->value) : ((bool (*)(void))r6->fun)();
	if( !r1 ) goto label$2487$76;
	r13 = (vclosure*)hl_dyn_getp((vdynamic*)r5,151160317/*next*/,&type$2102);
	if( r13 == NULL ) hl_null_access();
	r12 = r13->hasValue ? ((vvirtual* (*)(vdynamic*))r13->fun)((vdynamic*)r13->value) : ((vvirtual* (*)(void))r13->fun)();
	if( r12 == NULL ) hl_null_access();
	r10 = hl_vfields(r12)[0] ? (*(dx_pointer**)(hl_vfields(r12)[0])) : (dx_pointer*)hl_dyn_getp(r12->value,4995525/*def*/,&type$53);
	if( !r10 ) goto label$2487$55;
	r10 = hl_vfields(r12)[0] ? (*(dx_pointer**)(hl_vfields(r12)[0])) : (dx_pointer*)hl_dyn_getp(r12->value,4995525/*def*/,&type$53);
	directx_release_pointer(r10);
	label$2487$55:
	r2 = 0;
	r14 = hl_vfields(r12)[1] ? (*(hl__types__ArrayObj*)(hl_vfields(r12)[1])) : (hl__types__ArrayObj)hl_dyn_getp(r12->value,-482181784/*stencils*/,&type$46);
	label$2487$57:
	if( r14 == NULL ) hl_null_access();
	r16 = r14->length;
	if( r2 >= r16 ) goto label$2487$75;
	r16 = r14->length;
	if( ((unsigned)r2) < ((unsigned)r16) ) goto label$2487$65;
	r17 = NULL;
	goto label$2487$68;
	label$2487$65:
	r18 = r14->array;
	r7 = ((vdynamic**)(r18 + 1))[r2];
	r17 = hl_to_virtual(&type$2103,(vdynamic*)r7);
	label$2487$68:
	++r2;
	if( r17 == NULL ) hl_null_access();
	r10 = hl_vfields(r17)[2] ? (*(dx_pointer**)(hl_vfields(r17)[2])) : (dx_pointer*)hl_dyn_getp(r17->value,-469011326/*state*/,&type$53);
	if( !r10 ) goto label$2487$74;
	r10 = hl_vfields(r17)[2] ? (*(dx_pointer**)(hl_vfields(r17)[2])) : (dx_pointer*)hl_dyn_getp(r17->value,-469011326/*state*/,&type$53);
	directx_release_pointer(r10);
	label$2487$74:
	goto label$2487$57;
	label$2487$75:
	goto label$2487$41;
	label$2487$76:
	r4 = r0->blendStates;
	if( !r4 ) goto label$2487$93;
	r4 = r0->blendStates;
	if( r4 == NULL ) hl_null_access();
	r5 = haxe_ds_IntMap_iterator(r4);
	label$2487$81:
	if( r5 == NULL ) hl_null_access();
	r6 = (vclosure*)hl_dyn_getp((vdynamic*)r5,407283053/*hasNext*/,&type$118);
	if( r6 == NULL ) hl_null_access();
	r1 = r6->hasValue ? ((bool (*)(vdynamic*))r6->fun)((vdynamic*)r6->value) : ((bool (*)(void))r6->fun)();
	if( !r1 ) goto label$2487$93;
	r19 = (vclosure*)hl_dyn_getp((vdynamic*)r5,151160317/*next*/,&type$2104);
	if( r19 == NULL ) hl_null_access();
	r10 = r19->hasValue ? ((dx_pointer* (*)(vdynamic*))r19->fun)((vdynamic*)r19->value) : ((dx_pointer* (*)(void))r19->fun)();
	if( !r10 ) goto label$2487$92;
	directx_release_pointer(r10);
	label$2487$92:
	goto label$2487$81;
	label$2487$93:
	r4 = r0->rasterStates;
	if( !r4 ) goto label$2487$110;
	r4 = r0->rasterStates;
	if( r4 == NULL ) hl_null_access();
	r5 = haxe_ds_IntMap_iterator(r4);
	label$2487$98:
	if( r5 == NULL ) hl_null_access();
	r6 = (vclosure*)hl_dyn_getp((vdynamic*)r5,407283053/*hasNext*/,&type$118);
	if( r6 == NULL ) hl_null_access();
	r1 = r6->hasValue ? ((bool (*)(vdynamic*))r6->fun)((vdynamic*)r6->value) : ((bool (*)(void))r6->fun)();
	if( !r1 ) goto label$2487$110;
	r19 = (vclosure*)hl_dyn_getp((vdynamic*)r5,151160317/*next*/,&type$2104);
	if( r19 == NULL ) hl_null_access();
	r10 = r19->hasValue ? ((dx_pointer* (*)(vdynamic*))r19->fun)((vdynamic*)r19->value) : ((dx_pointer* (*)(void))r19->fun)();
	if( !r10 ) goto label$2487$109;
	directx_release_pointer(r10);
	label$2487$109:
	goto label$2487$98;
	label$2487$110:
	r4 = r0->samplerStates;
	if( !r4 ) goto label$2487$127;
	r4 = r0->samplerStates;
	if( r4 == NULL ) hl_null_access();
	r5 = haxe_ds_IntMap_iterator(r4);
	label$2487$115:
	if( r5 == NULL ) hl_null_access();
	r6 = (vclosure*)hl_dyn_getp((vdynamic*)r5,407283053/*hasNext*/,&type$118);
	if( r6 == NULL ) hl_null_access();
	r1 = r6->hasValue ? ((bool (*)(vdynamic*))r6->fun)((vdynamic*)r6->value) : ((bool (*)(void))r6->fun)();
	if( !r1 ) goto label$2487$127;
	r19 = (vclosure*)hl_dyn_getp((vdynamic*)r5,151160317/*next*/,&type$2104);
	if( r19 == NULL ) hl_null_access();
	r10 = r19->hasValue ? ((dx_pointer* (*)(vdynamic*))r19->fun)((vdynamic*)r19->value) : ((dx_pointer* (*)(void))r19->fun)();
	if( !r10 ) goto label$2487$126;
	directx_release_pointer(r10);
	label$2487$126:
	goto label$2487$115;
	label$2487$127:
	r4 = (haxe__ds__IntMap)hl_alloc_obj(haxe__ds__IntMap__val);
	haxe_ds_IntMap_new(r4);
	r0->shaders = r4;
	r4 = (haxe__ds__IntMap)hl_alloc_obj(haxe__ds__IntMap__val);
	haxe_ds_IntMap_new(r4);
	r0->depthStates = r4;
	r4 = (haxe__ds__IntMap)hl_alloc_obj(haxe__ds__IntMap__val);
	haxe_ds_IntMap_new(r4);
	r0->blendStates = r4;
	r4 = (haxe__ds__IntMap)hl_alloc_obj(haxe__ds__IntMap__val);
	haxe_ds_IntMap_new(r4);
	r0->rasterStates = r4;
	r4 = (haxe__ds__IntMap)hl_alloc_obj(haxe__ds__IntMap__val);
	haxe_ds_IntMap_new(r4);
	r0->samplerStates = r4;
	r20 = (h3d__impl__PipelineState)hl_alloc_obj(h3d__impl__PipelineState__val);
	r21 = (venum*)global$501;
	h3d_impl_PipelineState_new(r20,r21);
	r0->vertexShader = r20;
	r20 = (h3d__impl__PipelineState)hl_alloc_obj(h3d__impl__PipelineState__val);
	r21 = (venum*)global$502;
	h3d_impl_PipelineState_new(r20,r21);
	r0->pixelShader = r20;
	r2 = 0;
	hl_trap(trap$0,r5,label$2487$161);
	r23 = r0->window;
	r15 = r0->backBufferFormat;
	r16 = r2;
	r24 = &r16;
	r25 = NULL;
	r22 = dx_Driver_create(r23,r15,r24,r25);
	r0->driver = r22;
	hl_endtrap(trap$0);
	goto label$2487$167;
	label$2487$161:
	r26 = (String)global$503;
	r27 = Std_string(r5);
	r26 = String___add__(r26,r27);
	r27 = (String)global$177;
	r26 = String___add__(r26,r27);
	hl_throw((vdynamic*)r26);
	label$2487$167:
	r22 = r0->driver;
	if( r22 ) goto label$2487$171;
	r26 = (String)global$504;
	hl_throw((vdynamic*)r26);
	label$2487$171:
	r28 = directx_get_supported_version();
	r15 = 10;
	r29 = (double)r15;
	if( !(r28 < r29) ) goto label$2487$177;
	r26 = (String)global$505;
	goto label$2487$183;
	label$2487$177:
	r15 = 11;
	r29 = (double)r15;
	if( !(r28 < r29) ) goto label$2487$182;
	r26 = (String)global$506;
	goto label$2487$183;
	label$2487$182:
	r26 = (String)global$507;
	label$2487$183:
	r0->shaderVersion = r26;
	r15 = 4;
	directx_ia_set_primitive_topology(r15);
	r30 = (h3d__mat__DepthBuffer)hl_alloc_obj(h3d__mat__DepthBuffer__val);
	r15 = -1;
	r31 = -1;
	r32 = NULL;
	h3d_mat_DepthBuffer_new(r30,r15,r31,r32);
	r0->defaultDepthInst = r30;
	r15 = 0;
	label$2487$193:
	r33 = 48;
	if( r15 >= r33 ) goto label$2487$205;
	r31 = r15;
	++r15;
	r34 = r0->viewport;
	r35 = 0;
	r36 = (float)r35;
	r35 = 2;
	r35 = r31 << r35;
	*(float*)(r34 + r35) = r36;
	goto label$2487$193;
	label$2487$205:
	r34 = r0->rects;
	r15 = 0;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 1;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 2;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 3;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 4;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 5;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 6;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 7;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 8;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 9;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 10;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 11;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 12;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 13;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 14;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 15;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 16;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 17;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 18;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 19;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 20;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 21;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 22;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 23;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 24;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 25;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 26;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 27;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 28;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 29;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 30;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->rects;
	r15 = 31;
	r31 = 0;
	r33 = 2;
	r33 = r15 << r33;
	*(int*)(r34 + r33) = r31;
	r34 = r0->blendFactors;
	r15 = 0;
	r31 = 0;
	r36 = (float)r31;
	r31 = 2;
	r31 = r15 << r31;
	*(float*)(r34 + r31) = r36;
	r34 = r0->blendFactors;
	r15 = 1;
	r31 = 0;
	r36 = (float)r31;
	r31 = 2;
	r31 = r15 << r31;
	*(float*)(r34 + r31) = r36;
	r34 = r0->blendFactors;
	r15 = 2;
	r31 = 0;
	r36 = (float)r31;
	r31 = 2;
	r31 = r15 << r31;
	*(float*)(r34 + r31) = r36;
	r34 = r0->blendFactors;
	r15 = 3;
	r31 = 0;
	r36 = (float)r31;
	r31 = 2;
	r31 = r15 << r31;
	*(float*)(r34 + r31) = r36;
	r34 = r0->blendFactors;
	r15 = 4;
	r31 = 0;
	r36 = (float)r31;
	r31 = 2;
	r31 = r15 << r31;
	*(float*)(r34 + r31) = r36;
	r34 = r0->blendFactors;
	r15 = 5;
	r31 = 0;
	r36 = (float)r31;
	r31 = 2;
	r31 = r15 << r31;
	*(float*)(r34 + r31) = r36;
	r34 = r0->blendFactors;
	r15 = 6;
	r31 = 0;
	r36 = (float)r31;
	r31 = 2;
	r31 = r15 << r31;
	*(float*)(r34 + r31) = r36;
	r34 = r0->blendFactors;
	r15 = 7;
	r31 = 0;
	r36 = (float)r31;
	r31 = 2;
	r31 = r15 << r31;
	*(float*)(r34 + r31) = r36;
	return;
}

void h3d_impl_DirectXDriver_dispose(h3d__impl__DirectXDriver r0) {
	dx_driver *r2;
	r2 = r0->driver;
	directx_dispose_driver(r2);
	r2 = NULL;
	r0->driver = r2;
	return;
}

void h3d_impl_DirectXDriver_onDXError(h3d__impl__DirectXDriver r0,int r1,int r2,int r3) {
	String r7, r8;
	bool r12;
	int *r10;
	vdynamic *r9;
	vbyte *r11;
	int r5, r6;
	r6 = -2005270523;
	if( r1 == r6 ) goto label$2489$14;
	r7 = (String)global$508;
	r9 = NULL;
	r8 = StringTools_hex(r1,r9);
	r7 = String___add__(r7,r8);
	r8 = (String)global$509;
	r7 = String___add__(r7,r8);
	r5 = r3;
	r10 = &r5;
	r11 = hl_itos(r5,r10);
	r8 = String___alloc__(r11,r5);
	r7 = String___add__(r7,r8);
	hl_throw((vdynamic*)r7);
	label$2489$14:
	r12 = true;
	r0->hasDeviceError = r12;
	return;
}

void h3d_impl_DirectXDriver_resize(h3d__impl__DirectXDriver r0,int r1,int r2) {
	String r10, r13;
	h3d__mat__DepthBuffer r16, r24;
	dx_pointer *r5;
	vvirtual *r4;
	bool r7;
	dx_resource *r6, *r15;
	dx__Texture2dDesc r14;
	double r18, r19, r20, r21;
	dx__RenderTargetDesc r17;
	int *r11, *r23;
	h3d__mat__Texture r22;
	vbyte *r12;
	int r8, r9;
	r4 = r0->defaultDepth;
	if( !r4 ) goto label$2490$10;
	r4 = r0->defaultDepth;
	if( r4 == NULL ) hl_null_access();
	r5 = hl_vfields(r4)[1] ? (*(dx_pointer**)(hl_vfields(r4)[1])) : (dx_pointer*)hl_dyn_getp(r4->value,240071535/*view*/,&type$53);
	directx_release_pointer(r5);
	r4 = r0->defaultDepth;
	if( r4 == NULL ) hl_null_access();
	r6 = hl_vfields(r4)[0] ? (*(dx_resource**)(hl_vfields(r4)[0])) : (dx_resource*)hl_dyn_getp(r4->value,5691744/*res*/,&type$52);
	directx_release_resource(r6);
	label$2490$10:
	r5 = r0->defaultTarget;
	if( !r5 ) goto label$2490$16;
	r5 = r0->defaultTarget;
	directx_release_pointer(r5);
	r5 = NULL;
	r0->defaultTarget = r5;
	label$2490$16:
	r9 = r0->backBufferFormat;
	r7 = directx_resize(r1,r2,r9);
	if( r7 ) goto label$2490$33;
	r10 = (String)global$510;
	r8 = r1;
	r11 = &r8;
	r12 = hl_itos(r8,r11);
	r13 = String___alloc__(r12,r8);
	r10 = String___add__(r10,r13);
	r13 = (String)global$439;
	r10 = String___add__(r10,r13);
	r8 = r2;
	r11 = &r8;
	r12 = hl_itos(r8,r11);
	r13 = String___alloc__(r12,r8);
	r10 = String___add__(r10,r13);
	hl_throw((vdynamic*)r10);
	label$2490$33:
	r14 = (dx__Texture2dDesc)hl_alloc_obj(dx__Texture2dDesc__val);
	dx_Texture2dDesc_new(r14);
	r14->width = r1;
	r14->height = r2;
	r8 = r0->depthStencilFormat;
	r14->format = r8;
	r8 = 64;
	r14->bind = r8;
	r12 = NULL;
	r6 = dx_Driver_createTexture2d(r14,r12);
	if( r6 ) goto label$2490$46;
	r10 = (String)global$511;
	hl_throw((vdynamic*)r10);
	label$2490$46:
	r4 = hl_alloc_virtual(&type$51);
	if( hl_vfields(r4)[0] ) *(dx_resource**)(hl_vfields(r4)[0]) = (dx_resource*)r6; else hl_dyn_setp(r4->value,5691744/*res*/,&type$52,r6);
	r8 = r0->depthStencilFormat;
	r5 = directx_create_depth_stencil_view(r6,r8);
	if( hl_vfields(r4)[1] ) *(dx_pointer**)(hl_vfields(r4)[1]) = (dx_pointer*)r5; else hl_dyn_setp(r4->value,240071535/*view*/,&type$53,r5);
	r0->defaultDepth = r4;
	r16 = r0->defaultDepthInst;
	if( r16 == NULL ) hl_null_access();
	r4 = r0->defaultDepth;
	r16->b = r4;
	r16 = r0->defaultDepthInst;
	if( r16 == NULL ) hl_null_access();
	r16->width = r1;
	r16 = r0->defaultDepthInst;
	if( r16 == NULL ) hl_null_access();
	r16->height = r2;
	r15 = directx_get_back_buffer();
	r17 = NULL;
	r5 = dx_Driver_createRenderTargetView(r15,r17);
	r0->defaultTarget = r5;
	r5 = r0->defaultTarget;
	r8 = 0;
	r18 = (double)r8;
	r8 = 0;
	r19 = (double)r8;
	r8 = 0;
	r20 = (double)r8;
	r8 = 0;
	r21 = (double)r8;
	directx_clear_color(r5,r18,r19,r20,r21);
	directx_release_resource(r15);
	r0->outputWidth = r1;
	r0->outputHeight = r2;
	r22 = NULL;
	r11 = NULL;
	r23 = NULL;
	h3d_impl_DirectXDriver_setRenderTarget(r0,r22,r11,r23);
	r16 = r0->extraDepthInst;
	if( !r16 ) goto label$2490$102;
	r16 = r0->extraDepthInst;
	if( r16 == NULL ) hl_null_access();
	r16->width = r1;
	r16 = r0->extraDepthInst;
	if( r16 == NULL ) hl_null_access();
	r16->height = r2;
	r16 = r0->extraDepthInst;
	if( r16 == NULL ) hl_null_access();
	r4 = r16->b;
	if( !r4 ) goto label$2490$97;
	r16 = r0->extraDepthInst;
	h3d_impl_DirectXDriver_disposeDepthBuffer(r0,r16);
	label$2490$97:
	r16 = r0->extraDepthInst;
	if( r16 == NULL ) hl_null_access();
	r24 = r0->extraDepthInst;
	r4 = h3d_impl_DirectXDriver_allocDepthBuffer(r0,r24);
	r16->b = r4;
	label$2490$102:
	return;
}

void h3d_impl_DirectXDriver_begin(h3d__impl__DirectXDriver r0,int r1) {
	int *r5, *r6;
	h3d__mat__Texture r4;
	int r2;
	r2 = 0;
	r0->mapCount = r2;
	r2 = 0;
	r0->updateResCount = r2;
	r0->frame = r1;
	r4 = NULL;
	r5 = NULL;
	r6 = NULL;
	h3d_impl_DirectXDriver_setRenderTarget(r0,r4,r5,r6);
	return;
}

bool h3d_impl_DirectXDriver_isDisposed(h3d__impl__DirectXDriver r0) {
	bool r1;
	r1 = r0->hasDeviceError;
	return r1;
}

void h3d_impl_DirectXDriver_init(h3d__impl__DirectXDriver r0,vclosure* r1,bool* r2) {
	bool r3;
	haxe__Timer r6;
	vclosure *r5;
	int r7;
	if( r2 ) goto label$2493$3;
	r3 = false;
	goto label$2493$4;
	label$2493$3:
	r3 = *r2;
	label$2493$4:
	r5 = hl_alloc_closure_ptr(&type$2109,fun$2644,r1);
	r0->onContextLost = r5;
	r5 = hl_alloc_closure_ptr(&type$2109,fun$2645,r1);
	r7 = 1;
	r6 = haxe_Timer_delay(r5,r7);
	return;
}

void h3d_impl_DirectXDriver_clear(h3d__impl__DirectXDriver r0,h3d__Vector r1,vdynamic* r2,vdynamic* r3) {
	vvirtual *r14;
	dx_pointer *r9;
	double r10, r11, r12, r13;
	varray *r8;
	int r5, r6, r7;
	if( !r1 ) goto label$2494$16;
	r5 = 0;
	r6 = r0->targetsCount;
	label$2494$3:
	if( r5 >= r6 ) goto label$2494$16;
	r7 = r5;
	++r5;
	r8 = r0->currentTargets;
	r9 = ((dx_pointer**)(r8 + 1))[r7];
	if( r1 == NULL ) hl_null_access();
	r10 = r1->x;
	r11 = r1->y;
	r12 = r1->z;
	r13 = r1->w;
	directx_clear_color(r9,r10,r11,r12,r13);
	goto label$2494$3;
	label$2494$16:
	r14 = r0->currentDepth;
	if( !r14 ) goto label$2494$24;
	if( r2 ) goto label$2494$20;
	if( !r3 ) goto label$2494$24;
	label$2494$20:
	r14 = r0->currentDepth;
	if( r14 == NULL ) hl_null_access();
	r9 = hl_vfields(r14)[1] ? (*(dx_pointer**)(hl_vfields(r14)[1])) : (dx_pointer*)hl_dyn_getp(r14->value,240071535/*view*/,&type$53);
	directx_clear_depth_stencil_view(r9,r2,r3);
	label$2494$24:
	return;
}

String h3d_impl_DirectXDriver_getDriverName(h3d__impl__DirectXDriver r0,bool r1) {
	String r2, r7, r8, r9;
	double r3;
	int *r5;
	vbyte *r6;
	int r4;
	r2 = (String)global$512;
	r3 = directx_get_supported_version();
	r5 = &r4;
	r6 = hl_ftos(r3,r5);
	r7 = String___alloc__(r6,r4);
	r2 = String___add__(r2,r7);
	if( !r1 ) goto label$2495$12;
	r8 = (String)global$192;
	r9 = dx_Driver_getDeviceName();
	r8 = String___add__(r8,r9);
	r7 = String___add__(r2,r8);
	r2 = r7;
	label$2495$12:
	return r2;
}

void h3d_impl_DirectXDriver_forceDeviceError(h3d__impl__DirectXDriver r0) {
	bool r1;
	r1 = true;
	r0->hasDeviceError = r1;
	return;
}

void h3d_impl_DirectXDriver_present(h3d__impl__DirectXDriver r0) {
	dx_pointer *r2;
	bool r3, r4;
	dx__Window r6;
	vclosure *r8;
	int r5, r7;
	r2 = r0->defaultTarget;
	if( r2 ) goto label$2497$3;
	return;
	label$2497$3:
	r3 = hxd_System_get_allowTimeout();
	if( !r3 ) goto label$2497$7;
	r4 = false;
	r4 = hxd_System_set_allowTimeout(r4);
	label$2497$7:
	r6 = r0->window;
	if( r6 == NULL ) hl_null_access();
	r4 = r6->vsync;
	if( !r4 ) goto label$2497$13;
	r5 = 1;
	goto label$2497$14;
	label$2497$13:
	r5 = 0;
	label$2497$14:
	r7 = 0;
	directx_present(r5,r7);
	if( !r3 ) goto label$2497$19;
	r4 = true;
	r4 = hxd_System_set_allowTimeout(r4);
	label$2497$19:
	r4 = r0->hasDeviceError;
	if( !r4 ) goto label$2497$28;
	r4 = false;
	r0->hasDeviceError = r4;
	h3d_impl_DirectXDriver_dispose(r0);
	h3d_impl_DirectXDriver_reset(r0);
	r8 = r0->onContextLost;
	if( r8 == NULL ) hl_null_access();
	r8->hasValue ? ((void (*)(vdynamic*))r8->fun)((vdynamic*)r8->value) : ((void (*)(void))r8->fun)();
	label$2497$28:
	return;
}

h3d__mat__DepthBuffer h3d_impl_DirectXDriver_getDefaultDepthBuffer(h3d__impl__DirectXDriver r0) {
	h3d__mat__DepthBuffer r2, r7;
	vvirtual *r6;
	venum *r5;
	int r3, r4;
	r2 = r0->extraDepthInst;
	if( r2 ) goto label$2498$21;
	r2 = (h3d__mat__DepthBuffer)hl_alloc_obj(h3d__mat__DepthBuffer__val);
	r3 = 0;
	r4 = 0;
	r5 = NULL;
	h3d_mat_DepthBuffer_new(r2,r3,r4,r5);
	r0->extraDepthInst = r2;
	r2 = r0->extraDepthInst;
	if( r2 == NULL ) hl_null_access();
	r3 = r0->outputWidth;
	r2->width = r3;
	r2 = r0->extraDepthInst;
	if( r2 == NULL ) hl_null_access();
	r3 = r0->outputHeight;
	r2->height = r3;
	r2 = r0->extraDepthInst;
	if( r2 == NULL ) hl_null_access();
	r7 = r0->extraDepthInst;
	r6 = h3d_impl_DirectXDriver_allocDepthBuffer(r0,r7);
	r2->b = r6;
	label$2498$21:
	r2 = r0->extraDepthInst;
	return r2;
}

vvirtual* h3d_impl_DirectXDriver_allocVertexes(h3d__impl__DirectXDriver r0,h3d__impl__ManagedBuffer r1) {
	vvirtual *r10;
	dx_resource *r2;
	vbyte *r9;
	int r3, r4, r5, r6, r7, r8;
	if( r1 == NULL ) hl_null_access();
	r3 = r1->size;
	r4 = r1->stride;
	r3 = r3 * r4;
	r4 = 4;
	r3 = r3 * r4;
	r4 = 0;
	r5 = 1;
	r6 = 0;
	r7 = 0;
	r8 = 0;
	r9 = NULL;
	r2 = directx_create_buffer(r3,r4,r5,r6,r7,r8,r9);
	if( r2 ) goto label$2499$16;
	r10 = NULL;
	return r10;
	label$2499$16:
	r10 = hl_alloc_virtual(&type$187);
	if( hl_vfields(r10)[1] ) *(dx_resource**)(hl_vfields(r10)[1]) = (dx_resource*)r2; else hl_dyn_setp(r10->value,5691744/*res*/,&type$52,r2);
	r3 = r1->size;
	if( hl_vfields(r10)[0] ) *(int*)(hl_vfields(r10)[0]) = (int)r3; else hl_dyn_seti(r10->value,174278105/*count*/,&type$3,r3);
	r3 = r1->stride;
	if( hl_vfields(r10)[2] ) *(int*)(hl_vfields(r10)[2]) = (int)r3; else hl_dyn_seti(r10->value,288366617/*stride*/,&type$3,r3);
	return r10;
}

vvirtual* h3d_impl_DirectXDriver_allocIndexes(h3d__impl__DirectXDriver r0,int r1,bool r2) {
	vvirtual *r12;
	dx_resource *r4;
	vbyte *r11;
	int r3, r5, r6, r7, r8, r9, r10;
	if( !r2 ) goto label$2500$3;
	r3 = 2;
	goto label$2500$4;
	label$2500$3:
	r3 = 1;
	label$2500$4:
	r5 = r1 << r3;
	r6 = 0;
	r7 = 2;
	r8 = 0;
	r9 = 0;
	r10 = 0;
	r11 = NULL;
	r4 = directx_create_buffer(r5,r6,r7,r8,r9,r10,r11);
	if( r4 ) goto label$2500$15;
	r12 = NULL;
	return r12;
	label$2500$15:
	r12 = hl_alloc_virtual(&type$66);
	if( hl_vfields(r12)[2] ) *(dx_resource**)(hl_vfields(r12)[2]) = (dx_resource*)r4; else hl_dyn_setp(r12->value,5691744/*res*/,&type$52,r4);
	if( hl_vfields(r12)[1] ) *(int*)(hl_vfields(r12)[1]) = (int)r1; else hl_dyn_seti(r12->value,174278105/*count*/,&type$3,r1);
	if( hl_vfields(r12)[0] ) *(int*)(hl_vfields(r12)[0]) = (int)r3; else hl_dyn_seti(r12->value,18283536/*bits*/,&type$3,r3);
	return r12;
}

vvirtual* h3d_impl_DirectXDriver_allocDepthBuffer(h3d__impl__DirectXDriver r0,h3d__mat__DepthBuffer r1) {
	dx_pointer *r8;
	vvirtual *r7;
	dx_resource *r5;
	dx__Texture2dDesc r2;
	vbyte *r6;
	int r4;
	r2 = (dx__Texture2dDesc)hl_alloc_obj(dx__Texture2dDesc__val);
	dx_Texture2dDesc_new(r2);
	if( r1 == NULL ) hl_null_access();
	r4 = r1->width;
	r2->width = r4;
	r4 = r1->height;
	r2->height = r4;
	r4 = 45;
	r2->format = r4;
	r4 = 64;
	r2->bind = r4;
	r6 = NULL;
	r5 = dx_Driver_createTexture2d(r2,r6);
	if( r5 ) goto label$2501$16;
	r7 = NULL;
	return r7;
	label$2501$16:
	r7 = hl_alloc_virtual(&type$51);
	if( hl_vfields(r7)[0] ) *(dx_resource**)(hl_vfields(r7)[0]) = (dx_resource*)r5; else hl_dyn_setp(r7->value,5691744/*res*/,&type$52,r5);
	r4 = r2->format;
	r8 = directx_create_depth_stencil_view(r5,r4);
	if( hl_vfields(r7)[1] ) *(dx_pointer**)(hl_vfields(r7)[1]) = (dx_pointer*)r8; else hl_dyn_setp(r7->value,240071535/*view*/,&type$53,r8);
	return r7;
}

void h3d_impl_DirectXDriver_disposeDepthBuffer(h3d__impl__DirectXDriver r0,h3d__mat__DepthBuffer r1) {
	dx_pointer *r5;
	vvirtual *r2, *r4;
	dx_resource *r6;
	if( r1 == NULL ) hl_null_access();
	r2 = r1->b;
	r4 = NULL;
	r1->b = r4;
	if( r2 == NULL ) hl_null_access();
	r5 = hl_vfields(r2)[1] ? (*(dx_pointer**)(hl_vfields(r2)[1])) : (dx_pointer*)hl_dyn_getp(r2->value,240071535/*view*/,&type$53);
	directx_release_pointer(r5);
	r6 = hl_vfields(r2)[0] ? (*(dx_resource**)(hl_vfields(r2)[0])) : (dx_resource*)hl_dyn_getp(r2->value,5691744/*res*/,&type$52);
	directx_release_resource(r6);
	return;
}

void h3d_impl_DirectXDriver_captureRenderBuffer(h3d__impl__DirectXDriver r0,hxd__Pixels r1) {
	String r4;
	hxd__Pixels r5;
	int r6, r7;
	h3d__mat__Texture r2;
	r2 = r0->curTexture;
	if( r2 ) goto label$2503$4;
	r4 = (String)global$513;
	hl_throw((vdynamic*)r4);
	label$2503$4:
	r6 = 0;
	r7 = 0;
	r5 = h3d_impl_DirectXDriver_captureTexPixels(r0,r1,r2,r6,r7);
	return;
}

bool h3d_impl_DirectXDriver_isSupportedFormat(h3d__impl__DirectXDriver r0,venum* r1) {
	bool r3;
	int r2;
	if( r1 == NULL ) hl_null_access();
	r2 = HL__ENUM_INDEX__(r1);
	switch(r2) {
		default:
		case 2:
		case 3:
		case 4:
		case 5:
		case 6:
		case 7:
		case 8:
		case 9:
		case 10:
		case 13:
			r3 = true;
			return r3;
		case 0:
		case 1:
		case 11:
		case 12:
		case 14:
			r3 = false;
			return r3;
	}
}

int h3d_impl_DirectXDriver_getTextureFormat(h3d__impl__DirectXDriver r0,h3d__mat__Texture r1) {
	String r4, r5;
	venum *r3;
	int r2;
	if( r1 == NULL ) hl_null_access();
	r3 = r1->format;
	if( r3 == NULL ) hl_null_access();
	r2 = HL__ENUM_INDEX__(r3);
	switch(r2) {
		default:
		case 0:
		case 1:
		case 11:
		case 12:
		case 14:
			r4 = (String)global$514;
			r3 = r1->format;
			r5 = Std_string(((vdynamic*)r3));
			r4 = String___add__(r4,r5);
			hl_throw((vdynamic*)r4);
		case 2:
			r2 = 28;
			return r2;
		case 3:
			r2 = 10;
			return r2;
		case 4:
			r2 = 2;
			return r2;
		case 5:
			r2 = 61;
			return r2;
		case 6:
			r2 = 54;
			return r2;
		case 7:
			r2 = 41;
			return r2;
		case 8:
			r2 = 49;
			return r2;
		case 9:
			r2 = 34;
			return r2;
		case 10:
			r2 = 16;
			return r2;
		case 13:
			r2 = 6;
			return r2;
		case 15:
			r2 = 29;
			return r2;
		case 16:
			r2 = 24;
			return r2;
		case 17:
			r2 = 26;
			return r2;
	}
}

vvirtual* h3d_impl_DirectXDriver_allocTexture(h3d__impl__DirectXDriver r0,h3d__mat__Texture r1) {
	hl__types__ArrayObj r15;
	dx_pointer *r14;
	vvirtual *r12;
	hl_type *r17;
	dx__ShaderResourceViewDesc r13;
	bool r6, r7, r8;
	dx_resource *r10;
	dx__Texture2dDesc r9;
	varray *r16;
	vbyte *r11;
	int r2, r4, r5;
	r2 = 1;
	if( r1 == NULL ) hl_null_access();
	r4 = r1->flags;
	r5 = 4;
	r4 = r4 & r5;
	r5 = 0;
	if( r4 == r5 ) goto label$2506$19;
	label$2506$7:
	if( r1 == NULL ) hl_null_access();
	r4 = r1->width;
	r5 = 1;
	r5 = r5 << r2;
	if( r4 >= r5 ) goto label$2506$17;
	r4 = r1->height;
	r5 = 1;
	r5 = r5 << r2;
	if( r4 < r5 ) goto label$2506$19;
	label$2506$17:
	++r2;
	goto label$2506$7;
	label$2506$19:
	r4 = r1->flags;
	r5 = 1;
	r4 = r4 & r5;
	r5 = 0;
	if( r4 != r5 ) goto label$2506$26;
	r6 = false;
	goto label$2506$27;
	label$2506$26:
	r6 = true;
	label$2506$27:
	r4 = r1->flags;
	r5 = 2;
	r4 = r4 & r5;
	r5 = 0;
	if( r4 != r5 ) goto label$2506$34;
	r7 = false;
	goto label$2506$35;
	label$2506$34:
	r7 = true;
	label$2506$35:
	r4 = r1->flags;
	r5 = 2048;
	r4 = r4 & r5;
	r5 = 0;
	if( r4 != r5 ) goto label$2506$42;
	r8 = false;
	goto label$2506$43;
	label$2506$42:
	r8 = true;
	label$2506$43:
	r9 = (dx__Texture2dDesc)hl_alloc_obj(dx__Texture2dDesc__val);
	dx_Texture2dDesc_new(r9);
	r4 = r1->width;
	r9->width = r4;
	r4 = r1->height;
	r9->height = r4;
	r4 = h3d_impl_DirectXDriver_getTextureFormat(r0,r1);
	r9->format = r4;
	r4 = 0;
	r9->usage = r4;
	r4 = 8;
	r9->bind = r4;
	r9->mipLevels = r2;
	if( !r6 ) goto label$2506$61;
	r4 = r9->bind;
	r5 = 32;
	r4 = r4 | r5;
	r9->bind = r4;
	label$2506$61:
	if( !r7 ) goto label$2506$68;
	r4 = 6;
	r9->arraySize = r4;
	r4 = r9->misc;
	r5 = 4;
	r4 = r4 | r5;
	r9->misc = r4;
	label$2506$68:
	if( !r8 ) goto label$2506$71;
	r4 = ((int (*)(h3d__mat__Texture))r1->$type->vobj_proto[0])(r1);
	r9->arraySize = r4;
	label$2506$71:
	r4 = r1->flags;
	r5 = 4;
	r4 = r4 & r5;
	r5 = 0;
	if( r4 == r5 ) goto label$2506$89;
	r4 = r1->flags;
	r5 = 8;
	r4 = r4 & r5;
	r5 = 0;
	if( r4 != r5 ) goto label$2506$89;
	r4 = r9->bind;
	r5 = 32;
	r4 = r4 | r5;
	r9->bind = r4;
	r4 = r9->misc;
	r5 = 1;
	r4 = r4 | r5;
	r9->misc = r4;
	label$2506$89:
	r11 = NULL;
	r10 = dx_Driver_createTexture2d(r9,r11);
	if( r10 ) goto label$2506$94;
	r12 = NULL;
	return r12;
	label$2506$94:
	r4 = r0->frame;
	r1->lastFrame = r4;
	r4 = r1->flags;
	r5 = -257;
	r4 = r4 & r5;
	r1->flags = r4;
	r13 = (dx__ShaderResourceViewDesc)hl_alloc_obj(dx__ShaderResourceViewDesc__val);
	dx_ShaderResourceViewDesc_new(r13);
	r4 = r9->format;
	r13->format = r4;
	if( !r7 ) goto label$2506$107;
	r4 = 9;
	goto label$2506$111;
	label$2506$107:
	if( !r8 ) goto label$2506$110;
	r4 = 5;
	goto label$2506$111;
	label$2506$110:
	r4 = 4;
	label$2506$111:
	r13->dimension = r4;
	r4 = r9->arraySize;
	r13->arraySize = r4;
	r4 = 0;
	r13->start = r4;
	r4 = -1;
	r13->count = r4;
	r12 = hl_alloc_virtual(&type$94);
	if( hl_vfields(r12)[1] ) *(dx_resource**)(hl_vfields(r12)[1]) = (dx_resource*)r10; else hl_dyn_setp(r12->value,5691744/*res*/,&type$52,r10);
	r14 = dx_Driver_createShaderResourceView(r10,r13);
	if( hl_vfields(r12)[3] ) *(dx_pointer**)(hl_vfields(r12)[3]) = (dx_pointer*)r14; else hl_dyn_setp(r12->value,240071535/*view*/,&type$53,r14);
	if( !r6 ) goto label$2506$128;
	r17 = &type$9;
	r4 = 0;
	r16 = hl_alloc_array(r17,r4);
	r15 = hl_types_ArrayObj_alloc(r16);
	goto label$2506$129;
	label$2506$128:
	r15 = NULL;
	label$2506$129:
	if( hl_vfields(r12)[2] ) *(hl__types__ArrayObj*)(hl_vfields(r12)[2]) = (hl__types__ArrayObj)r15; else hl_dyn_setp(r12->value,25538/*rt*/,&type$46,r15);
	if( hl_vfields(r12)[0] ) *(int*)(hl_vfields(r12)[0]) = (int)r2; else hl_dyn_seti(r12->value,140267881/*mips*/,&type$3,r2);
	return r12;
}

void h3d_impl_DirectXDriver_disposeTexture(h3d__impl__DirectXDriver r0,h3d__mat__Texture r1) {
	hl__types__ArrayObj r8;
	dx_pointer *r6;
	vvirtual *r2, *r4;
	dx_resource *r7;
	vdynamic *r5;
	varray *r11;
	int r9, r10;
	if( r1 == NULL ) hl_null_access();
	r2 = r1->_t;
	if( r2 ) goto label$2507$4;
	return;
	label$2507$4:
	r4 = NULL;
	r1->_t = r4;
	if( r2 == NULL ) hl_null_access();
	r6 = hl_vfields(r2)[3] ? (*(dx_pointer**)(hl_vfields(r2)[3])) : (dx_pointer*)hl_dyn_getp(r2->value,240071535/*view*/,&type$53);
	if( !r6 ) goto label$2507$11;
	r6 = hl_vfields(r2)[3] ? (*(dx_pointer**)(hl_vfields(r2)[3])) : (dx_pointer*)hl_dyn_getp(r2->value,240071535/*view*/,&type$53);
	directx_release_pointer(r6);
	label$2507$11:
	r7 = hl_vfields(r2)[1] ? (*(dx_resource**)(hl_vfields(r2)[1])) : (dx_resource*)hl_dyn_getp(r2->value,5691744/*res*/,&type$52);
	if( !r7 ) goto label$2507$15;
	r7 = hl_vfields(r2)[1] ? (*(dx_resource**)(hl_vfields(r2)[1])) : (dx_resource*)hl_dyn_getp(r2->value,5691744/*res*/,&type$52);
	directx_release_resource(r7);
	label$2507$15:
	r8 = hl_vfields(r2)[2] ? (*(hl__types__ArrayObj*)(hl_vfields(r2)[2])) : (hl__types__ArrayObj)hl_dyn_getp(r2->value,25538/*rt*/,&type$46);
	if( !r8 ) goto label$2507$34;
	r9 = 0;
	r8 = hl_vfields(r2)[2] ? (*(hl__types__ArrayObj*)(hl_vfields(r2)[2])) : (hl__types__ArrayObj)hl_dyn_getp(r2->value,25538/*rt*/,&type$46);
	label$2507$19:
	if( r8 == NULL ) hl_null_access();
	r10 = r8->length;
	if( r9 >= r10 ) goto label$2507$34;
	r10 = r8->length;
	if( ((unsigned)r9) < ((unsigned)r10) ) goto label$2507$27;
	r6 = NULL;
	goto label$2507$30;
	label$2507$27:
	r11 = r8->array;
	r5 = ((vdynamic**)(r11 + 1))[r9];
	r6 = (dx_pointer*)hl_dyn_castp(&r5,&type$9,&type$53);
	label$2507$30:
	++r9;
	if( !r6 ) goto label$2507$33;
	directx_release_pointer(r6);
	label$2507$33:
	goto label$2507$19;
	label$2507$34:
	return;
}

void h3d_impl_DirectXDriver_disposeVertexes(h3d__impl__DirectXDriver r0,vvirtual* r1) {
	dx_resource *r3;
	if( r1 == NULL ) hl_null_access();
	r3 = hl_vfields(r1)[1] ? (*(dx_resource**)(hl_vfields(r1)[1])) : (dx_resource*)hl_dyn_getp(r1->value,5691744/*res*/,&type$52);
	directx_release_resource(r3);
	return;
}

void h3d_impl_DirectXDriver_disposeIndexes(h3d__impl__DirectXDriver r0,vvirtual* r1) {
	dx_resource *r3;
	if( r1 == NULL ) hl_null_access();
	r3 = hl_vfields(r1)[2] ? (*(dx_resource**)(hl_vfields(r1)[2])) : (dx_resource*)hl_dyn_getp(r1->value,5691744/*res*/,&type$52);
	directx_release_resource(r3);
	return;
}

void h3d_impl_DirectXDriver_generateMipMaps(h3d__impl__DirectXDriver r0,h3d__mat__Texture r1) {
	vvirtual *r5;
	dx_pointer *r4;
	bool r3;
	r3 = r0->hasDeviceError;
	if( !r3 ) goto label$2510$3;
	return;
	label$2510$3:
	if( r1 == NULL ) hl_null_access();
	r5 = r1->_t;
	if( r5 == NULL ) hl_null_access();
	r4 = hl_vfields(r5)[3] ? (*(dx_pointer**)(hl_vfields(r5)[3])) : (dx_pointer*)hl_dyn_getp(r5->value,240071535/*view*/,&type$53);
	directx_generate_mips(r4);
	return;
}

void h3d_impl_DirectXDriver_updateBuffer(h3d__impl__DirectXDriver r0,dx_resource* r1,vbyte* r2,int r3,int r4) {
	dx__ResourceBox r5;
	int r6, r7, r9;
	r5 = r0->box;
	if( r5 == NULL ) hl_null_access();
	r5->left = r3;
	r5 = r0->box;
	if( r5 == NULL ) hl_null_access();
	r6 = 0;
	r5->top = r6;
	r5 = r0->box;
	if( r5 == NULL ) hl_null_access();
	r6 = 0;
	r5->front = r6;
	r5 = r0->box;
	if( r5 == NULL ) hl_null_access();
	r6 = r3 + r4;
	r5->right = r6;
	r5 = r0->box;
	if( r5 == NULL ) hl_null_access();
	r6 = 1;
	r5->bottom = r6;
	r5 = r0->box;
	if( r5 == NULL ) hl_null_access();
	r6 = 1;
	r5->back = r6;
	r6 = 0;
	r5 = r0->box;
	r7 = 0;
	r9 = 0;
	directx_update_subresource(r1,r6,((vdynamic*)r5),r2,r7,r9);
	r6 = r0->updateResCount;
	++r6;
	r0->updateResCount = r6;
	return;
}

void h3d_impl_DirectXDriver_uploadIndexBuffer(h3d__impl__DirectXDriver r0,vvirtual* r1,int r2,int r3,hl__types__ArrayBytes_hl_UI16 r4,int r5) {
	bool r7;
	dx_resource *r8;
	int r10, r11, r12;
	vbyte *r9;
	r7 = r0->hasDeviceError;
	if( !r7 ) goto label$2512$3;
	return;
	label$2512$3:
	if( r1 == NULL ) hl_null_access();
	r8 = hl_vfields(r1)[2] ? (*(dx_resource**)(hl_vfields(r1)[2])) : (dx_resource*)hl_dyn_getp(r1->value,5691744/*res*/,&type$52);
	if( r4 == NULL ) hl_null_access();
	r9 = r4->bytes;
	r11 = hl_vfields(r1)[0] ? (*(int*)(hl_vfields(r1)[0])) : (int)hl_dyn_geti(r1->value,18283536/*bits*/,&type$3);
	r10 = r5 << r11;
	r9 = hl_bytes_offset(r9,r10);
	r11 = hl_vfields(r1)[0] ? (*(int*)(hl_vfields(r1)[0])) : (int)hl_dyn_geti(r1->value,18283536/*bits*/,&type$3);
	r10 = r2 << r11;
	r12 = hl_vfields(r1)[0] ? (*(int*)(hl_vfields(r1)[0])) : (int)hl_dyn_geti(r1->value,18283536/*bits*/,&type$3);
	r11 = r3 << r12;
	h3d_impl_DirectXDriver_updateBuffer(r0,r8,r9,r10,r11);
	return;
}

void h3d_impl_DirectXDriver_uploadIndexBytes(h3d__impl__DirectXDriver r0,vvirtual* r1,int r2,int r3,haxe__io__Bytes r4,int r5) {
	bool r7;
	dx_resource *r8;
	int r10, r11, r12;
	vbyte *r9;
	r7 = r0->hasDeviceError;
	if( !r7 ) goto label$2513$3;
	return;
	label$2513$3:
	if( r1 == NULL ) hl_null_access();
	r8 = hl_vfields(r1)[2] ? (*(dx_resource**)(hl_vfields(r1)[2])) : (dx_resource*)hl_dyn_getp(r1->value,5691744/*res*/,&type$52);
	if( r4 == NULL ) hl_null_access();
	r9 = r4->b;
	r11 = hl_vfields(r1)[0] ? (*(int*)(hl_vfields(r1)[0])) : (int)hl_dyn_geti(r1->value,18283536/*bits*/,&type$3);
	r10 = r5 << r11;
	r9 = hl_bytes_offset(r9,r10);
	r11 = hl_vfields(r1)[0] ? (*(int*)(hl_vfields(r1)[0])) : (int)hl_dyn_geti(r1->value,18283536/*bits*/,&type$3);
	r10 = r2 << r11;
	r12 = hl_vfields(r1)[0] ? (*(int*)(hl_vfields(r1)[0])) : (int)hl_dyn_geti(r1->value,18283536/*bits*/,&type$3);
	r11 = r3 << r12;
	h3d_impl_DirectXDriver_updateBuffer(r0,r8,r9,r10,r11);
	return;
}

void h3d_impl_DirectXDriver_uploadVertexBuffer(h3d__impl__DirectXDriver r0,vvirtual* r1,int r2,int r3,hl__types__ArrayBytes_Single r4,int r5) {
	bool r7;
	dx_resource *r8;
	int r10, r11, r12;
	vbyte *r9;
	r7 = r0->hasDeviceError;
	if( !r7 ) goto label$2514$3;
	return;
	label$2514$3:
	if( r1 == NULL ) hl_null_access();
	r8 = hl_vfields(r1)[1] ? (*(dx_resource**)(hl_vfields(r1)[1])) : (dx_resource*)hl_dyn_getp(r1->value,5691744/*res*/,&type$52);
	if( r4 == NULL ) hl_null_access();
	r9 = r4->bytes;
	r11 = 2;
	r10 = r5 << r11;
	r9 = hl_bytes_offset(r9,r10);
	r11 = hl_vfields(r1)[2] ? (*(int*)(hl_vfields(r1)[2])) : (int)hl_dyn_geti(r1->value,288366617/*stride*/,&type$3);
	r10 = r2 * r11;
	r11 = 2;
	r10 = r10 << r11;
	r12 = hl_vfields(r1)[2] ? (*(int*)(hl_vfields(r1)[2])) : (int)hl_dyn_geti(r1->value,288366617/*stride*/,&type$3);
	r11 = r3 * r12;
	r12 = 2;
	r11 = r11 << r12;
	h3d_impl_DirectXDriver_updateBuffer(r0,r8,r9,r10,r11);
	return;
}

void h3d_impl_DirectXDriver_uploadVertexBytes(h3d__impl__DirectXDriver r0,vvirtual* r1,int r2,int r3,haxe__io__Bytes r4,int r5) {
	bool r7;
	dx_resource *r8;
	int r10, r11, r12;
	vbyte *r9;
	r7 = r0->hasDeviceError;
	if( !r7 ) goto label$2515$3;
	return;
	label$2515$3:
	if( r1 == NULL ) hl_null_access();
	r8 = hl_vfields(r1)[1] ? (*(dx_resource**)(hl_vfields(r1)[1])) : (dx_resource*)hl_dyn_getp(r1->value,5691744/*res*/,&type$52);
	if( r4 == NULL ) hl_null_access();
	r9 = r4->b;
	r11 = 2;
	r10 = r5 << r11;
	r9 = hl_bytes_offset(r9,r10);
	r11 = hl_vfields(r1)[2] ? (*(int*)(hl_vfields(r1)[2])) : (int)hl_dyn_geti(r1->value,288366617/*stride*/,&type$3);
	r10 = r2 * r11;
	r11 = 2;
	r10 = r10 << r11;
	r12 = hl_vfields(r1)[2] ? (*(int*)(hl_vfields(r1)[2])) : (int)hl_dyn_geti(r1->value,288366617/*stride*/,&type$3);
	r11 = r3 * r12;
	r12 = 2;
	r11 = r11 << r12;
	h3d_impl_DirectXDriver_updateBuffer(r0,r8,r9,r10,r11);
	return;
}

void h3d_impl_DirectXDriver_readIndexBytes(h3d__impl__DirectXDriver r0,vvirtual* r1,int r2,int r3,haxe__io__Bytes r4,int r5) {
	bool r17;
	dx_resource *r6, *r16;
	dx__ResourceBox r15;
	int *r18;
	vbyte *r13, *r19;
	int r7, r8, r9, r10, r11, r12;
	if( r1 == NULL ) hl_null_access();
	r8 = hl_vfields(r1)[0] ? (*(int*)(hl_vfields(r1)[0])) : (int)hl_dyn_geti(r1->value,18283536/*bits*/,&type$3);
	r7 = r3 << r8;
	r8 = 3;
	r9 = 0;
	r10 = 131072;
	r11 = 65536;
	r10 = r10 | r11;
	r11 = 0;
	r12 = 0;
	r13 = NULL;
	r6 = directx_create_buffer(r7,r8,r9,r10,r11,r12,r13);
	r15 = r0->box;
	if( r15 == NULL ) hl_null_access();
	r8 = hl_vfields(r1)[0] ? (*(int*)(hl_vfields(r1)[0])) : (int)hl_dyn_geti(r1->value,18283536/*bits*/,&type$3);
	r7 = r2 << r8;
	r15->left = r7;
	r15 = r0->box;
	if( r15 == NULL ) hl_null_access();
	r7 = 0;
	r15->top = r7;
	r15 = r0->box;
	if( r15 == NULL ) hl_null_access();
	r7 = 0;
	r15->front = r7;
	r15 = r0->box;
	if( r15 == NULL ) hl_null_access();
	r7 = r2 + r3;
	r8 = hl_vfields(r1)[0] ? (*(int*)(hl_vfields(r1)[0])) : (int)hl_dyn_geti(r1->value,18283536/*bits*/,&type$3);
	r7 = r7 << r8;
	r15->right = r7;
	r15 = r0->box;
	if( r15 == NULL ) hl_null_access();
	r7 = 1;
	r15->bottom = r7;
	r15 = r0->box;
	if( r15 == NULL ) hl_null_access();
	r7 = 1;
	r15->back = r7;
	r7 = 0;
	r8 = 0;
	r9 = 0;
	r10 = 0;
	r16 = hl_vfields(r1)[2] ? (*(dx_resource**)(hl_vfields(r1)[2])) : (dx_resource*)hl_dyn_getp(r1->value,5691744/*res*/,&type$52);
	r11 = 0;
	r15 = r0->box;
	directx_copy_subresource_region(r6,r7,r8,r9,r10,r16,r11,((vdynamic*)r15));
	r7 = 0;
	r8 = 1;
	r17 = true;
	r18 = NULL;
	r13 = directx_map(r6,r7,r8,r17,r18);
	if( r4 == NULL ) hl_null_access();
	r19 = r4->b;
	r8 = 0;
	r10 = hl_vfields(r1)[0] ? (*(int*)(hl_vfields(r1)[0])) : (int)hl_dyn_geti(r1->value,18283536/*bits*/,&type$3);
	r9 = r3 << r10;
	hl_bytes_blit(r19,r5,r13,r8,r9);
	r7 = 0;
	directx_unmap(r6,r7);
	directx_release_resource(r6);
	return;
}

void h3d_impl_DirectXDriver_readVertexBytes(h3d__impl__DirectXDriver r0,vvirtual* r1,int r2,int r3,haxe__io__Bytes r4,int r5) {
	bool r17;
	dx_resource *r6, *r16;
	dx__ResourceBox r15;
	int *r18;
	vbyte *r13, *r19;
	int r7, r8, r9, r10, r11, r12;
	if( r1 == NULL ) hl_null_access();
	r8 = hl_vfields(r1)[2] ? (*(int*)(hl_vfields(r1)[2])) : (int)hl_dyn_geti(r1->value,288366617/*stride*/,&type$3);
	r7 = r3 * r8;
	r8 = 4;
	r7 = r7 * r8;
	r8 = 3;
	r9 = 0;
	r10 = 131072;
	r11 = 65536;
	r10 = r10 | r11;
	r11 = 0;
	r12 = 0;
	r13 = NULL;
	r6 = directx_create_buffer(r7,r8,r9,r10,r11,r12,r13);
	r15 = r0->box;
	if( r15 == NULL ) hl_null_access();
	r8 = hl_vfields(r1)[2] ? (*(int*)(hl_vfields(r1)[2])) : (int)hl_dyn_geti(r1->value,288366617/*stride*/,&type$3);
	r7 = r2 * r8;
	r8 = 4;
	r7 = r7 * r8;
	r15->left = r7;
	r15 = r0->box;
	if( r15 == NULL ) hl_null_access();
	r7 = 0;
	r15->top = r7;
	r15 = r0->box;
	if( r15 == NULL ) hl_null_access();
	r7 = 0;
	r15->front = r7;
	r15 = r0->box;
	if( r15 == NULL ) hl_null_access();
	r7 = r2 + r3;
	r8 = 4;
	r7 = r7 * r8;
	r8 = hl_vfields(r1)[2] ? (*(int*)(hl_vfields(r1)[2])) : (int)hl_dyn_geti(r1->value,288366617/*stride*/,&type$3);
	r7 = r7 * r8;
	r15->right = r7;
	r15 = r0->box;
	if( r15 == NULL ) hl_null_access();
	r7 = 1;
	r15->bottom = r7;
	r15 = r0->box;
	if( r15 == NULL ) hl_null_access();
	r7 = 1;
	r15->back = r7;
	r7 = 0;
	r8 = 0;
	r9 = 0;
	r10 = 0;
	r16 = hl_vfields(r1)[1] ? (*(dx_resource**)(hl_vfields(r1)[1])) : (dx_resource*)hl_dyn_getp(r1->value,5691744/*res*/,&type$52);
	r11 = 0;
	r15 = r0->box;
	directx_copy_subresource_region(r6,r7,r8,r9,r10,r16,r11,((vdynamic*)r15));
	r7 = 0;
	r8 = 1;
	r17 = true;
	r18 = NULL;
	r13 = directx_map(r6,r7,r8,r17,r18);
	if( r4 == NULL ) hl_null_access();
	r19 = r4->b;
	r8 = 0;
	r10 = hl_vfields(r1)[2] ? (*(int*)(hl_vfields(r1)[2])) : (int)hl_dyn_geti(r1->value,288366617/*stride*/,&type$3);
	r9 = r3 * r10;
	r10 = 4;
	r9 = r9 * r10;
	hl_bytes_blit(r19,r5,r13,r8,r9);
	r7 = 0;
	directx_unmap(r6,r7);
	directx_release_resource(r6);
	return;
}

hxd__Pixels h3d_impl_DirectXDriver_capturePixels(h3d__impl__DirectXDriver r0,h3d__mat__Texture r1,int r2,int r3) {
	hxd__Pixels r4, r8;
	venum *r7;
	int r5, r6;
	if( r1 == NULL ) hl_null_access();
	r5 = r1->width;
	r5 = r5 >> r3;
	r6 = r1->height;
	r6 = r6 >> r3;
	r7 = r1->format;
	r4 = hxd_Pixels_alloc(r5,r6,r7);
	r8 = h3d_impl_DirectXDriver_captureTexPixels(r0,r4,r1,r2,r3);
	return r4;
}

hxd__Pixels h3d_impl_DirectXDriver_captureTexPixels(h3d__impl__DirectXDriver r0,hxd__Pixels r1,h3d__mat__Texture r2,int r3,int r4) {
	String r11;
	vvirtual *r15;
	venum *r19;
	haxe__io__Bytes r23;
	bool r20;
	dx_resource *r9, *r14;
	dx__ResourceBox r18;
	dx__Texture2dDesc r5;
	int *r21;
	vbyte *r10, *r22;
	int r7, r8, r12, r13, r16, r17, r24, r25;
	r5 = (dx__Texture2dDesc)hl_alloc_obj(dx__Texture2dDesc__val);
	dx_Texture2dDesc_new(r5);
	if( r1 == NULL ) hl_null_access();
	r7 = r1->width;
	r5->width = r7;
	r7 = r1->height;
	r5->height = r7;
	r7 = 131072;
	r8 = 65536;
	r7 = r7 | r8;
	r5->access = r7;
	r7 = 3;
	r5->usage = r7;
	r7 = h3d_impl_DirectXDriver_getTextureFormat(r0,r2);
	r5->format = r7;
	r10 = NULL;
	r9 = dx_Driver_createTexture2d(r5,r10);
	if( r9 ) goto label$2519$20;
	r11 = (String)global$515;
	hl_throw((vdynamic*)r11);
	label$2519$20:
	r7 = 0;
	r8 = 0;
	r12 = 0;
	r13 = 0;
	if( r2 == NULL ) hl_null_access();
	r15 = r2->_t;
	if( r15 == NULL ) hl_null_access();
	r14 = hl_vfields(r15)[1] ? (*(dx_resource**)(hl_vfields(r15)[1])) : (dx_resource*)hl_dyn_getp(r15->value,5691744/*res*/,&type$52);
	r15 = r2->_t;
	if( r15 == NULL ) hl_null_access();
	r16 = hl_vfields(r15)[0] ? (*(int*)(hl_vfields(r15)[0])) : (int)hl_dyn_geti(r15->value,140267881/*mips*/,&type$3);
	r16 = r16 * r3;
	r16 = r16 + r4;
	r18 = NULL;
	directx_copy_subresource_region(r9,r7,r8,r12,r13,r14,r16,((vdynamic*)r18));
	r7 = 0;
	r19 = r2->format;
	r8 = hxd_Pixels_getBytesPerPixel(r19);
	r12 = 0;
	r13 = 1;
	r20 = true;
	r21 = &r7;
	r10 = directx_map(r9,r12,r13,r20,r21);
	r13 = r5->width;
	r13 = r13 * r8;
	if( r7 != r13 ) goto label$2519$57;
	r23 = r1->bytes;
	if( r23 == NULL ) hl_null_access();
	r22 = r23->b;
	r12 = 0;
	r13 = 0;
	r16 = r5->width;
	r17 = r5->height;
	r16 = r16 * r17;
	r16 = r16 * r8;
	hl_bytes_blit(r22,r12,r10,r13,r16);
	goto label$2519$76;
	label$2519$57:
	r12 = 0;
	r13 = r5->height;
	label$2519$59:
	if( r12 >= r13 ) goto label$2519$76;
	r16 = r12;
	++r12;
	if( r1 == NULL ) hl_null_access();
	r23 = r1->bytes;
	if( r23 == NULL ) hl_null_access();
	r22 = r23->b;
	if( r5 == NULL ) hl_null_access();
	r24 = r5->width;
	r17 = r16 * r24;
	r17 = r17 * r8;
	r24 = r16 * r7;
	r25 = r5->width;
	r25 = r25 * r8;
	hl_bytes_blit(r22,r17,r10,r24,r25);
	goto label$2519$59;
	label$2519$76:
	r12 = 0;
	directx_unmap(r9,r12);
	directx_release_resource(r9);
	return r1;
}

void h3d_impl_DirectXDriver_uploadTextureBitmap(h3d__impl__DirectXDriver r0,h3d__mat__Texture r1,hxd__BitmapData r2,int r3,int r4) {
	hxd__Pixels r7;
	bool r6;
	r6 = r0->hasDeviceError;
	if( !r6 ) goto label$2520$3;
	return;
	label$2520$3:
	if( r2 == NULL ) hl_null_access();
	r7 = hxd_BitmapData_getPixels(r2);
	h3d_impl_DirectXDriver_uploadTexturePixels(r0,r1,r7,r3,r4);
	if( r7 == NULL ) hl_null_access();
	hxd_Pixels_dispose(r7);
	return;
}

void h3d_impl_DirectXDriver_uploadTexturePixels(h3d__impl__DirectXDriver r0,h3d__mat__Texture r1,hxd__Pixels r2,int r3,int r4) {
	String r11, r14;
	vvirtual *r10;
	venum *r6;
	haxe__io__Bytes r18;
	bool r7;
	dx_resource *r15;
	dx__ResourceBox r17;
	int *r12;
	vbyte *r13;
	int r8, r9, r16;
	if( r2 == NULL ) hl_null_access();
	if( r1 == NULL ) hl_null_access();
	r6 = r1->format;
	hxd_Pixels_convert(r2,r6);
	r7 = false;
	hxd_Pixels_setFlip(r2,r7);
	r7 = r0->hasDeviceError;
	if( !r7 ) goto label$2521$9;
	return;
	label$2521$9:
	r10 = r1->_t;
	if( r10 == NULL ) hl_null_access();
	r9 = hl_vfields(r10)[0] ? (*(int*)(hl_vfields(r10)[0])) : (int)hl_dyn_geti(r10->value,140267881/*mips*/,&type$3);
	if( r3 < r9 ) goto label$2521$33;
	r11 = (String)global$516;
	r8 = r3;
	r12 = &r8;
	r13 = hl_itos(r8,r12);
	r14 = String___alloc__(r13,r8);
	r11 = String___add__(r11,r14);
	r14 = (String)global$517;
	r11 = String___add__(r11,r14);
	r10 = r1->_t;
	if( r10 == NULL ) hl_null_access();
	r8 = hl_vfields(r10)[0] ? (*(int*)(hl_vfields(r10)[0])) : (int)hl_dyn_geti(r10->value,140267881/*mips*/,&type$3);
	r9 = 1;
	r8 = r8 - r9;
	r12 = &r8;
	r13 = hl_itos(r8,r12);
	r14 = String___alloc__(r13,r8);
	r11 = String___add__(r11,r14);
	r14 = (String)global$177;
	r11 = String___add__(r11,r14);
	hl_throw((vdynamic*)r11);
	label$2521$33:
	r10 = r1->_t;
	if( r10 == NULL ) hl_null_access();
	r15 = hl_vfields(r10)[1] ? (*(dx_resource**)(hl_vfields(r10)[1])) : (dx_resource*)hl_dyn_getp(r10->value,5691744/*res*/,&type$52);
	r10 = r1->_t;
	if( r10 == NULL ) hl_null_access();
	r16 = hl_vfields(r10)[0] ? (*(int*)(hl_vfields(r10)[0])) : (int)hl_dyn_geti(r10->value,140267881/*mips*/,&type$3);
	r9 = r4 * r16;
	r8 = r3 + r9;
	r17 = NULL;
	r18 = r2->bytes;
	if( r18 == NULL ) hl_null_access();
	r13 = r18->b;
	r9 = r2->offset;
	r13 = hl_bytes_offset(r13,r9);
	r9 = r2->width;
	r16 = r2->bytesPerPixel;
	r9 = r9 * r16;
	r16 = 0;
	directx_update_subresource(r15,r8,((vdynamic*)r17),r13,r9,r16);
	r8 = r0->updateResCount;
	++r8;
	r0->updateResCount = r8;
	return;
}

void h3d_impl_DirectXDriver_selectMaterial(h3d__impl__DirectXDriver r0,h3d__mat__Pass r1) {
	hl__types__ArrayObj r18;
	dx_pointer *r14, *r17, *r32, *r36, *r39;
	vvirtual *r13, *r15, *r21;
	hl_type *r31;
	venum *r29, *r30, *r34, *r35;
	dx__DepthStencilDesc r24;
	dx__RenderTargetBlendDesc r37;
	bool r5, r38;
	h3d__impl__$DirectXDriver r26;
	haxe__ds__IntMap r12;
	hl__types__ArrayBytes_Int r25;
	dx__RasterizerDesc r33;
	unsigned char r28;
	vdynamic *r11;
	h3d__mat__Stencil r8, r16;
	vbyte *r27;
	varray *r22;
	int r2, r4, r6, r7, r9, r10, r19, r20, r23;
	if( r1 == NULL ) hl_null_access();
	r2 = r1->bits;
	r4 = r1->colorMask;
	r5 = r0->hasScissor;
	if( !r5 ) goto label$2522$8;
	r7 = 536870912;
	r6 = r2 | r7;
	r2 = r6;
	label$2522$8:
	r8 = r1->stencil;
	if( !r8 ) goto label$2522$14;
	r8 = r1->stencil;
	if( r8 == NULL ) hl_null_access();
	r6 = r8->opBits;
	goto label$2522$15;
	label$2522$14:
	r6 = -1;
	label$2522$15:
	r8 = r1->stencil;
	if( !r8 ) goto label$2522$21;
	r8 = r1->stencil;
	if( r8 == NULL ) hl_null_access();
	r7 = r8->maskBits;
	goto label$2522$22;
	label$2522$21:
	r7 = -1;
	label$2522$22:
	r10 = r0->currentMaterialBits;
	if( r2 != r10 ) goto label$2522$31;
	r10 = r0->currentStencilOpBits;
	if( r6 != r10 ) goto label$2522$31;
	r10 = r0->currentStencilMaskBits;
	if( r7 != r10 ) goto label$2522$31;
	r10 = r0->currentColorMask;
	if( r4 != r10 ) goto label$2522$31;
	return;
	label$2522$31:
	r0->currentMaterialBits = r2;
	r0->currentStencilOpBits = r6;
	r0->currentStencilMaskBits = r7;
	r0->currentColorMask = r4;
	r10 = 60;
	r9 = r2 & r10;
	r12 = r0->depthStates;
	if( r12 == NULL ) hl_null_access();
	r11 = haxe_ds_IntMap_get(r12,r9);
	r13 = hl_to_virtual(&type$2101,(vdynamic*)r11);
	r14 = NULL;
	r8 = r1->stencil;
	if( !r13 ) goto label$2522$78;
	if( r8 ) goto label$2522$49;
	if( r13 == NULL ) hl_null_access();
	r17 = hl_vfields(r13)[0] ? (*(dx_pointer**)(hl_vfields(r13)[0])) : (dx_pointer*)hl_dyn_getp(r13->value,4995525/*def*/,&type$53);
	r14 = r17;
	goto label$2522$78;
	label$2522$49:
	r10 = 0;
	if( r13 == NULL ) hl_null_access();
	r18 = hl_vfields(r13)[1] ? (*(hl__types__ArrayObj*)(hl_vfields(r13)[1])) : (hl__types__ArrayObj)hl_dyn_getp(r13->value,-482181784/*stencils*/,&type$46);
	label$2522$52:
	if( r18 == NULL ) hl_null_access();
	r20 = r18->length;
	if( r10 >= r20 ) goto label$2522$78;
	r20 = r18->length;
	if( ((unsigned)r10) < ((unsigned)r20) ) goto label$2522$60;
	r21 = NULL;
	goto label$2522$63;
	label$2522$60:
	r22 = r18->array;
	r11 = ((vdynamic**)(r22 + 1))[r10];
	r21 = hl_to_virtual(&type$2103,(vdynamic*)r11);
	label$2522$63:
	++r10;
	if( r21 == NULL ) hl_null_access();
	r19 = hl_vfields(r21)[1] ? (*(int*)(hl_vfields(r21)[1])) : (int)hl_dyn_geti(r21->value,24865/*op*/,&type$3);
	if( r8 == NULL ) hl_null_access();
	r20 = r8->opBits;
	if( r19 != r20 ) goto label$2522$77;
	r19 = hl_vfields(r21)[0] ? (*(int*)(hl_vfields(r21)[0])) : (int)hl_dyn_geti(r21->value,139870710/*mask*/,&type$3);
	r20 = r8->maskBits;
	r23 = -16711681;
	r20 = r20 & r23;
	if( r19 != r20 ) goto label$2522$77;
	r17 = hl_vfields(r21)[2] ? (*(dx_pointer**)(hl_vfields(r21)[2])) : (dx_pointer*)hl_dyn_getp(r21->value,-469011326/*state*/,&type$53);
	r14 = r17;
	goto label$2522$78;
	label$2522$77:
	goto label$2522$52;
	label$2522$78:
	if( r14 ) goto label$2522$280;
	r19 = 3;
	r10 = r2 >> r19;
	r19 = 7;
	r10 = r10 & r19;
	r24 = (dx__DepthStencilDesc)hl_alloc_obj(dx__DepthStencilDesc__val);
	dx_DepthStencilDesc_new(r24);
	r20 = 0;
	if( r10 != r20 ) goto label$2522$89;
	r5 = false;
	goto label$2522$90;
	label$2522$89:
	r5 = true;
	label$2522$90:
	r19 = dx__Driver_DxBool_Impl__fromBool(r5);
	r24->depthEnable = r19;
	r26 = (h3d__impl__$DirectXDriver)global$461;
	r25 = r26->COMPARE;
	if( r25 == NULL ) hl_null_access();
	r20 = r25->length;
	if( ((unsigned)r10) < ((unsigned)r20) ) goto label$2522$99;
	r19 = 0;
	goto label$2522$103;
	label$2522$99:
	r27 = r25->bytes;
	r20 = 2;
	r20 = r10 << r20;
	r19 = *(int*)(r27 + r20);
	label$2522$103:
	r24->depthFunc = r19;
	r20 = 2;
	r19 = r2 >> r20;
	r20 = 1;
	r19 = r19 & r20;
	r20 = 0;
	if( r19 != r20 ) goto label$2522$112;
	r5 = false;
	goto label$2522$113;
	label$2522$112:
	r5 = true;
	label$2522$113:
	r19 = dx__Driver_DxBool_Impl__fromBool(r5);
	r24->depthWrite = r19;
	if( !r8 ) goto label$2522$246;
	r5 = true;
	r19 = dx__Driver_DxBool_Impl__fromBool(r5);
	r24->stencilEnable = r19;
	if( r8 == NULL ) hl_null_access();
	r19 = r8->readMask;
	r28 = (int)r19;
	r24->stencilReadMask = r28;
	r19 = r8->writeMask;
	r28 = (int)r19;
	r24->stencilWriteMask = r28;
	r26 = (h3d__impl__$DirectXDriver)global$461;
	r25 = r26->COMPARE;
	if( r25 == NULL ) hl_null_access();
	r29 = r8->frontTest;
	if( r29 == NULL ) hl_null_access();
	r19 = HL__ENUM_INDEX__(r29);
	r20 = r25->length;
	if( ((unsigned)r19) < ((unsigned)r20) ) goto label$2522$136;
	r19 = 0;
	goto label$2522$140;
	label$2522$136:
	r27 = r25->bytes;
	r20 = 2;
	r20 = r19 << r20;
	r19 = *(int*)(r27 + r20);
	label$2522$140:
	r24->frontFaceFunc = r19;
	r26 = (h3d__impl__$DirectXDriver)global$461;
	r25 = r26->STENCIL_OP;
	if( r25 == NULL ) hl_null_access();
	r30 = r8->frontPass;
	if( r30 == NULL ) hl_null_access();
	r19 = HL__ENUM_INDEX__(r30);
	r20 = r25->length;
	if( ((unsigned)r19) < ((unsigned)r20) ) goto label$2522$151;
	r19 = 0;
	goto label$2522$155;
	label$2522$151:
	r27 = r25->bytes;
	r20 = 2;
	r20 = r19 << r20;
	r19 = *(int*)(r27 + r20);
	label$2522$155:
	r24->frontFacePass = r19;
	r26 = (h3d__impl__$DirectXDriver)global$461;
	r25 = r26->STENCIL_OP;
	if( r25 == NULL ) hl_null_access();
	r30 = r8->frontSTfail;
	if( r30 == NULL ) hl_null_access();
	r19 = HL__ENUM_INDEX__(r30);
	r20 = r25->length;
	if( ((unsigned)r19) < ((unsigned)r20) ) goto label$2522$166;
	r19 = 0;
	goto label$2522$170;
	label$2522$166:
	r27 = r25->bytes;
	r20 = 2;
	r20 = r19 << r20;
	r19 = *(int*)(r27 + r20);
	label$2522$170:
	r24->frontFaceFail = r19;
	r26 = (h3d__impl__$DirectXDriver)global$461;
	r25 = r26->STENCIL_OP;
	if( r25 == NULL ) hl_null_access();
	r30 = r8->frontDPfail;
	if( r30 == NULL ) hl_null_access();
	r19 = HL__ENUM_INDEX__(r30);
	r20 = r25->length;
	if( ((unsigned)r19) < ((unsigned)r20) ) goto label$2522$181;
	r19 = 0;
	goto label$2522$185;
	label$2522$181:
	r27 = r25->bytes;
	r20 = 2;
	r20 = r19 << r20;
	r19 = *(int*)(r27 + r20);
	label$2522$185:
	r24->frontFaceDepthFail = r19;
	r26 = (h3d__impl__$DirectXDriver)global$461;
	r25 = r26->COMPARE;
	if( r25 == NULL ) hl_null_access();
	r29 = r8->backTest;
	if( r29 == NULL ) hl_null_access();
	r19 = HL__ENUM_INDEX__(r29);
	r20 = r25->length;
	if( ((unsigned)r19) < ((unsigned)r20) ) goto label$2522$196;
	r19 = 0;
	goto label$2522$200;
	label$2522$196:
	r27 = r25->bytes;
	r20 = 2;
	r20 = r19 << r20;
	r19 = *(int*)(r27 + r20);
	label$2522$200:
	r24->backFaceFunc = r19;
	r26 = (h3d__impl__$DirectXDriver)global$461;
	r25 = r26->STENCIL_OP;
	if( r25 == NULL ) hl_null_access();
	r30 = r8->backPass;
	if( r30 == NULL ) hl_null_access();
	r19 = HL__ENUM_INDEX__(r30);
	r20 = r25->length;
	if( ((unsigned)r19) < ((unsigned)r20) ) goto label$2522$211;
	r19 = 0;
	goto label$2522$215;
	label$2522$211:
	r27 = r25->bytes;
	r20 = 2;
	r20 = r19 << r20;
	r19 = *(int*)(r27 + r20);
	label$2522$215:
	r24->backFacePass = r19;
	r26 = (h3d__impl__$DirectXDriver)global$461;
	r25 = r26->STENCIL_OP;
	if( r25 == NULL ) hl_null_access();
	r30 = r8->backSTfail;
	if( r30 == NULL ) hl_null_access();
	r19 = HL__ENUM_INDEX__(r30);
	r20 = r25->length;
	if( ((unsigned)r19) < ((unsigned)r20) ) goto label$2522$226;
	r19 = 0;
	goto label$2522$230;
	label$2522$226:
	r27 = r25->bytes;
	r20 = 2;
	r20 = r19 << r20;
	r19 = *(int*)(r27 + r20);
	label$2522$230:
	r24->backFaceFail = r19;
	r26 = (h3d__impl__$DirectXDriver)global$461;
	r25 = r26->STENCIL_OP;
	if( r25 == NULL ) hl_null_access();
	r30 = r8->backDPfail;
	if( r30 == NULL ) hl_null_access();
	r19 = HL__ENUM_INDEX__(r30);
	r20 = r25->length;
	if( ((unsigned)r19) < ((unsigned)r20) ) goto label$2522$241;
	r19 = 0;
	goto label$2522$245;
	label$2522$241:
	r27 = r25->bytes;
	r20 = 2;
	r20 = r19 << r20;
	r19 = *(int*)(r27 + r20);
	label$2522$245:
	r24->backFaceDepthFail = r19;
	label$2522$246:
	r17 = dx_Driver_createDepthStencilState(r24);
	r14 = r17;
	if( r13 ) goto label$2522$261;
	r15 = hl_alloc_virtual(&type$2101);
	r17 = NULL;
	if( hl_vfields(r15)[0] ) *(dx_pointer**)(hl_vfields(r15)[0]) = (dx_pointer*)r17; else hl_dyn_setp(r15->value,4995525/*def*/,&type$53,r17);
	r31 = &type$2103;
	r19 = 0;
	r22 = hl_alloc_array(r31,r19);
	r18 = hl_types_ArrayObj_alloc(r22);
	if( hl_vfields(r15)[1] ) *(hl__types__ArrayObj*)(hl_vfields(r15)[1]) = (hl__types__ArrayObj)r18; else hl_dyn_setp(r15->value,-482181784/*stencils*/,&type$46,r18);
	r13 = r15;
	r12 = r0->depthStates;
	if( r12 == NULL ) hl_null_access();
	haxe_ds_IntMap_set(r12,r9,((vdynamic*)r15));
	label$2522$261:
	if( r1 == NULL ) hl_null_access();
	r16 = r1->stencil;
	if( r16 ) goto label$2522$267;
	if( r13 == NULL ) hl_null_access();
	if( hl_vfields(r13)[0] ) *(dx_pointer**)(hl_vfields(r13)[0]) = (dx_pointer*)r14; else hl_dyn_setp(r13->value,4995525/*def*/,&type$53,r14);
	goto label$2522$280;
	label$2522$267:
	if( r13 == NULL ) hl_null_access();
	r18 = hl_vfields(r13)[1] ? (*(hl__types__ArrayObj*)(hl_vfields(r13)[1])) : (hl__types__ArrayObj)hl_dyn_getp(r13->value,-482181784/*stencils*/,&type$46);
	if( r18 == NULL ) hl_null_access();
	r21 = hl_alloc_virtual(&type$2103);
	if( r8 == NULL ) hl_null_access();
	r19 = r8->opBits;
	if( hl_vfields(r21)[1] ) *(int*)(hl_vfields(r21)[1]) = (int)r19; else hl_dyn_seti(r21->value,24865/*op*/,&type$3,r19);
	r19 = r8->maskBits;
	r20 = -16711681;
	r19 = r19 & r20;
	if( hl_vfields(r21)[0] ) *(int*)(hl_vfields(r21)[0]) = (int)r19; else hl_dyn_seti(r21->value,139870710/*mask*/,&type$3,r19);
	if( hl_vfields(r21)[2] ) *(dx_pointer**)(hl_vfields(r21)[2]) = (dx_pointer*)r14; else hl_dyn_setp(r21->value,-469011326/*state*/,&type$53,r14);
	r19 = hl_types_ArrayObj_push(r18,((vdynamic*)r21));
	label$2522$280:
	r32 = r0->currentDepthState;
	if( r14 != r32 ) goto label$2522$287;
	if( !r8 ) goto label$2522$295;
	if( r8 == NULL ) hl_null_access();
	r10 = r8->reference;
	r19 = r0->currentStencilRef;
	if( r10 == r19 ) goto label$2522$295;
	label$2522$287:
	if( r8 ) goto label$2522$290;
	r10 = 0;
	goto label$2522$292;
	label$2522$290:
	if( r8 == NULL ) hl_null_access();
	r10 = r8->reference;
	label$2522$292:
	r0->currentDepthState = r14;
	r0->currentStencilRef = r10;
	directx_om_set_depth_stencil_state(r14,r10);
	label$2522$295:
	r19 = 805306371;
	r10 = r2 & r19;
	r12 = r0->rasterStates;
	if( r12 == NULL ) hl_null_access();
	r11 = haxe_ds_IntMap_get(r12,r10);
	r17 = (dx_pointer*)hl_dyn_castp(&r11,&type$9,&type$53);
	if( r17 ) goto label$2522$346;
	r33 = (dx__RasterizerDesc)hl_alloc_obj(dx__RasterizerDesc__val);
	dx_RasterizerDesc_new(r33);
	if( r1 == NULL ) hl_null_access();
	r5 = r1->wireframe;
	if( !r5 ) goto label$2522$312;
	r19 = 2;
	r33->fillMode = r19;
	r19 = 1;
	r33->cullMode = r19;
	goto label$2522$328;
	label$2522$312:
	r19 = 3;
	r33->fillMode = r19;
	r26 = (h3d__impl__$DirectXDriver)global$461;
	r25 = r26->CULL;
	if( r25 == NULL ) hl_null_access();
	r20 = 3;
	r19 = r2 & r20;
	r20 = r25->length;
	if( ((unsigned)r19) < ((unsigned)r20) ) goto label$2522$323;
	r19 = 0;
	goto label$2522$327;
	label$2522$323:
	r27 = r25->bytes;
	r20 = 2;
	r20 = r19 << r20;
	r19 = *(int*)(r27 + r20);
	label$2522$327:
	r33->cullMode = r19;
	label$2522$328:
	r5 = true;
	r19 = dx__Driver_DxBool_Impl__fromBool(r5);
	r33->depthClipEnable = r19;
	r20 = 536870912;
	r19 = r2 & r20;
	r20 = 0;
	if( r19 != r20 ) goto label$2522$337;
	r5 = false;
	goto label$2522$338;
	label$2522$337:
	r5 = true;
	label$2522$338:
	r19 = dx__Driver_DxBool_Impl__fromBool(r5);
	r33->scissorEnable = r19;
	r32 = dx_Driver_createRasterizerState(r33);
	r17 = r32;
	r12 = r0->rasterStates;
	if( r12 == NULL ) hl_null_access();
	if( r32 == NULL ) r11 = NULL; else {
		r11 = hl_alloc_dynamic(&type$53);
		r11->v.ptr = r32;
	}
	haxe_ds_IntMap_set(r12,r10,r11);
	label$2522$346:
	if( r1 == NULL ) hl_null_access();
	r34 = r1->culling;
	r35 = (venum*)global$518;
	if( r34 != r35 ) goto label$2522$352;
	r5 = false;
	goto label$2522$353;
	label$2522$352:
	r5 = true;
	label$2522$353:
	r0->allowDraw = r5;
	r36 = r0->currentRasterState;
	if( r17 == r36 ) goto label$2522$358;
	r0->currentRasterState = r17;
	directx_rs_set_state(r17);
	label$2522$358:
	r20 = 268435392;
	r19 = r2 & r20;
	r19 = r19 | r4;
	r12 = r0->blendStates;
	if( r12 == NULL ) hl_null_access();
	r11 = haxe_ds_IntMap_get(r12,r19);
	r32 = (dx_pointer*)hl_dyn_castp(&r11,&type$9,&type$53);
	if( r32 ) goto label$2522$504;
	r37 = (dx__RenderTargetBlendDesc)hl_alloc_obj(dx__RenderTargetBlendDesc__val);
	dx_RenderTargetBlendDesc_new(r37);
	r26 = (h3d__impl__$DirectXDriver)global$461;
	r25 = r26->BLEND;
	if( r25 == NULL ) hl_null_access();
	r23 = 6;
	r20 = r2 >> r23;
	r23 = 15;
	r20 = r20 & r23;
	r23 = r25->length;
	if( ((unsigned)r20) < ((unsigned)r23) ) goto label$2522$379;
	r20 = 0;
	goto label$2522$383;
	label$2522$379:
	r27 = r25->bytes;
	r23 = 2;
	r23 = r20 << r23;
	r20 = *(int*)(r27 + r23);
	label$2522$383:
	r37->srcBlend = r20;
	r26 = (h3d__impl__$DirectXDriver)global$461;
	r25 = r26->BLEND;
	if( r25 == NULL ) hl_null_access();
	r23 = 10;
	r20 = r2 >> r23;
	r23 = 15;
	r20 = r20 & r23;
	r23 = r25->length;
	if( ((unsigned)r20) < ((unsigned)r23) ) goto label$2522$395;
	r20 = 0;
	goto label$2522$399;
	label$2522$395:
	r27 = r25->bytes;
	r23 = 2;
	r23 = r20 << r23;
	r20 = *(int*)(r27 + r23);
	label$2522$399:
	r37->destBlend = r20;
	r26 = (h3d__impl__$DirectXDriver)global$461;
	r25 = r26->BLEND_ALPHA;
	if( r25 == NULL ) hl_null_access();
	r23 = 14;
	r20 = r2 >> r23;
	r23 = 15;
	r20 = r20 & r23;
	r23 = r25->length;
	if( ((unsigned)r20) < ((unsigned)r23) ) goto label$2522$411;
	r20 = 0;
	goto label$2522$415;
	label$2522$411:
	r27 = r25->bytes;
	r23 = 2;
	r23 = r20 << r23;
	r20 = *(int*)(r27 + r23);
	label$2522$415:
	r37->srcBlendAlpha = r20;
	r26 = (h3d__impl__$DirectXDriver)global$461;
	r25 = r26->BLEND_ALPHA;
	if( r25 == NULL ) hl_null_access();
	r23 = 18;
	r20 = r2 >> r23;
	r23 = 15;
	r20 = r20 & r23;
	r23 = r25->length;
	if( ((unsigned)r20) < ((unsigned)r23) ) goto label$2522$427;
	r20 = 0;
	goto label$2522$431;
	label$2522$427:
	r27 = r25->bytes;
	r23 = 2;
	r23 = r20 << r23;
	r20 = *(int*)(r27 + r23);
	label$2522$431:
	r37->destBlendAlpha = r20;
	r26 = (h3d__impl__$DirectXDriver)global$461;
	r25 = r26->BLEND_OP;
	if( r25 == NULL ) hl_null_access();
	r23 = 22;
	r20 = r2 >> r23;
	r23 = 7;
	r20 = r20 & r23;
	r23 = r25->length;
	if( ((unsigned)r20) < ((unsigned)r23) ) goto label$2522$443;
	r20 = 0;
	goto label$2522$447;
	label$2522$443:
	r27 = r25->bytes;
	r23 = 2;
	r23 = r20 << r23;
	r20 = *(int*)(r27 + r23);
	label$2522$447:
	r37->blendOp = r20;
	r26 = (h3d__impl__$DirectXDriver)global$461;
	r25 = r26->BLEND_OP;
	if( r25 == NULL ) hl_null_access();
	r23 = 25;
	r20 = r2 >> r23;
	r23 = 7;
	r20 = r20 & r23;
	r23 = r25->length;
	if( ((unsigned)r20) < ((unsigned)r23) ) goto label$2522$459;
	r20 = 0;
	goto label$2522$463;
	label$2522$459:
	r27 = r25->bytes;
	r23 = 2;
	r23 = r20 << r23;
	r20 = *(int*)(r27 + r23);
	label$2522$463:
	r37->blendOpAlpha = r20;
	r28 = (int)r4;
	r37->renderTargetWriteMask = r28;
	r20 = r37->srcBlend;
	r23 = 2;
	if( r20 != r23 ) goto label$2522$486;
	r20 = r37->srcBlendAlpha;
	r23 = 2;
	if( r20 != r23 ) goto label$2522$486;
	r20 = r37->destBlend;
	r23 = 1;
	if( r20 != r23 ) goto label$2522$486;
	r20 = r37->destBlendAlpha;
	r23 = 1;
	if( r20 != r23 ) goto label$2522$486;
	r20 = r37->blendOp;
	r23 = 1;
	if( r20 != r23 ) goto label$2522$486;
	r20 = r37->blendOpAlpha;
	r23 = 1;
	if( r20 != r23 ) goto label$2522$486;
	r5 = true;
	goto label$2522$487;
	label$2522$486:
	r5 = false;
	label$2522$487:
	r5 = !r5;
	r20 = dx__Driver_DxBool_Impl__fromBool(r5);
	r37->blendEnable = r20;
	r20 = 1;
	r31 = &type$1393;
	r22 = hl_alloc_array(r31,r20);
	r20 = 0;
	((dx__RenderTargetBlendDesc*)(r22 + 1))[r20] = r37;
	r5 = false;
	r38 = false;
	r20 = 1;
	r36 = directx_create_blend_state(r5,r38,r22,r20);
	r32 = r36;
	r12 = r0->blendStates;
	if( r12 == NULL ) hl_null_access();
	if( r36 == NULL ) r11 = NULL; else {
		r11 = hl_alloc_dynamic(&type$53);
		r11->v.ptr = r36;
	}
	haxe_ds_IntMap_set(r12,r19,r11);
	label$2522$504:
	r39 = r0->currentBlendState;
	if( r32 == r39 ) goto label$2522$510;
	r0->currentBlendState = r32;
	r27 = r0->blendFactors;
	r20 = -1;
	directx_om_set_blend_state(r32,r27,r20);
	label$2522$510:
	return;
}

haxe__io__Bytes h3d_impl_DirectXDriver_getBinaryPayload(h3d__impl__DirectXDriver r0,String r1) {
	bool *r11;
	String r3, r4;
	haxe__io__Bytes r8;
	vdynamic *r5;
	int r2, r6, r7, r9, r10;
	if( r1 == NULL ) hl_null_access();
	r4 = (String)global$519;
	r5 = NULL;
	r2 = String_indexOf(r1,r4,r5);
	r7 = 0;
	if( r2 >= r7 ) goto label$2523$8;
	r8 = NULL;
	return r8;
	label$2523$8:
	r4 = (String)global$520;
	r5 = hl_alloc_dynamic(&type$3);
	r5->v.i = r2;
	r6 = String_indexOf(r1,r4,r5);
	r9 = 0;
	if( r6 >= r9 ) goto label$2523$15;
	r8 = NULL;
	return r8;
	label$2523$15:
	r9 = 6;
	r7 = r2 + r9;
	r9 = r6 - r2;
	r10 = 6;
	r9 = r9 - r10;
	r5 = hl_alloc_dynamic(&type$3);
	r5->v.i = r9;
	r3 = String_substr(r1,r7,r5);
	r11 = NULL;
	r8 = haxe_crypto_Base64_decode(r3,r11);
	return r8;
}

String h3d_impl_DirectXDriver_addBinaryPayload(h3d__impl__DirectXDriver r0,haxe__io__Bytes r1) {
	bool *r4;
	String r2, r3;
	r2 = (String)global$521;
	r4 = NULL;
	r3 = haxe_crypto_Base64_encode(r1,r4);
	r2 = String___add__(r2,r3);
	r3 = (String)global$522;
	r2 = String___add__(r2,r3);
	return r2;
}

vvirtual* h3d_impl_DirectXDriver_compileShader(h3d__impl__DirectXDriver r0,hxsl__RuntimeShaderData r1,bool* r2) {
	$String r18;
	String r6, r12, r13, r14, r16;
	dx_pointer *r23;
	hl__types__ArrayObj r8;
	vvirtual *r7, *r21;
	haxe__io__Bytes r9, r10;
	bool r3, r15;
	dx_resource *r27;
	EReg r19;
	hxsl__HlslOut r4;
	h3d__impl___DirectXDriver__ShaderContext r22;
	vclosure *r20;
	vdynamic *r11;
	vbyte *r24;
	int r17, r25, r26, r28, r29, r30;
	hl_trap_ctx trap$0;
	if( r2 ) goto label$2525$3;
	r3 = false;
	goto label$2525$4;
	label$2525$3:
	r3 = *r2;
	label$2525$4:
	r4 = (hxsl__HlslOut)hl_alloc_obj(hxsl__HlslOut__val);
	hxsl_HlslOut_new(r4);
	if( r1 == NULL ) hl_null_access();
	r6 = r1->code;
	if( r6 ) goto label$2525$16;
	r7 = r1->data;
	r6 = hxsl_HlslOut_run(r4,r7);
	r1->code = r6;
	r7 = r1->data;
	if( r7 == NULL ) hl_null_access();
	r8 = NULL;
	if( hl_vfields(r7)[0] ) *(hl__types__ArrayObj*)(hl_vfields(r7)[0]) = (hl__types__ArrayObj)r8; else hl_dyn_setp(r7->value,63237214/*funs*/,&type$46,r8);
	label$2525$16:
	r6 = r1->code;
	r9 = h3d_impl_DirectXDriver_getBinaryPayload(r0,r6);
	if( r9 ) goto label$2525$59;
	hl_trap(trap$0,r11,label$2525$35);
	r6 = r1->code;
	r12 = (String)global$8;
	r13 = (String)global$151;
	r15 = r1->vertex;
	if( !r15 ) goto label$2525$27;
	r14 = (String)global$527;
	goto label$2525$28;
	label$2525$27:
	r14 = (String)global$528;
	label$2525$28:
	r16 = r0->shaderVersion;
	r14 = String___add__(r14,r16);
	r17 = 32768;
	r10 = dx_Driver_compileShader(r6,r12,r13,r14,r17);
	r9 = r10;
	hl_endtrap(trap$0);
	goto label$2525$55;
	label$2525$35:
	r18 = ($String)global$1;
	r15 = hl_BaseType_check(((hl__BaseType)r18),r11);
	if( !r15 ) goto label$2525$54;
	r12 = (String)r11;
	r6 = r12;
	r19 = (EReg)hl_alloc_obj(EReg__val);
	r12 = (String)global$529;
	r13 = (String)global$530;
	EReg_new(r19,r12,r13);
	r20 = hl_alloc_closure_ptr(&type$2137,fun$2685,r1);
	r12 = EReg_map(r19,r6,r20);
	r6 = r12;
	r12 = (String)global$533;
	r12 = String___add__(r12,r6);
	r13 = (String)global$534;
	r12 = String___add__(r12,r13);
	r13 = r1->code;
	r12 = String___add__(r12,r13);
	hl_throw((vdynamic*)r12);
	label$2525$54:
	hl_rethrow((vdynamic*)r11);
	label$2525$55:
	r12 = r1->code;
	r13 = h3d_impl_DirectXDriver_addBinaryPayload(r0,r10);
	r12 = String___add__(r12,r13);
	r1->code = r12;
	label$2525$59:
	if( !r3 ) goto label$2525$65;
	r21 = hl_alloc_virtual(&type$2139);
	r22 = NULL;
	if( hl_vfields(r21)[1] ) *(h3d__impl___DirectXDriver__ShaderContext*)(hl_vfields(r21)[1]) = (h3d__impl___DirectXDriver__ShaderContext)r22; else hl_dyn_setp(r21->value,115/*s*/,&type$1760,r22);
	if( hl_vfields(r21)[0] ) *(haxe__io__Bytes*)(hl_vfields(r21)[0]) = (haxe__io__Bytes)r9; else hl_dyn_setp(r21->value,-40368287/*bytes*/,&type$75,r9);
	return r21;
	label$2525$65:
	r15 = r1->vertex;
	if( !r15 ) goto label$2525$69;
	r23 = dx_Driver_createVertexShader(r9);
	goto label$2525$70;
	label$2525$69:
	r23 = dx_Driver_createPixelShader(r9);
	label$2525$70:
	if( r23 ) goto label$2525$79;
	r15 = r0->hasDeviceError;
	if( !r15 ) goto label$2525$75;
	r21 = NULL;
	return r21;
	label$2525$75:
	r6 = (String)global$535;
	r12 = r1->code;
	r6 = String___add__(r6,r12);
	hl_throw((vdynamic*)r6);
	label$2525$79:
	r22 = (h3d__impl___DirectXDriver__ShaderContext)hl_alloc_obj(h3d__impl___DirectXDriver__ShaderContext__val);
	h3d_impl__DirectXDriver_ShaderContext_new(r22,r23);
	r17 = r1->globalsSize;
	r22->globalsSize = r17;
	r17 = r1->paramsSize;
	r22->paramsSize = r17;
	r17 = r1->paramsSize;
	r25 = 16;
	r17 = r17 * r25;
	r24 = hl_alloc_bytes(r17);
	r22->paramsContent = r24;
	r24 = r22->paramsContent;
	r17 = 0;
	r25 = r1->paramsSize;
	r26 = 16;
	r25 = r25 * r26;
	r26 = 221;
	hl_bytes_fill(r24,r17,r25,r26);
	r17 = r1->texturesCount;
	r22->texturesCount = r17;
	r17 = r1->bufferCount;
	r22->bufferCount = r17;
	r17 = r1->globalsSize;
	r25 = 16;
	r17 = r17 * r25;
	r25 = 2;
	r26 = 4;
	r28 = 65536;
	r29 = 0;
	r30 = 0;
	r24 = NULL;
	r27 = directx_create_buffer(r17,r25,r26,r28,r29,r30,r24);
	r22->globals = r27;
	r17 = r1->paramsSize;
	r25 = 16;
	r17 = r17 * r25;
	r25 = 2;
	r26 = 4;
	r28 = 65536;
	r29 = 0;
	r30 = 0;
	r24 = NULL;
	r27 = directx_create_buffer(r17,r25,r26,r28,r29,r30,r24);
	r22->params = r27;
	r21 = hl_alloc_virtual(&type$2139);
	if( hl_vfields(r21)[1] ) *(h3d__impl___DirectXDriver__ShaderContext*)(hl_vfields(r21)[1]) = (h3d__impl___DirectXDriver__ShaderContext)r22; else hl_dyn_setp(r21->value,115/*s*/,&type$1760,r22);
	if( hl_vfields(r21)[0] ) *(haxe__io__Bytes*)(hl_vfields(r21)[0]) = (haxe__io__Bytes)r9; else hl_dyn_setp(r21->value,-40368287/*bytes*/,&type$75,r9);
	return r21;
}

String h3d_impl_DirectXDriver_getNativeShaderCode(h3d__impl__DirectXDriver r0,hxsl__RuntimeShader r1) {
	String r9, r11;
	bool *r6;
	vvirtual *r3;
	hxsl__RuntimeShaderData r4;
	bool r5, r8;
	haxe__io__Bytes r2, r7;
	int r10;
	if( r1 == NULL ) hl_null_access();
	r4 = r1->vertex;
	r5 = true;
	r6 = &r5;
	r3 = h3d_impl_DirectXDriver_compileShader(r0,r4,r6);
	if( r3 == NULL ) hl_null_access();
	r2 = hl_vfields(r3)[0] ? (*(haxe__io__Bytes*)(hl_vfields(r3)[0])) : (haxe__io__Bytes)hl_dyn_getp(r3->value,-40368287/*bytes*/,&type$75);
	r4 = r1->fragment;
	r8 = true;
	r6 = &r8;
	r3 = h3d_impl_DirectXDriver_compileShader(r0,r4,r6);
	if( r3 == NULL ) hl_null_access();
	r7 = hl_vfields(r3)[0] ? (*(haxe__io__Bytes*)(hl_vfields(r3)[0])) : (haxe__io__Bytes)hl_dyn_getp(r3->value,-40368287/*bytes*/,&type$75);
	r10 = 0;
	r9 = NULL;
	r9 = dx_Driver_disassembleShader(r2,r10,r9);
	r11 = (String)global$205;
	r9 = String___add__(r9,r11);
	r10 = 0;
	r11 = NULL;
	r11 = dx_Driver_disassembleShader(r7,r10,r11);
	r9 = String___add__(r9,r11);
	return r9;
}

bool h3d_impl_DirectXDriver_hasFeature(h3d__impl__DirectXDriver r0,venum* r1) {
	bool r3;
	int r2;
	if( r1 == NULL ) hl_null_access();
	r2 = HL__ENUM_INDEX__(r1);
	switch(r2) {
		default:
		case 0:
		case 1:
		case 2:
		case 3:
		case 4:
		case 6:
		case 7:
			r3 = true;
			return r3;
		case 5:
		case 8:
			r3 = false;
			return r3;
	}
}

bool h3d_impl_DirectXDriver_copyTexture(h3d__impl__DirectXDriver r0,h3d__mat__Texture r1,h3d__mat__Texture r2) {
	vvirtual *r4;
	venum *r5, *r6;
	bool r9;
	dx_resource *r10, *r11;
	int r7, r8;
	if( r1 == NULL ) hl_null_access();
	r4 = r1->_t;
	if( !r4 ) goto label$2528$13;
	r5 = r1->format;
	if( r2 == NULL ) hl_null_access();
	r6 = r2->format;
	if( r5 != r6 ) goto label$2528$13;
	r7 = r1->width;
	r8 = r2->width;
	if( r7 != r8 ) goto label$2528$13;
	r7 = r1->height;
	r8 = r2->height;
	if( r7 == r8 ) goto label$2528$15;
	label$2528$13:
	r9 = false;
	return r9;
	label$2528$15:
	r4 = r2->_t;
	if( r4 ) goto label$2528$18;
	h3d_mat_Texture_alloc(r2);
	label$2528$18:
	r4 = r2->_t;
	if( r4 == NULL ) hl_null_access();
	r10 = hl_vfields(r4)[1] ? (*(dx_resource**)(hl_vfields(r4)[1])) : (dx_resource*)hl_dyn_getp(r4->value,5691744/*res*/,&type$52);
	r4 = r1->_t;
	if( r4 == NULL ) hl_null_access();
	r11 = hl_vfields(r4)[1] ? (*(dx_resource**)(hl_vfields(r4)[1])) : (dx_resource*)hl_dyn_getp(r4->value,5691744/*res*/,&type$52);
	directx_copy_resource(r10,r11);
	r7 = r2->flags;
	r8 = 256;
	r7 = r7 | r8;
	r2->flags = r7;
	r9 = true;
	return r9;
}

void h3d_impl_DirectXDriver_setRenderTarget(h3d__impl__DirectXDriver r0,h3d__mat__Texture r1,int* r2,int* r3) {
	hl__types__ArrayObj r17;
	dx_pointer *r10;
	vvirtual *r8;
	float r14;
	double r16;
	dx_pointer **r12;
	vbyte *r13;
	varray *r9;
	h3d__mat__Texture r7;
	int r4, r5, r11, r15;
	if( r2 ) goto label$2529$3;
	r4 = 0;
	goto label$2529$4;
	label$2529$3:
	r4 = *r2;
	label$2529$4:
	if( r3 ) goto label$2529$7;
	r5 = 0;
	goto label$2529$8;
	label$2529$7:
	r5 = *r3;
	label$2529$8:
	if( r1 ) goto label$2529$51;
	r7 = NULL;
	r0->curTexture = r7;
	r8 = r0->defaultDepth;
	r0->currentDepth = r8;
	r9 = r0->currentTargets;
	r10 = r0->defaultTarget;
	r11 = 0;
	((dx_pointer**)(r9 + 1))[r11] = r10;
	r11 = 1;
	r0->targetsCount = r11;
	r9 = r0->currentTargets;
	r11 = 1;
	r12 = (dx_pointer**)hl_aptr(r9,void*);
	r8 = r0->currentDepth;
	if( r8 == NULL ) hl_null_access();
	r10 = hl_vfields(r8)[1] ? (*(dx_pointer**)(hl_vfields(r8)[1])) : (dx_pointer*)hl_dyn_getp(r8->value,240071535/*view*/,&type$53);
	directx_om_set_render_targets(r11,r12,r10);
	r13 = r0->viewport;
	r11 = r0->outputWidth;
	r14 = (float)r11;
	r11 = 2;
	r15 = 2;
	r15 = r11 << r15;
	*(float*)(r13 + r15) = r14;
	r13 = r0->viewport;
	r11 = r0->outputHeight;
	r14 = (float)r11;
	r11 = 3;
	r15 = 2;
	r15 = r11 << r15;
	*(float*)(r13 + r15) = r14;
	r13 = r0->viewport;
	r11 = 5;
	r16 = 1.;
	r14 = (float)r16;
	r15 = 2;
	r15 = r11 << r15;
	*(float*)(r13 + r15) = r14;
	r11 = 1;
	r13 = r0->viewport;
	directx_rs_set_viewports(r11,r13);
	return;
	label$2529$51:
	r17 = r0->tmpTextures;
	if( r17 == NULL ) hl_null_access();
	r11 = 0;
	r15 = r17->length;
	if( ((unsigned)r11) < ((unsigned)r15) ) goto label$2529$57;
	hl_types_ArrayObj___expand(r17,r11);
	label$2529$57:
	r9 = r17->array;
	((h3d__mat__Texture*)(r9 + 1))[r11] = r1;
	r17 = r0->tmpTextures;
	h3d_impl_DirectXDriver__setRenderTargets(r0,r17,r4,r5);
	return;
}

void h3d_impl_DirectXDriver_unbind(h3d__impl__DirectXDriver r0,dx_pointer* r1) {
	dx_pointer *r9;
	h3d__impl__PipelineState r7;
	dx_pointer **r11, **r13;
	varray *r6, *r8, *r10;
	int r2, r4, r5, r12;
	r2 = 0;
	label$2530$1:
	r5 = 64;
	if( r2 >= r5 ) goto label$2530$41;
	r4 = r2;
	++r2;
	r7 = r0->vertexShader;
	if( r7 == NULL ) hl_null_access();
	r6 = r7->resources;
	r9 = ((dx_pointer**)(r6 + 1))[r4];
	if( r9 != r1 ) goto label$2530$23;
	r7 = r0->vertexShader;
	if( r7 == NULL ) hl_null_access();
	r8 = r7->resources;
	r9 = NULL;
	((dx_pointer**)(r8 + 1))[r4] = r9;
	r7 = r0->vertexShader;
	if( r7 == NULL ) hl_null_access();
	r8 = r7->resources;
	r11 = (dx_pointer**)hl_aptr(r8,void*);
	r12 = 1;
	r13 = r11 + r4;
	directx_vs_set_shader_resources(r4,r12,r13);
	label$2530$23:
	r7 = r0->pixelShader;
	if( r7 == NULL ) hl_null_access();
	r8 = r7->resources;
	r9 = ((dx_pointer**)(r8 + 1))[r4];
	if( r9 != r1 ) goto label$2530$40;
	r7 = r0->pixelShader;
	if( r7 == NULL ) hl_null_access();
	r10 = r7->resources;
	r9 = NULL;
	((dx_pointer**)(r10 + 1))[r4] = r9;
	r7 = r0->pixelShader;
	if( r7 == NULL ) hl_null_access();
	r10 = r7->resources;
	r11 = (dx_pointer**)hl_aptr(r10,void*);
	r12 = 1;
	r13 = r11 + r4;
	directx_ps_set_shader_resources(r4,r12,r13);
	label$2530$40:
	goto label$2530$1;
	label$2530$41:
	return;
}

void h3d_impl_DirectXDriver_setRenderTargets(h3d__impl__DirectXDriver r0,hl__types__ArrayObj r1) {
	int r3, r4;
	r3 = 0;
	r4 = 0;
	h3d_impl_DirectXDriver__setRenderTargets(r0,r1,r3,r4);
	return;
}

void h3d_impl_DirectXDriver__setRenderTargets(h3d__impl__DirectXDriver r0,hl__types__ArrayObj r1,int r2,int r3) {
	String r16;
	h3d__mat__DepthBuffer r15;
	dx_pointer *r23, *r24;
	vvirtual *r17, *r21;
	hl__types__ArrayObj r6;
	bool r12;
	dx_resource *r26;
	float r34;
	double r28, r29, r30, r31;
	dx__RenderTargetDesc r25;
	dx_pointer **r32;
	vdynamic *r11;
	int *r9, *r10;
	vbyte *r33;
	varray *r13;
	h3d__mat__Texture r8, r14;
	int r5, r7, r18, r19, r20, r22, r27;
	if( r1 == NULL ) hl_null_access();
	r5 = r1->length;
	r7 = 0;
	if( r5 != r7 ) goto label$2532$9;
	r8 = NULL;
	r9 = NULL;
	r10 = NULL;
	h3d_impl_DirectXDriver_setRenderTarget(r0,r8,r9,r10);
	return;
	label$2532$9:
	r12 = r0->hasDeviceError;
	if( !r12 ) goto label$2532$12;
	return;
	label$2532$12:
	r5 = 0;
	r7 = r1->length;
	if( ((unsigned)r5) < ((unsigned)r7) ) goto label$2532$17;
	r8 = NULL;
	goto label$2532$20;
	label$2532$17:
	r13 = r1->array;
	r11 = ((vdynamic**)(r13 + 1))[r5];
	r8 = (h3d__mat__Texture)r11;
	label$2532$20:
	r5 = 0;
	r7 = r1->length;
	if( ((unsigned)r5) < ((unsigned)r7) ) goto label$2532$25;
	r14 = NULL;
	goto label$2532$28;
	label$2532$25:
	r13 = r1->array;
	r11 = ((vdynamic**)(r13 + 1))[r5];
	r14 = (h3d__mat__Texture)r11;
	label$2532$28:
	r0->curTexture = r14;
	if( r8 == NULL ) hl_null_access();
	r15 = r8->depthBuffer;
	if( !r15 ) goto label$2532$44;
	r15 = r8->depthBuffer;
	if( r15 == NULL ) hl_null_access();
	r5 = r15->width;
	r7 = r8->width;
	if( r5 != r7 ) goto label$2532$42;
	r15 = r8->depthBuffer;
	if( r15 == NULL ) hl_null_access();
	r5 = r15->height;
	r7 = r8->height;
	if( r5 == r7 ) goto label$2532$44;
	label$2532$42:
	r16 = (String)global$536;
	hl_throw((vdynamic*)r16);
	label$2532$44:
	r15 = r8->depthBuffer;
	if( r15 ) goto label$2532$48;
	r17 = NULL;
	goto label$2532$51;
	label$2532$48:
	r15 = r8->depthBuffer;
	if( r15 == NULL ) hl_null_access();
	r17 = r15->b;
	label$2532$51:
	r0->currentDepth = r17;
	r5 = 0;
	r7 = r1->length;
	label$2532$54:
	if( r5 >= r7 ) goto label$2532$161;
	r18 = r5;
	++r5;
	if( r1 == NULL ) hl_null_access();
	r20 = r1->length;
	if( ((unsigned)r18) < ((unsigned)r20) ) goto label$2532$63;
	r14 = NULL;
	goto label$2532$66;
	label$2532$63:
	r13 = r1->array;
	r11 = ((vdynamic**)(r13 + 1))[r18];
	r14 = (h3d__mat__Texture)r11;
	label$2532$66:
	if( r14 == NULL ) hl_null_access();
	r21 = r14->_t;
	if( r21 ) goto label$2532$73;
	h3d_mat_Texture_alloc(r14);
	r12 = r0->hasDeviceError;
	if( !r12 ) goto label$2532$73;
	return;
	label$2532$73:
	r21 = r14->_t;
	if( r21 == NULL ) hl_null_access();
	r6 = hl_vfields(r21)[2] ? (*(hl__types__ArrayObj*)(hl_vfields(r21)[2])) : (hl__types__ArrayObj)hl_dyn_getp(r21->value,25538/*rt*/,&type$46);
	if( r6 ) goto label$2532$79;
	r16 = (String)global$537;
	hl_throw((vdynamic*)r16);
	label$2532$79:
	r20 = ((int (*)(h3d__mat__Texture))r14->$type->vobj_proto[0])(r14);
	r19 = r3 * r20;
	r19 = r19 + r2;
	r21 = r14->_t;
	if( r21 == NULL ) hl_null_access();
	r6 = hl_vfields(r21)[2] ? (*(hl__types__ArrayObj*)(hl_vfields(r21)[2])) : (hl__types__ArrayObj)hl_dyn_getp(r21->value,25538/*rt*/,&type$46);
	if( r6 == NULL ) hl_null_access();
	r22 = r6->length;
	if( ((unsigned)r19) < ((unsigned)r22) ) goto label$2532$90;
	r23 = NULL;
	goto label$2532$93;
	label$2532$90:
	r13 = r6->array;
	r11 = ((vdynamic**)(r13 + 1))[r19];
	r23 = (dx_pointer*)hl_dyn_castp(&r11,&type$9,&type$53);
	label$2532$93:
	if( r23 ) goto label$2532$134;
	r20 = r14->flags;
	r22 = 2;
	r20 = r20 & r22;
	r22 = 0;
	if( r20 != r22 ) goto label$2532$106;
	r20 = r14->flags;
	r22 = 2048;
	r20 = r20 & r22;
	r22 = 0;
	if( r20 != r22 ) goto label$2532$106;
	r12 = false;
	goto label$2532$107;
	label$2532$106:
	r12 = true;
	label$2532$107:
	r25 = (dx__RenderTargetDesc)hl_alloc_obj(dx__RenderTargetDesc__val);
	r20 = h3d_impl_DirectXDriver_getTextureFormat(r0,r14);
	if( !r12 ) goto label$2532$112;
	r22 = 5;
	goto label$2532$113;
	label$2532$112:
	r22 = 4;
	label$2532$113:
	r9 = &r22;
	dx_RenderTargetDesc_new(r25,r20,r9);
	r25->mipMap = r3;
	r25->firstSlice = r2;
	r20 = 1;
	r25->sliceCount = r20;
	r21 = r14->_t;
	if( r21 == NULL ) hl_null_access();
	r26 = hl_vfields(r21)[1] ? (*(dx_resource**)(hl_vfields(r21)[1])) : (dx_resource*)hl_dyn_getp(r21->value,5691744/*res*/,&type$52);
	r24 = dx_Driver_createRenderTargetView(r26,r25);
	r23 = r24;
	r21 = r14->_t;
	if( r21 == NULL ) hl_null_access();
	r6 = hl_vfields(r21)[2] ? (*(hl__types__ArrayObj*)(hl_vfields(r21)[2])) : (hl__types__ArrayObj)hl_dyn_getp(r21->value,25538/*rt*/,&type$46);
	if( r6 == NULL ) hl_null_access();
	r27 = r6->length;
	if( ((unsigned)r19) < ((unsigned)r27) ) goto label$2532$131;
	hl_types_ArrayObj___expand(r6,r19);
	label$2532$131:
	r13 = r6->array;
	if( r24 == NULL ) r11 = NULL; else {
		r11 = hl_alloc_dynamic(&type$53);
		r11->v.ptr = r24;
	}
	((vdynamic**)(r13 + 1))[r19] = r11;
	label$2532$134:
	r20 = r0->frame;
	r14->lastFrame = r20;
	r13 = r0->currentTargets;
	((dx_pointer**)(r13 + 1))[r18] = r23;
	r21 = r14->_t;
	if( r21 == NULL ) hl_null_access();
	r24 = hl_vfields(r21)[3] ? (*(dx_pointer**)(hl_vfields(r21)[3])) : (dx_pointer*)hl_dyn_getp(r21->value,240071535/*view*/,&type$53);
	h3d_impl_DirectXDriver_unbind(r0,r24);
	r20 = r14->flags;
	r27 = 256;
	r20 = r20 & r27;
	r27 = 0;
	if( r20 != r27 ) goto label$2532$160;
	r20 = r14->flags;
	r27 = 256;
	r20 = r20 | r27;
	r14->flags = r20;
	r20 = 0;
	r28 = (double)r20;
	r20 = 0;
	r29 = (double)r20;
	r20 = 0;
	r30 = (double)r20;
	r20 = 0;
	r31 = (double)r20;
	directx_clear_color(r23,r28,r29,r30,r31);
	label$2532$160:
	goto label$2532$54;
	label$2532$161:
	r13 = r0->currentTargets;
	if( r1 == NULL ) hl_null_access();
	r5 = r1->length;
	r32 = (dx_pointer**)hl_aptr(r13,void*);
	r17 = r0->currentDepth;
	if( r17 ) goto label$2532$169;
	r23 = NULL;
	goto label$2532$172;
	label$2532$169:
	r17 = r0->currentDepth;
	if( r17 == NULL ) hl_null_access();
	r23 = hl_vfields(r17)[1] ? (*(dx_pointer**)(hl_vfields(r17)[1])) : (dx_pointer*)hl_dyn_getp(r17->value,240071535/*view*/,&type$53);
	label$2532$172:
	directx_om_set_render_targets(r5,r32,r23);
	r5 = r1->length;
	r0->targetsCount = r5;
	r33 = r0->viewport;
	if( r8 == NULL ) hl_null_access();
	r5 = r8->width;
	r5 = r5 >> r3;
	r34 = (float)r5;
	r5 = 2;
	r7 = 2;
	r7 = r5 << r7;
	*(float*)(r33 + r7) = r34;
	r33 = r0->viewport;
	r5 = r8->height;
	r5 = r5 >> r3;
	r34 = (float)r5;
	r5 = 3;
	r7 = 2;
	r7 = r5 << r7;
	*(float*)(r33 + r7) = r34;
	r33 = r0->viewport;
	r5 = 5;
	r28 = 1.;
	r34 = (float)r28;
	r7 = 2;
	r7 = r5 << r7;
	*(float*)(r33 + r7) = r34;
	r5 = 1;
	r33 = r0->viewport;
	directx_rs_set_viewports(r5,r33);
	return;
}

void h3d_impl_DirectXDriver_setRenderZone(h3d__impl__DirectXDriver r0,int r1,int r2,int r3,int r4) {
	bool r8;
	vbyte *r9;
	int r6, r7, r10, r11;
	r7 = 0;
	if( r1 != r7 ) goto label$2533$11;
	r7 = 0;
	if( r2 != r7 ) goto label$2533$11;
	r7 = 0;
	if( r3 >= r7 ) goto label$2533$11;
	r7 = 0;
	if( r4 >= r7 ) goto label$2533$11;
	r8 = false;
	r0->hasScissor = r8;
	return;
	label$2533$11:
	r7 = 0;
	if( r1 >= r7 ) goto label$2533$17;
	r6 = r3 + r1;
	r3 = r6;
	r6 = 0;
	r1 = r6;
	label$2533$17:
	r7 = 0;
	if( r2 >= r7 ) goto label$2533$23;
	r6 = r4 + r2;
	r4 = r6;
	r6 = 0;
	r2 = r6;
	label$2533$23:
	r7 = 0;
	if( r3 >= r7 ) goto label$2533$27;
	r6 = 0;
	r3 = r6;
	label$2533$27:
	r7 = 0;
	if( r4 >= r7 ) goto label$2533$31;
	r6 = 0;
	r4 = r6;
	label$2533$31:
	r8 = true;
	r0->hasScissor = r8;
	r9 = r0->rects;
	r6 = 0;
	r10 = 2;
	r10 = r6 << r10;
	*(int*)(r9 + r10) = r1;
	r9 = r0->rects;
	r6 = 1;
	r10 = 2;
	r10 = r6 << r10;
	*(int*)(r9 + r10) = r2;
	r9 = r0->rects;
	r6 = r1 + r3;
	r7 = 2;
	r11 = 2;
	r11 = r7 << r11;
	*(int*)(r9 + r11) = r6;
	r9 = r0->rects;
	r6 = r2 + r4;
	r7 = 3;
	r11 = 2;
	r11 = r7 << r11;
	*(int*)(r9 + r11) = r6;
	r6 = 1;
	r9 = r0->rects;
	directx_rs_set_scissor_rects(r6,r9);
	return;
}

bool h3d_impl_DirectXDriver_selectShader(h3d__impl__DirectXDriver r0,hxsl__RuntimeShader r1) {
	String r29, r33, r36;
	bool *r10;
	dx_pointer *r41;
	dx__LayoutElement r28;
	hl__types__ArrayObj r14, r20, r24;
	vvirtual *r8, *r11, *r21, *r25;
	venum *r26, *r27, *r32, *r34, *r35, *r37, *r38;
	hl_type *r16;
	hxsl__RuntimeShaderData r9;
	haxe__io__Bytes r42;
	bool r12;
	haxe__ds__IntMap r3;
	hl__types__ArrayBytes_Int r17;
	h3d__impl___DirectXDriver__CompiledShader r5, r7, r43;
	h3d__impl___DirectXDriver__ShaderContext r13;
	vdynamic *r2;
	vbyte *r18;
	varray *r15, *r40;
	int r4, r19, r22, r23, r30, r31, r39;
	r3 = r0->shaders;
	if( r3 == NULL ) hl_null_access();
	if( r1 == NULL ) hl_null_access();
	r4 = r1->id;
	r2 = haxe_ds_IntMap_get(r3,r4);
	r5 = (h3d__impl___DirectXDriver__CompiledShader)r2;
	if( r5 ) goto label$2534$244;
	r7 = (h3d__impl___DirectXDriver__CompiledShader)hl_alloc_obj(h3d__impl___DirectXDriver__CompiledShader__val);
	h3d_impl__DirectXDriver_CompiledShader_new(r7);
	r5 = r7;
	r9 = r1->vertex;
	r10 = NULL;
	r8 = h3d_impl_DirectXDriver_compileShader(r0,r9,r10);
	r9 = r1->fragment;
	r10 = NULL;
	r11 = h3d_impl_DirectXDriver_compileShader(r0,r9,r10);
	r12 = r0->hasDeviceError;
	if( !r12 ) goto label$2534$20;
	r12 = false;
	return r12;
	label$2534$20:
	if( r8 == NULL ) hl_null_access();
	r13 = hl_vfields(r8)[1] ? (*(h3d__impl___DirectXDriver__ShaderContext*)(hl_vfields(r8)[1])) : (h3d__impl___DirectXDriver__ShaderContext)hl_dyn_getp(r8->value,115/*s*/,&type$1760);
	r7->vertex = r13;
	if( r11 == NULL ) hl_null_access();
	r13 = hl_vfields(r11)[1] ? (*(h3d__impl___DirectXDriver__ShaderContext*)(hl_vfields(r11)[1])) : (h3d__impl___DirectXDriver__ShaderContext)hl_dyn_getp(r11->value,115/*s*/,&type$1760);
	r7->fragment = r13;
	r16 = &type$13;
	r4 = 0;
	r15 = hl_alloc_array(r16,r4);
	r14 = hl_types_ArrayObj_alloc(r15);
	r7->inputs = r14;
	r4 = 0;
	r18 = hl_alloc_bytes(r4);
	r4 = 0;
	r4 = 0;
	r17 = hl_types_ArrayBase_allocI32(r18,r4);
	r7->offsets = r17;
	r16 = &type$1385;
	r4 = 0;
	r15 = hl_alloc_array(r16,r4);
	r14 = hl_types_ArrayObj_alloc(r15);
	r4 = 0;
	r19 = 0;
	r9 = r1->vertex;
	if( r9 == NULL ) hl_null_access();
	r21 = r9->data;
	if( r21 == NULL ) hl_null_access();
	r20 = hl_vfields(r21)[2] ? (*(hl__types__ArrayObj*)(hl_vfields(r21)[2])) : (hl__types__ArrayObj)hl_dyn_getp(r21->value,239676598/*vars*/,&type$46);
	label$2534$48:
	if( r20 == NULL ) hl_null_access();
	r23 = r20->length;
	if( r19 >= r23 ) goto label$2534$205;
	r23 = r20->length;
	if( ((unsigned)r19) < ((unsigned)r23) ) goto label$2534$56;
	r25 = NULL;
	goto label$2534$59;
	label$2534$56:
	r15 = r20->array;
	r2 = ((vdynamic**)(r15 + 1))[r19];
	r25 = hl_to_virtual(&type$146,(vdynamic*)r2);
	label$2534$59:
	++r19;
	if( r25 == NULL ) hl_null_access();
	r26 = hl_vfields(r25)[1] ? (*(venum**)(hl_vfields(r25)[1])) : (venum*)hl_dyn_getp(r25->value,118088286/*kind*/,&type$147);
	r27 = (venum*)global$538;
	if( r26 != r27 ) goto label$2534$204;
	r28 = (dx__LayoutElement)hl_alloc_obj(dx__LayoutElement__val);
	dx_LayoutElement_new(r28);
	r29 = hl_vfields(r25)[2] ? (*(String*)(hl_vfields(r25)[2])) : (String)hl_dyn_getp(r25->value,150958933/*name*/,&type$13);
	r29 = hxsl_HlslOut_semanticName(r29);
	r22 = 0;
	r24 = hl_vfields(r25)[4] ? (*(hl__types__ArrayObj*)(hl_vfields(r25)[4])) : (hl__types__ArrayObj)hl_dyn_getp(r25->value,476822680/*qualifiers*/,&type$46);
	if( !r24 ) goto label$2534$92;
	r23 = 0;
	r24 = hl_vfields(r25)[4] ? (*(hl__types__ArrayObj*)(hl_vfields(r25)[4])) : (hl__types__ArrayObj)hl_dyn_getp(r25->value,476822680/*qualifiers*/,&type$46);
	label$2534$73:
	if( r24 == NULL ) hl_null_access();
	r31 = r24->length;
	if( r23 >= r31 ) goto label$2534$92;
	r31 = r24->length;
	if( ((unsigned)r23) < ((unsigned)r31) ) goto label$2534$81;
	r32 = NULL;
	goto label$2534$84;
	label$2534$81:
	r15 = r24->array;
	r2 = ((vdynamic**)(r15 + 1))[r23];
	r32 = (venum*)r2;
	label$2534$84:
	++r23;
	if( r32 == NULL ) hl_null_access();
	r30 = HL__ENUM_INDEX__(r32);
	r31 = 9;
	if( r30 != r31 ) goto label$2534$91;
	r30 = ((hxsl_VarQualifier_PerInstance*)r32)->p0;
	r22 = r30;
	label$2534$91:
	goto label$2534$73;
	label$2534$92:
	if( r28 == NULL ) hl_null_access();
	if( r29 == NULL ) hl_null_access();
	r18 = String_toUtf8(r29);
	r28->semanticName = r18;
	if( r14 == NULL ) hl_null_access();
	r23 = r14->length;
	r28->inputSlot = r23;
	if( r25 == NULL ) hl_null_access();
	r34 = hl_vfields(r25)[5] ? (*(venum**)(hl_vfields(r25)[5])) : (venum*)hl_dyn_getp(r25->value,218690500/*type*/,&type$148);
	if( r34 == NULL ) hl_null_access();
	r23 = HL__ENUM_INDEX__(r34);
	switch(r23) {
		default:
		case 0:
		case 1:
		case 2:
		case 4:
		case 6:
		case 7:
		case 8:
			r33 = (String)global$539;
			r35 = hl_vfields(r25)[5] ? (*(venum**)(hl_vfields(r25)[5])) : (venum*)hl_dyn_getp(r25->value,218690500/*type*/,&type$148);
			r36 = hxsl_Tools_toString(r35);
			r33 = String___add__(r33,r36);
			hl_throw((vdynamic*)r33);
		case 3:
			r30 = 41;
			goto label$2534$167;
		case 5:
			r30 = ((hxsl_Type_TVec*)r34)->p0;
			switch(r30) {
				default:
				case 0:
				case 1:
					r33 = (String)global$539;
					r35 = hl_vfields(r25)[5] ? (*(venum**)(hl_vfields(r25)[5])) : (venum*)hl_dyn_getp(r25->value,218690500/*type*/,&type$148);
					r36 = hxsl_Tools_toString(r35);
					r33 = String___add__(r33,r36);
					hl_throw((vdynamic*)r33);
				case 2:
					r37 = ((hxsl_Type_TVec*)r34)->p1;
					if( r37 == NULL ) hl_null_access();
					r30 = HL__ENUM_INDEX__(r37);
					r31 = 1;
					if( r30 != r31 ) goto label$2534$125;
					r30 = 16;
					goto label$2534$130;
					label$2534$125:
					r33 = (String)global$539;
					r35 = hl_vfields(r25)[5] ? (*(venum**)(hl_vfields(r25)[5])) : (venum*)hl_dyn_getp(r25->value,218690500/*type*/,&type$148);
					r36 = hxsl_Tools_toString(r35);
					r33 = String___add__(r33,r36);
					hl_throw((vdynamic*)r33);
					label$2534$130:
					goto label$2534$156;
				case 3:
					r37 = ((hxsl_Type_TVec*)r34)->p1;
					if( r37 == NULL ) hl_null_access();
					r30 = HL__ENUM_INDEX__(r37);
					r31 = 1;
					if( r30 != r31 ) goto label$2534$138;
					r30 = 6;
					goto label$2534$143;
					label$2534$138:
					r33 = (String)global$539;
					r35 = hl_vfields(r25)[5] ? (*(venum**)(hl_vfields(r25)[5])) : (venum*)hl_dyn_getp(r25->value,218690500/*type*/,&type$148);
					r36 = hxsl_Tools_toString(r35);
					r33 = String___add__(r33,r36);
					hl_throw((vdynamic*)r33);
					label$2534$143:
					goto label$2534$156;
				case 4:
					r37 = ((hxsl_Type_TVec*)r34)->p1;
					if( r37 == NULL ) hl_null_access();
					r30 = HL__ENUM_INDEX__(r37);
					r31 = 1;
					if( r30 != r31 ) goto label$2534$151;
					r30 = 2;
					goto label$2534$156;
					label$2534$151:
					r33 = (String)global$539;
					r35 = hl_vfields(r25)[5] ? (*(venum**)(hl_vfields(r25)[5])) : (venum*)hl_dyn_getp(r25->value,218690500/*type*/,&type$148);
					r36 = hxsl_Tools_toString(r35);
					r33 = String___add__(r33,r36);
					hl_throw((vdynamic*)r33);
			}
			label$2534$156:
			goto label$2534$167;
		case 9:
			r30 = ((hxsl_Type_TBytes*)r34)->p0;
			r31 = 4;
			if( r30 != r31 ) goto label$2534$162;
			r30 = 30;
			goto label$2534$167;
			label$2534$162:
			r33 = (String)global$539;
			r35 = hl_vfields(r25)[5] ? (*(venum**)(hl_vfields(r25)[5])) : (venum*)hl_dyn_getp(r25->value,218690500/*type*/,&type$148);
			r36 = hxsl_Tools_toString(r35);
			r33 = String___add__(r33,r36);
			hl_throw((vdynamic*)r33);
	}
	label$2534$167:
	r28->format = r30;
	r31 = 0;
	if( r31 >= r22 ) goto label$2534$174;
	r30 = 1;
	r28->inputSlotClass = r30;
	r28->instanceDataStepRate = r22;
	goto label$2534$176;
	label$2534$174:
	r30 = 0;
	r28->inputSlotClass = r30;
	label$2534$176:
	r30 = hl_types_ArrayObj_push(r14,((vdynamic*)r28));
	if( r5 == NULL ) hl_null_access();
	r17 = r5->offsets;
	if( r17 == NULL ) hl_null_access();
	r30 = hl_types_ArrayBytes_Int_push(r17,r4);
	r24 = r5->inputs;
	if( r24 == NULL ) hl_null_access();
	r33 = hl_vfields(r25)[2] ? (*(String*)(hl_vfields(r25)[2])) : (String)hl_dyn_getp(r25->value,150958933/*name*/,&type$13);
	r30 = hl_types_ArrayObj_push(r24,((vdynamic*)r33));
	r35 = hl_vfields(r25)[5] ? (*(venum**)(hl_vfields(r25)[5])) : (venum*)hl_dyn_getp(r25->value,218690500/*type*/,&type$148);
	if( r35 == NULL ) hl_null_access();
	r30 = HL__ENUM_INDEX__(r35);
	switch(r30) {
		default:
		case 0:
		case 1:
		case 2:
		case 4:
		case 6:
		case 7:
		case 8:
			r33 = (String)global$540;
			r38 = hl_vfields(r25)[5] ? (*(venum**)(hl_vfields(r25)[5])) : (venum*)hl_dyn_getp(r25->value,218690500/*type*/,&type$148);
			r36 = Std_string(((vdynamic*)r38));
			r33 = String___add__(r33,r36);
			hl_throw((vdynamic*)r33);
		case 3:
			r31 = 1;
			r30 = r31;
			goto label$2534$202;
		case 5:
			r31 = ((hxsl_Type_TVec*)r35)->p0;
			r30 = r31;
			goto label$2534$202;
		case 9:
			r31 = ((hxsl_Type_TBytes*)r35)->p0;
			r30 = r31;
	}
	label$2534$202:
	r31 = r4 + r30;
	r4 = r31;
	label$2534$204:
	goto label$2534$48;
	label$2534$205:
	if( r14 == NULL ) hl_null_access();
	r19 = r14->length;
	r16 = &type$1385;
	r15 = hl_alloc_array(r16,r19);
	r22 = 0;
	r23 = r14->length;
	label$2534$211:
	if( r22 >= r23 ) goto label$2534$225;
	r30 = r22;
	++r22;
	if( r14 == NULL ) hl_null_access();
	r39 = r14->length;
	if( ((unsigned)r30) < ((unsigned)r39) ) goto label$2534$220;
	r28 = NULL;
	goto label$2534$223;
	label$2534$220:
	r40 = r14->array;
	r2 = ((vdynamic**)(r40 + 1))[r30];
	r28 = (dx__LayoutElement)r2;
	label$2534$223:
	((dx__LayoutElement*)(r15 + 1))[r30] = r28;
	goto label$2534$211;
	label$2534$225:
	if( r5 == NULL ) hl_null_access();
	if( r8 == NULL ) hl_null_access();
	r42 = hl_vfields(r8)[0] ? (*(haxe__io__Bytes*)(hl_vfields(r8)[0])) : (haxe__io__Bytes)hl_dyn_getp(r8->value,-40368287/*bytes*/,&type$75);
	if( r42 == NULL ) hl_null_access();
	r18 = r42->b;
	r42 = hl_vfields(r8)[0] ? (*(haxe__io__Bytes*)(hl_vfields(r8)[0])) : (haxe__io__Bytes)hl_dyn_getp(r8->value,-40368287/*bytes*/,&type$75);
	if( r42 == NULL ) hl_null_access();
	r22 = r42->length;
	r41 = directx_create_input_layout(r15,r18,r22);
	r5->layout = r41;
	r41 = r5->layout;
	if( r41 ) goto label$2534$239;
	r29 = (String)global$541;
	hl_throw((vdynamic*)r29);
	label$2534$239:
	r3 = r0->shaders;
	if( r3 == NULL ) hl_null_access();
	if( r1 == NULL ) hl_null_access();
	r22 = r1->id;
	haxe_ds_IntMap_set(r3,r22,((vdynamic*)r5));
	label$2534$244:
	r43 = r0->currentShader;
	if( r5 != r43 ) goto label$2534$248;
	r12 = false;
	return r12;
	label$2534$248:
	r0->currentShader = r5;
	if( r5 == NULL ) hl_null_access();
	r13 = r5->vertex;
	if( r13 == NULL ) hl_null_access();
	r41 = r13->shader;
	directx_vs_set_shader(r41);
	r13 = r5->fragment;
	if( r13 == NULL ) hl_null_access();
	r41 = r13->shader;
	directx_ps_set_shader(r41);
	r41 = r5->layout;
	directx_ia_set_input_layout(r41);
	r12 = true;
	return r12;
}

hl__types__ArrayObj h3d_impl_DirectXDriver_getShaderInputNames(h3d__impl__DirectXDriver r0) {
	hl__types__ArrayObj r1;
	h3d__impl___DirectXDriver__CompiledShader r2;
	r2 = r0->currentShader;
	if( r2 == NULL ) hl_null_access();
	r1 = r2->inputs;
	return r1;
}

void h3d_impl_DirectXDriver_selectBuffer(h3d__impl__DirectXDriver r0,h3d__Buffer r1) {
	dx_resource **r23, **r24;
	hl__types__ArrayObj r10;
	vvirtual *r4;
	bool r3;
	dx_resource *r16, *r17;
	hl__types__ArrayBytes_Int r18, r22;
	h3d__impl___DirectXDriver__CompiledShader r11;
	vbyte *r20, *r25;
	varray *r14, *r15;
	int r6, r7, r8, r9, r12, r13, r19, r21;
	h3d__impl__ManagedBuffer r5;
	r3 = r0->hasDeviceError;
	if( !r3 ) goto label$2536$3;
	return;
	label$2536$3:
	if( r1 == NULL ) hl_null_access();
	r5 = r1->buffer;
	if( r5 == NULL ) hl_null_access();
	r4 = r5->vbuf;
	r6 = -1;
	r7 = -1;
	r8 = 0;
	r11 = r0->currentShader;
	if( r11 == NULL ) hl_null_access();
	r10 = r11->inputs;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->length;
	label$2536$15:
	if( r8 >= r9 ) goto label$2536$95;
	r12 = r8;
	++r8;
	r14 = r0->currentVBuffers;
	r16 = ((dx_resource**)(r14 + 1))[r12];
	if( r4 == NULL ) hl_null_access();
	r17 = hl_vfields(r4)[1] ? (*(dx_resource**)(hl_vfields(r4)[1])) : (dx_resource*)hl_dyn_getp(r4->value,5691744/*res*/,&type$52);
	if( r16 != r17 ) goto label$2536$49;
	r18 = r0->offsets;
	if( r18 == NULL ) hl_null_access();
	r19 = r18->length;
	if( ((unsigned)r12) < ((unsigned)r19) ) goto label$2536$30;
	r13 = 0;
	goto label$2536$34;
	label$2536$30:
	r20 = r18->bytes;
	r19 = 2;
	r19 = r12 << r19;
	r13 = *(int*)(r20 + r19);
	label$2536$34:
	r11 = r0->currentShader;
	if( r11 == NULL ) hl_null_access();
	r18 = r11->offsets;
	if( r18 == NULL ) hl_null_access();
	r21 = r18->length;
	if( ((unsigned)r12) < ((unsigned)r21) ) goto label$2536$42;
	r19 = 0;
	goto label$2536$46;
	label$2536$42:
	r20 = r18->bytes;
	r21 = 2;
	r21 = r12 << r21;
	r19 = *(int*)(r20 + r21);
	label$2536$46:
	r21 = 2;
	r19 = r19 << r21;
	if( r13 == r19 ) goto label$2536$94;
	label$2536$49:
	r15 = r0->currentVBuffers;
	r16 = hl_vfields(r4)[1] ? (*(dx_resource**)(hl_vfields(r4)[1])) : (dx_resource*)hl_dyn_getp(r4->value,5691744/*res*/,&type$52);
	((dx_resource**)(r15 + 1))[r12] = r16;
	r18 = r0->strides;
	if( r18 == NULL ) hl_null_access();
	if( r1 == NULL ) hl_null_access();
	r5 = r1->buffer;
	if( r5 == NULL ) hl_null_access();
	r19 = r5->stride;
	r21 = 2;
	r19 = r19 << r21;
	r21 = r18->length;
	if( ((unsigned)r12) < ((unsigned)r21) ) goto label$2536$63;
	hl_types_ArrayBytes_Int___expand(r18,r12);
	label$2536$63:
	r20 = r18->bytes;
	r21 = 2;
	r21 = r12 << r21;
	*(int*)(r20 + r21) = r19;
	r18 = r0->offsets;
	if( r18 == NULL ) hl_null_access();
	r11 = r0->currentShader;
	if( r11 == NULL ) hl_null_access();
	r22 = r11->offsets;
	if( r22 == NULL ) hl_null_access();
	r21 = r22->length;
	if( ((unsigned)r12) < ((unsigned)r21) ) goto label$2536$77;
	r19 = 0;
	goto label$2536$81;
	label$2536$77:
	r20 = r22->bytes;
	r21 = 2;
	r21 = r12 << r21;
	r19 = *(int*)(r20 + r21);
	label$2536$81:
	r21 = 2;
	r19 = r19 << r21;
	r21 = r18->length;
	if( ((unsigned)r12) < ((unsigned)r21) ) goto label$2536$86;
	hl_types_ArrayBytes_Int___expand(r18,r12);
	label$2536$86:
	r20 = r18->bytes;
	r21 = 2;
	r21 = r12 << r21;
	*(int*)(r20 + r21) = r19;
	r19 = 0;
	if( r6 >= r19 ) goto label$2536$93;
	r6 = r12;
	label$2536$93:
	r7 = r12;
	label$2536$94:
	goto label$2536$15;
	label$2536$95:
	r9 = 0;
	if( r7 < r9 ) goto label$2536$116;
	r14 = r0->currentVBuffers;
	r23 = (dx_resource**)hl_aptr(r14,void*);
	r24 = r23 + r6;
	r18 = r0->strides;
	if( r18 == NULL ) hl_null_access();
	r20 = r18->bytes;
	r9 = 2;
	r8 = r6 << r9;
	r20 = hl_bytes_offset(r20,r8);
	r22 = r0->offsets;
	if( r22 == NULL ) hl_null_access();
	r25 = r22->bytes;
	r9 = 2;
	r8 = r6 << r9;
	r25 = hl_bytes_offset(r25,r8);
	r9 = r7 - r6;
	r12 = 1;
	r9 = r9 + r12;
	directx_ia_set_vertex_buffers(r6,r9,r24,r20,r25);
	label$2536$116:
	return;
}

void h3d_impl_DirectXDriver_selectMultiBuffers(h3d__impl__DirectXDriver r0,h3d__BufferOffset r1) {
	dx_resource **r20, **r21;
	vvirtual *r8;
	bool r3;
	dx_resource *r14, *r15;
	hl__types__ArrayBytes_Int r16, r22;
	h3d__BufferOffset r7;
	h3d__Buffer r10;
	vbyte *r18, *r23;
	varray *r11, *r12;
	h3d__impl__ManagedBuffer r9;
	int r4, r5, r6, r13, r17, r19;
	r3 = r0->hasDeviceError;
	if( !r3 ) goto label$2537$3;
	return;
	label$2537$3:
	r4 = 0;
	r5 = -1;
	r6 = -1;
	label$2537$6:
	if( !r1 ) goto label$2537$72;
	if( r1 == NULL ) hl_null_access();
	r10 = r1->buffer;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->buffer;
	if( r9 == NULL ) hl_null_access();
	r8 = r9->vbuf;
	r11 = r0->currentVBuffers;
	r14 = ((dx_resource**)(r11 + 1))[r4];
	if( r8 == NULL ) hl_null_access();
	r15 = hl_vfields(r8)[1] ? (*(dx_resource**)(hl_vfields(r8)[1])) : (dx_resource*)hl_dyn_getp(r8->value,5691744/*res*/,&type$52);
	if( r14 != r15 ) goto label$2537$33;
	r16 = r0->offsets;
	if( r16 == NULL ) hl_null_access();
	r17 = r16->length;
	if( ((unsigned)r4) < ((unsigned)r17) ) goto label$2537$25;
	r13 = 0;
	goto label$2537$29;
	label$2537$25:
	r18 = r16->bytes;
	r17 = 2;
	r17 = r4 << r17;
	r13 = *(int*)(r18 + r17);
	label$2537$29:
	r17 = r1->offset;
	r19 = 2;
	r17 = r17 << r19;
	if( r13 == r17 ) goto label$2537$68;
	label$2537$33:
	r12 = r0->currentVBuffers;
	r14 = hl_vfields(r8)[1] ? (*(dx_resource**)(hl_vfields(r8)[1])) : (dx_resource*)hl_dyn_getp(r8->value,5691744/*res*/,&type$52);
	((dx_resource**)(r12 + 1))[r4] = r14;
	r16 = r0->offsets;
	if( r16 == NULL ) hl_null_access();
	r17 = r1->offset;
	r19 = 2;
	r17 = r17 << r19;
	r19 = r16->length;
	if( ((unsigned)r4) < ((unsigned)r19) ) goto label$2537$44;
	hl_types_ArrayBytes_Int___expand(r16,r4);
	label$2537$44:
	r18 = r16->bytes;
	r19 = 2;
	r19 = r4 << r19;
	*(int*)(r18 + r19) = r17;
	r16 = r0->strides;
	if( r16 == NULL ) hl_null_access();
	r10 = r1->buffer;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->buffer;
	if( r9 == NULL ) hl_null_access();
	r17 = r9->stride;
	r19 = 2;
	r17 = r17 << r19;
	r19 = r16->length;
	if( ((unsigned)r4) < ((unsigned)r19) ) goto label$2537$60;
	hl_types_ArrayBytes_Int___expand(r16,r4);
	label$2537$60:
	r18 = r16->bytes;
	r19 = 2;
	r19 = r4 << r19;
	*(int*)(r18 + r19) = r17;
	r17 = 0;
	if( r5 >= r17 ) goto label$2537$67;
	r5 = r4;
	label$2537$67:
	r6 = r4;
	label$2537$68:
	++r4;
	r7 = r1->next;
	r1 = r7;
	goto label$2537$6;
	label$2537$72:
	r17 = 0;
	if( r6 < r17 ) goto label$2537$93;
	r11 = r0->currentVBuffers;
	r20 = (dx_resource**)hl_aptr(r11,void*);
	r21 = r20 + r5;
	r16 = r0->strides;
	if( r16 == NULL ) hl_null_access();
	r18 = r16->bytes;
	r17 = 2;
	r13 = r5 << r17;
	r18 = hl_bytes_offset(r18,r13);
	r22 = r0->offsets;
	if( r22 == NULL ) hl_null_access();
	r23 = r22->bytes;
	r17 = 2;
	r13 = r5 << r17;
	r23 = hl_bytes_offset(r23,r13);
	r17 = r6 - r5;
	r19 = 1;
	r17 = r17 + r19;
	directx_ia_set_vertex_buffers(r5,r17,r21,r18,r23);
	label$2537$93:
	return;
}

void h3d_impl_DirectXDriver_uploadShaderBuffers(h3d__impl__DirectXDriver r0,h3d__shader__Buffers r1,int r2) {
	bool r4;
	h3d__impl__PipelineState r5;
	h3d__shader__ShaderBuffers r8;
	h3d__impl___DirectXDriver__CompiledShader r7;
	h3d__impl___DirectXDriver__ShaderContext r6;
	r4 = r0->hasDeviceError;
	if( !r4 ) goto label$2538$3;
	return;
	label$2538$3:
	r5 = r0->vertexShader;
	r7 = r0->currentShader;
	if( r7 == NULL ) hl_null_access();
	r6 = r7->vertex;
	if( r1 == NULL ) hl_null_access();
	r8 = r1->vertex;
	h3d_impl_DirectXDriver_uploadBuffers(r0,r5,r6,r8,r2);
	r5 = r0->pixelShader;
	r7 = r0->currentShader;
	if( r7 == NULL ) hl_null_access();
	r6 = r7->fragment;
	r8 = r1->fragment;
	h3d_impl_DirectXDriver_uploadBuffers(r0,r5,r6,r8,r2);
	return;
}

void h3d_impl_DirectXDriver_uploadShaderBuffer(h3d__impl__DirectXDriver r0,dx_resource* r1,hl__types__ArrayBytes_Single r2,int r3,vbyte* r4) {
	String r14, r15;
	bool r12;
	int *r13;
	vdynamic *r8;
	vbyte *r9, *r10;
	int r6, r7, r11;
	r7 = 0;
	if( r3 != r7 ) goto label$2539$3;
	return;
	label$2539$3:
	if( r2 == NULL ) hl_null_access();
	r9 = r2->bytes;
	r7 = 4;
	r6 = r3 << r7;
	if( !r4 ) goto label$2539$20;
	r7 = 0;
	r11 = 0;
	r7 = hl_bytes_compare(r4,r7,r9,r11,r6);
	r11 = 0;
	if( r7 != r11 ) goto label$2539$14;
	return;
	label$2539$14:
	r7 = 0;
	r11 = 0;
	hl_bytes_blit(r4,r7,r9,r11,r6);
	r7 = r0->mapCount;
	++r7;
	r0->mapCount = r7;
	label$2539$20:
	r7 = 0;
	r11 = 4;
	r12 = true;
	r13 = NULL;
	r10 = directx_map(r1,r7,r11,r12,r13);
	if( r10 ) goto label$2539$31;
	r14 = (String)global$542;
	if( r1 == NULL ) r8 = NULL; else {
		r8 = hl_alloc_dynamic(&type$52);
		r8->v.ptr = r1;
	}
	r15 = Std_string(r8);
	r14 = String___add__(r14,r15);
	hl_throw((vdynamic*)r14);
	label$2539$31:
	r7 = 0;
	r11 = 0;
	hl_bytes_blit(r10,r7,r9,r11,r6);
	r7 = 0;
	directx_unmap(r1,r7);
	return;
}

void h3d_impl_DirectXDriver_uploadBuffers(h3d__impl__DirectXDriver r0,h3d__impl__PipelineState r1,h3d__impl___DirectXDriver__ShaderContext r2,h3d__shader__ShaderBuffers r3,int r4) {
	dx_resource **r15, **r16;
	dx_pointer *r38, *r39, *r40;
	vvirtual *r28, *r36, *r51;
	hl__types__ArrayObj r23;
	venum *r14, *r45, *r46, *r47;
	bool r37;
	dx_resource *r8, *r13, *r54;
	h3d__impl__$DirectXDriver r44;
	haxe__ds__IntMap r42;
	hl__types__ArrayBytes_Int r41;
	hl__types__ArrayBytes_Single r9;
	h3d__mat__$Defaults r30;
	float r48;
	h3d__Buffer r53;
	double r31, r34;
	vclosure *r29;
	dx_pointer **r49, **r50;
	dx__SamplerDesc r43;
	vdynamic *r26, *r35;
	h3d__impl__ManagedBuffer r52;
	h3d__mat__Texture r25, r27;
	varray *r11, *r12;
	vbyte *r10;
	int r6, r7, r17, r18, r19, r20, r21, r22, r24, r32, r33;
	switch(r4) {
		default:
			goto label$2540$349;
		case 0:
			if( r2 == NULL ) hl_null_access();
			r6 = r2->globalsSize;
			r7 = 0;
			if( r7 >= r6 ) goto label$2540$38;
			r8 = r2->globals;
			if( r3 == NULL ) hl_null_access();
			r9 = r3->globals;
			r6 = r2->globalsSize;
			r10 = NULL;
			h3d_impl_DirectXDriver_uploadShaderBuffer(r0,r8,r9,r6,r10);
			if( r1 == NULL ) hl_null_access();
			r11 = r1->buffers;
			r6 = 0;
			r8 = ((dx_resource**)(r11 + 1))[r6];
			r13 = r2->globals;
			if( r8 == r13 ) goto label$2540$38;
			r12 = r1->buffers;
			r8 = r2->globals;
			r6 = 0;
			((dx_resource**)(r12 + 1))[r6] = r8;
			r14 = r1->kind;
			if( r14 == NULL ) hl_null_access();
			r6 = HL__ENUM_INDEX__(r14);
			switch(r6) {
				default:
					goto label$2540$38;
				case 0:
					r12 = r1->buffers;
					r6 = 0;
					r7 = 1;
					r15 = (dx_resource**)hl_aptr(r12,void*);
					directx_vs_set_constant_buffers(r6,r7,r15);
					goto label$2540$38;
				case 1:
					r12 = r1->buffers;
					r6 = 0;
					r7 = 1;
					r15 = (dx_resource**)hl_aptr(r12,void*);
					directx_ps_set_constant_buffers(r6,r7,r15);
			}
			label$2540$38:
			goto label$2540$349;
		case 1:
			if( r2 == NULL ) hl_null_access();
			r6 = r2->paramsSize;
			r7 = 0;
			if( r7 >= r6 ) goto label$2540$79;
			r8 = r2->params;
			if( r3 == NULL ) hl_null_access();
			r9 = r3->params;
			r6 = r2->paramsSize;
			r10 = r2->paramsContent;
			h3d_impl_DirectXDriver_uploadShaderBuffer(r0,r8,r9,r6,r10);
			if( r1 == NULL ) hl_null_access();
			r11 = r1->buffers;
			r6 = 1;
			r8 = ((dx_resource**)(r11 + 1))[r6];
			r13 = r2->params;
			if( r8 == r13 ) goto label$2540$79;
			r12 = r1->buffers;
			r8 = r2->params;
			r6 = 1;
			((dx_resource**)(r12 + 1))[r6] = r8;
			r14 = r1->kind;
			if( r14 == NULL ) hl_null_access();
			r6 = HL__ENUM_INDEX__(r14);
			switch(r6) {
				default:
					goto label$2540$79;
				case 0:
					r12 = r1->buffers;
					r15 = (dx_resource**)hl_aptr(r12,void*);
					r6 = 1;
					r7 = 1;
					r17 = 1;
					r16 = r15 + r17;
					directx_vs_set_constant_buffers(r6,r7,r16);
					goto label$2540$79;
				case 1:
					r12 = r1->buffers;
					r15 = (dx_resource**)hl_aptr(r12,void*);
					r6 = 1;
					r7 = 1;
					r17 = 1;
					r16 = r15 + r17;
					directx_ps_set_constant_buffers(r6,r7,r16);
			}
			label$2540$79:
			goto label$2540$349;
		case 2:
			r6 = -1;
			r7 = -1;
			r17 = -1;
			r18 = -1;
			r19 = 0;
			if( r2 == NULL ) hl_null_access();
			r20 = r2->texturesCount;
			label$2540$87:
			if( r19 >= r20 ) goto label$2540$244;
			r21 = r19;
			++r19;
			if( r3 == NULL ) hl_null_access();
			r23 = r3->tex;
			if( r23 == NULL ) hl_null_access();
			r24 = r23->length;
			if( ((unsigned)r21) < ((unsigned)r24) ) goto label$2540$98;
			r25 = NULL;
			goto label$2540$101;
			label$2540$98:
			r11 = r23->array;
			r26 = ((vdynamic**)(r11 + 1))[r21];
			r25 = (h3d__mat__Texture)r26;
			label$2540$101:
			if( !r25 ) goto label$2540$107;
			if( r25 == NULL ) hl_null_access();
			r28 = r25->_t;
			if( r28 ) goto label$2540$125;
			r29 = r25->realloc;
			if( r29 ) goto label$2540$125;
			label$2540$107:
			if( r2 == NULL ) hl_null_access();
			r24 = r2->textures2DCount;
			if( r21 >= r24 ) goto label$2540$123;
			r30 = (h3d__mat__$Defaults)global$543;
			r22 = r30->loadingTextureColor;
			r33 = 24;
			r32 = ((unsigned)r22) >> r33;
			r31 = (double)r32;
			r32 = 255;
			r34 = (double)r32;
			r31 = r31 / r34;
			r35 = hl_alloc_dynamic(&type$6);
			r35->v.d = r31;
			r36 = NULL;
			r27 = h3d_mat_Texture_fromColor(r22,r35,r36);
			r25 = r27;
			goto label$2540$125;
			label$2540$123:
			r27 = h3d_mat_Texture_defaultCubeTexture();
			r25 = r27;
			label$2540$125:
			if( !r25 ) goto label$2540$138;
			if( r25 == NULL ) hl_null_access();
			r28 = r25->_t;
			if( r28 ) goto label$2540$138;
			r29 = r25->realloc;
			if( !r29 ) goto label$2540$138;
			h3d_mat_Texture_alloc(r25);
			r29 = r25->realloc;
			if( r29 == NULL ) hl_null_access();
			r29->hasValue ? ((void (*)(vdynamic*))r29->fun)((vdynamic*)r29->value) : ((void (*)(void))r29->fun)();
			r37 = r0->hasDeviceError;
			if( !r37 ) goto label$2540$138;
			return;
			label$2540$138:
			if( r25 == NULL ) hl_null_access();
			r22 = r0->frame;
			r25->lastFrame = r22;
			r28 = r25->_t;
			if( r28 == NULL ) hl_null_access();
			r38 = hl_vfields(r28)[3] ? (*(dx_pointer**)(hl_vfields(r28)[3])) : (dx_pointer*)hl_dyn_getp(r28->value,240071535/*view*/,&type$53);
			if( r1 == NULL ) hl_null_access();
			r11 = r1->resources;
			r40 = ((dx_pointer**)(r11 + 1))[r21];
			if( r38 == r40 ) goto label$2540$154;
			r12 = r1->resources;
			((dx_pointer**)(r12 + 1))[r21] = r38;
			r7 = r21;
			r24 = 0;
			if( r6 >= r24 ) goto label$2540$154;
			r6 = r21;
			label$2540$154:
			r22 = r25->bits;
			r41 = r1->samplerBits;
			if( r41 == NULL ) hl_null_access();
			r33 = r41->length;
			if( ((unsigned)r21) < ((unsigned)r33) ) goto label$2540$161;
			r32 = 0;
			goto label$2540$165;
			label$2540$161:
			r10 = r41->bytes;
			r33 = 2;
			r33 = r21 << r33;
			r32 = *(int*)(r10 + r33);
			label$2540$165:
			if( r22 == r32 ) goto label$2540$243;
			r42 = r0->samplerStates;
			if( r42 == NULL ) hl_null_access();
			r26 = haxe_ds_IntMap_get(r42,r22);
			r39 = (dx_pointer*)hl_dyn_castp(&r26,&type$9,&type$53);
			if( r39 ) goto label$2540$228;
			r43 = (dx__SamplerDesc)hl_alloc_obj(dx__SamplerDesc__val);
			dx_SamplerDesc_new(r43);
			r44 = (h3d__impl__$DirectXDriver)global$461;
			r23 = r44->FILTER;
			if( r23 == NULL ) hl_null_access();
			r45 = r25->mipMap;
			if( r45 == NULL ) hl_null_access();
			r24 = HL__ENUM_INDEX__(r45);
			r32 = r23->length;
			if( ((unsigned)r24) < ((unsigned)r32) ) goto label$2540$183;
			r41 = NULL;
			goto label$2540$186;
			label$2540$183:
			r12 = r23->array;
			r26 = ((vdynamic**)(r12 + 1))[r24];
			r41 = (hl__types__ArrayBytes_Int)hl_dyn_castp(&r26,&type$9,&type$33);
			label$2540$186:
			if( r41 == NULL ) hl_null_access();
			r46 = r25->filter;
			if( r46 == NULL ) hl_null_access();
			r24 = HL__ENUM_INDEX__(r46);
			r32 = r41->length;
			if( ((unsigned)r24) < ((unsigned)r32) ) goto label$2540$194;
			r24 = 0;
			goto label$2540$198;
			label$2540$194:
			r10 = r41->bytes;
			r32 = 2;
			r32 = r24 << r32;
			r24 = *(int*)(r10 + r32);
			label$2540$198:
			r43->filter = r24;
			r44 = (h3d__impl__$DirectXDriver)global$461;
			r41 = r44->WRAP;
			if( r41 == NULL ) hl_null_access();
			r47 = r25->wrap;
			if( r47 == NULL ) hl_null_access();
			r24 = HL__ENUM_INDEX__(r47);
			r32 = r41->length;
			if( ((unsigned)r24) < ((unsigned)r32) ) goto label$2540$209;
			r24 = 0;
			goto label$2540$213;
			label$2540$209:
			r10 = r41->bytes;
			r32 = 2;
			r32 = r24 << r32;
			r24 = *(int*)(r10 + r32);
			label$2540$213:
			r43->addressW = r24;
			r43->addressV = r24;
			r43->addressU = r24;
			r24 = 0;
			r48 = (float)r24;
			r43->minLod = r48;
			r31 = 1e+030;
			r48 = (float)r31;
			r43->maxLod = r48;
			r40 = dx_Driver_createSamplerState(r43);
			r39 = r40;
			r42 = r0->samplerStates;
			if( r42 == NULL ) hl_null_access();
			if( r40 == NULL ) r26 = NULL; else {
				r26 = hl_alloc_dynamic(&type$53);
				r26->v.ptr = r40;
			}
			haxe_ds_IntMap_set(r42,r22,r26);
			label$2540$228:
			r41 = r1->samplerBits;
			if( r41 == NULL ) hl_null_access();
			r33 = r41->length;
			if( ((unsigned)r21) < ((unsigned)r33) ) goto label$2540$233;
			hl_types_ArrayBytes_Int___expand(r41,r21);
			label$2540$233:
			r10 = r41->bytes;
			r33 = 2;
			r33 = r21 << r33;
			*(int*)(r10 + r33) = r22;
			r12 = r1->samplers;
			((dx_pointer**)(r12 + 1))[r21] = r39;
			r18 = r21;
			r32 = 0;
			if( r17 >= r32 ) goto label$2540$243;
			r17 = r21;
			label$2540$243:
			goto label$2540$87;
			label$2540$244:
			if( r1 == NULL ) hl_null_access();
			r14 = r1->kind;
			if( r14 == NULL ) hl_null_access();
			r19 = HL__ENUM_INDEX__(r14);
			switch(r19) {
				default:
					goto label$2540$287;
				case 0:
					r20 = 0;
					if( r7 < r20 ) goto label$2540$259;
					r11 = r1->resources;
					r49 = (dx_pointer**)hl_aptr(r11,void*);
					r20 = r7 - r6;
					r21 = 1;
					r20 = r20 + r21;
					r50 = r49 + r6;
					directx_vs_set_shader_resources(r6,r20,r50);
					label$2540$259:
					r20 = 0;
					if( r18 < r20 ) goto label$2540$268;
					r11 = r1->samplers;
					r49 = (dx_pointer**)hl_aptr(r11,void*);
					r20 = r18 - r17;
					r21 = 1;
					r20 = r20 + r21;
					r50 = r49 + r17;
					directx_vs_set_samplers(r17,r20,r50);
					label$2540$268:
					goto label$2540$287;
				case 1:
					r20 = 0;
					if( r7 < r20 ) goto label$2540$278;
					r11 = r1->resources;
					r49 = (dx_pointer**)hl_aptr(r11,void*);
					r20 = r7 - r6;
					r21 = 1;
					r20 = r20 + r21;
					r50 = r49 + r6;
					directx_ps_set_shader_resources(r6,r20,r50);
					label$2540$278:
					r20 = 0;
					if( r18 < r20 ) goto label$2540$287;
					r11 = r1->samplers;
					r49 = (dx_pointer**)hl_aptr(r11,void*);
					r20 = r18 - r17;
					r21 = 1;
					r20 = r20 + r21;
					r50 = r49 + r17;
					directx_ps_set_samplers(r17,r20,r50);
			}
			label$2540$287:
			goto label$2540$349;
		case 3:
			r6 = -1;
			r7 = -1;
			r17 = 0;
			if( r2 == NULL ) hl_null_access();
			r18 = r2->bufferCount;
			label$2540$293:
			if( r17 >= r18 ) goto label$2540$326;
			r19 = r17;
			++r17;
			if( r3 == NULL ) hl_null_access();
			r23 = r3->buffers;
			if( r23 == NULL ) hl_null_access();
			r21 = r23->length;
			if( ((unsigned)r19) < ((unsigned)r21) ) goto label$2540$304;
			r53 = NULL;
			goto label$2540$307;
			label$2540$304:
			r11 = r23->array;
			r26 = ((vdynamic**)(r11 + 1))[r19];
			r53 = (h3d__Buffer)r26;
			label$2540$307:
			if( r53 == NULL ) hl_null_access();
			r52 = r53->buffer;
			if( r52 == NULL ) hl_null_access();
			r51 = r52->vbuf;
			if( r51 == NULL ) hl_null_access();
			r8 = hl_vfields(r51)[1] ? (*(dx_resource**)(hl_vfields(r51)[1])) : (dx_resource*)hl_dyn_getp(r51->value,5691744/*res*/,&type$52);
			r21 = 2;
			r20 = r19 + r21;
			if( r1 == NULL ) hl_null_access();
			r11 = r1->buffers;
			r54 = ((dx_resource**)(r11 + 1))[r20];
			if( r8 == r54 ) goto label$2540$325;
			r12 = r1->buffers;
			((dx_resource**)(r12 + 1))[r20] = r8;
			r22 = 0;
			if( r6 >= r22 ) goto label$2540$324;
			r6 = r20;
			label$2540$324:
			r7 = r20;
			label$2540$325:
			goto label$2540$293;
			label$2540$326:
			r18 = 0;
			if( r7 < r18 ) goto label$2540$349;
			if( r1 == NULL ) hl_null_access();
			r14 = r1->kind;
			if( r14 == NULL ) hl_null_access();
			r17 = HL__ENUM_INDEX__(r14);
			switch(r17) {
				default:
					goto label$2540$349;
				case 0:
					r11 = r1->buffers;
					r15 = (dx_resource**)hl_aptr(r11,void*);
					r18 = r7 - r6;
					r19 = 1;
					r18 = r18 + r19;
					r16 = r15 + r6;
					directx_vs_set_constant_buffers(r6,r18,r16);
					goto label$2540$349;
				case 1:
					r11 = r1->buffers;
					r15 = (dx_resource**)hl_aptr(r11,void*);
					r18 = r7 - r6;
					r19 = 1;
					r18 = r18 + r19;
					r16 = r15 + r6;
					directx_ps_set_constant_buffers(r6,r18,r16);
			}
	}
	label$2540$349:
	return;
}

void h3d_impl_DirectXDriver_draw(h3d__impl__DirectXDriver r0,vvirtual* r1,int r2,int r3) {
	vvirtual *r6;
	bool r5;
	dx_resource *r7;
	int r8, r9, r10;
	r5 = r0->allowDraw;
	if( r5 ) goto label$2541$3;
	return;
	label$2541$3:
	r6 = r0->currentIndex;
	if( r6 == r1 || (r6 && r1 && r6->value && r1->value && r6->value == r1->value) ) goto label$2541$16;
	r0->currentIndex = r1;
	if( r1 == NULL ) hl_null_access();
	r7 = hl_vfields(r1)[2] ? (*(dx_resource**)(hl_vfields(r1)[2])) : (dx_resource*)hl_dyn_getp(r1->value,5691744/*res*/,&type$52);
	r8 = hl_vfields(r1)[0] ? (*(int*)(hl_vfields(r1)[0])) : (int)hl_dyn_geti(r1->value,18283536/*bits*/,&type$3);
	r9 = 2;
	if( r8 == r9 ) goto label$2541$13;
	r5 = false;
	goto label$2541$14;
	label$2541$13:
	r5 = true;
	label$2541$14:
	r8 = 0;
	directx_ia_set_index_buffer(r7,r5,r8);
	label$2541$16:
	r9 = 3;
	r8 = r3 * r9;
	r10 = 0;
	directx_draw_indexed(r8,r2,r10);
	return;
}

void h3d_impl_DirectXDriver_allocInstanceBuffer(h3d__impl__DirectXDriver r0,h3d__impl__InstanceBuffer r1,haxe__io__Bytes r2) {
	dx_resource *r3;
	vdynamic *r11;
	vbyte *r10;
	int r4, r5, r6, r7, r8, r9;
	if( r1 == NULL ) hl_null_access();
	r4 = r1->commandCount;
	r5 = 5;
	r4 = r4 * r5;
	r5 = 4;
	r4 = r4 * r5;
	r5 = 0;
	r6 = 128;
	r7 = 0;
	r8 = 16;
	r9 = 4;
	if( r2 == NULL ) hl_null_access();
	r10 = r2->b;
	r3 = directx_create_buffer(r4,r5,r6,r7,r8,r9,r10);
	if( r3 == NULL ) r11 = NULL; else {
		r11 = hl_alloc_dynamic(&type$52);
		r11->v.ptr = r3;
	}
	r1->data = r11;
	return;
}

void h3d_impl_DirectXDriver_disposeInstanceBuffer(h3d__impl__DirectXDriver r0,h3d__impl__InstanceBuffer r1) {
	dx_resource *r4;
	vdynamic *r3;
	if( r1 == NULL ) hl_null_access();
	r3 = r1->data;
	r4 = (dx_resource*)hl_dyn_castp(&r3,&type$9,&type$52);
	directx_release_resource(r4);
	r3 = NULL;
	r1->data = r3;
	return;
}

void h3d_impl_DirectXDriver_drawInstanced(h3d__impl__DirectXDriver r0,vvirtual* r1,h3d__impl__InstanceBuffer r2) {
	vvirtual *r6;
	bool r4;
	dx_resource *r7;
	vdynamic *r5;
	int r8, r9;
	r4 = r0->allowDraw;
	if( r4 ) goto label$2544$3;
	return;
	label$2544$3:
	r6 = r0->currentIndex;
	if( r6 == r1 || (r6 && r1 && r6->value && r1->value && r6->value == r1->value) ) goto label$2544$16;
	r0->currentIndex = r1;
	if( r1 == NULL ) hl_null_access();
	r7 = hl_vfields(r1)[2] ? (*(dx_resource**)(hl_vfields(r1)[2])) : (dx_resource*)hl_dyn_getp(r1->value,5691744/*res*/,&type$52);
	r8 = hl_vfields(r1)[0] ? (*(int*)(hl_vfields(r1)[0])) : (int)hl_dyn_geti(r1->value,18283536/*bits*/,&type$3);
	r9 = 2;
	if( r8 == r9 ) goto label$2544$13;
	r4 = false;
	goto label$2544$14;
	label$2544$13:
	r4 = true;
	label$2544$14:
	r8 = 0;
	directx_ia_set_index_buffer(r7,r4,r8);
	label$2544$16:
	if( r2 == NULL ) hl_null_access();
	r5 = r2->data;
	r7 = (dx_resource*)hl_dyn_castp(&r5,&type$9,&type$52);
	r8 = 0;
	directx_draw_indexed_instanced_indirect(r7,r8);
	return;
}

void h3d_impl_DirectXDriver_new(h3d__impl__DirectXDriver r0) {
	hl__types__ArrayObj r1;
	hl_type *r7;
	dx__$Window r10;
	bool r4;
	hl__types__ArrayBytes_Int r8;
	dx__ResourceBox r9;
	dx__Window r12;
	vclosure *r14;
	vdynamic *r13;
	varray *r6;
	vbyte *r5;
	int r3, r11;
	r1 = (hl__types__ArrayObj)hl_alloc_obj(hl__types__ArrayObj__val);
	hl_types_ArrayObj_new(r1);
	r0->tmpTextures = r1;
	r3 = 45;
	r0->depthStencilFormat = r3;
	r3 = 28;
	r0->backBufferFormat = r3;
	r4 = false;
	r0->hasScissor = r4;
	r3 = 32;
	r5 = hl_alloc_bytes(r3);
	r0->blendFactors = r5;
	r4 = false;
	r0->allowDraw = r4;
	r3 = 1;
	r0->targetsCount = r3;
	r3 = -1;
	r0->currentColorMask = r3;
	r3 = 0;
	r0->currentStencilRef = r3;
	r3 = -1;
	r0->currentStencilOpBits = r3;
	r3 = -1;
	r0->currentStencilMaskBits = r3;
	r3 = -1;
	r0->currentMaterialBits = r3;
	r3 = 16;
	r7 = &type$52;
	r6 = hl_alloc_array(r7,r3);
	r0->currentVBuffers = r6;
	r3 = 16;
	r7 = &type$53;
	r6 = hl_alloc_array(r7,r3);
	r0->currentTargets = r6;
	r3 = 0;
	r5 = hl_alloc_bytes(r3);
	r3 = 0;
	r3 = 0;
	r8 = hl_types_ArrayBase_allocI32(r5,r3);
	r0->offsets = r8;
	r3 = 0;
	r5 = hl_alloc_bytes(r3);
	r3 = 0;
	r3 = 0;
	r8 = hl_types_ArrayBase_allocI32(r5,r3);
	r0->strides = r8;
	r9 = (dx__ResourceBox)hl_alloc_obj(dx__ResourceBox__val);
	dx_ResourceBox_new(r9);
	r0->box = r9;
	r3 = 128;
	r5 = hl_alloc_bytes(r3);
	r0->rects = r5;
	r3 = 192;
	r5 = hl_alloc_bytes(r3);
	r0->viewport = r5;
	r4 = false;
	r0->hasDeviceError = r4;
	r10 = (dx__$Window)global$33;
	r1 = r10->windows;
	if( r1 == NULL ) hl_null_access();
	r3 = 0;
	r11 = r1->length;
	if( ((unsigned)r3) < ((unsigned)r11) ) goto label$2548$65;
	r12 = NULL;
	goto label$2548$68;
	label$2548$65:
	r6 = r1->array;
	r13 = ((vdynamic**)(r6 + 1))[r3];
	r12 = (dx__Window)r13;
	label$2548$68:
	r0->window = r12;
	r14 = hl_alloc_closure_ptr(&type$2105,h3d_impl_DirectXDriver_onDXError,r0);
	directx_set_error_handler(r14);
	h3d_impl_DirectXDriver_reset(r0);
	return;
}

