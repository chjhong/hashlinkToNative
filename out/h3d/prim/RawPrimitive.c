// Generated by HLC 4.0.0 (HL v4)
#include <hl/code.h>

void h3d_prim_RawPrimitive_alloc(h3d__prim__RawPrimitive r0,h3d__Engine r1) {
	String r4, r5;
	hl__types__ArrayObj r7;
	vvirtual *r6, *r18;
	venum *r12;
	hl_type *r9;
	bool r14;
	hl__types__ArrayBytes_hl_UI16 r11;
	hl__types__ArrayBytes_Single r17;
	double r19, r20;
	h3d__Buffer r16;
	vclosure *r3;
	int *r23, *r24;
	vdynamic *r13;
	h3d__Indexes r22;
	int r10, r15, r21;
	varray *r8;
	r3 = r0->onContextLost;
	if( r3 ) goto label$2891$6;
	r4 = (String)global$716;
	r5 = Std_string(((vdynamic*)r0));
	r4 = String___add__(r4,r5);
	hl_throw((vdynamic*)r4);
	label$2891$6:
	r3 = r0->onContextLost;
	if( r3 == NULL ) hl_null_access();
	r6 = r3->hasValue ? ((vvirtual* (*)(vdynamic*))r3->fun)((vdynamic*)r3->value) : ((vvirtual* (*)(void))r3->fun)();
	r9 = &type$496;
	r10 = 0;
	r8 = hl_alloc_array(r9,r10);
	r7 = hl_types_ArrayObj_alloc(r8);
	if( r6 == NULL ) hl_null_access();
	r11 = hl_vfields(r6)[0] ? (*(hl__types__ArrayBytes_hl_UI16*)(hl_vfields(r6)[0])) : (hl__types__ArrayBytes_hl_UI16)hl_dyn_getp(r6->value,95562612/*ibuf*/,&type$35);
	if( r11 ) goto label$2891$24;
	if( r7 == NULL ) hl_null_access();
	r13 = hl_vfields(r6)[1] ? (*(vdynamic**)(hl_vfields(r6)[1])) : (vdynamic*)hl_dyn_getp(r6->value,501708502/*quads*/,&type$140);
	r14 = r13 ? r13->v.b : 0;
	if( !r14 ) goto label$2891$22;
	r12 = (venum*)global$423;
	goto label$2891$23;
	label$2891$22:
	r12 = (venum*)global$713;
	label$2891$23:
	r10 = hl_types_ArrayObj_push(r7,((vdynamic*)r12));
	label$2891$24:
	r10 = hl_vfields(r6)[2] ? (*(int*)(hl_vfields(r6)[2])) : (int)hl_dyn_geti(r6->value,288366617/*stride*/,&type$3);
	r15 = 8;
	if( r10 >= r15 ) goto label$2891$30;
	if( r7 == NULL ) hl_null_access();
	r12 = (venum*)global$425;
	r10 = hl_types_ArrayObj_push(r7,((vdynamic*)r12));
	label$2891$30:
	r17 = hl_vfields(r6)[3] ? (*(hl__types__ArrayBytes_Single*)(hl_vfields(r6)[3])) : (hl__types__ArrayBytes_Single)hl_dyn_getp(r6->value,239726983/*vbuf*/,&type$37);
	r10 = hl_vfields(r6)[2] ? (*(int*)(hl_vfields(r6)[2])) : (int)hl_dyn_geti(r6->value,288366617/*stride*/,&type$3);
	r18 = NULL;
	r16 = h3d_Buffer_ofFloats(r17,r10,r7,r18);
	r0->buffer = r16;
	r16 = r0->buffer;
	if( r16 == NULL ) hl_null_access();
	r10 = r16->vertices;
	r0->vcount = r10;
	r11 = hl_vfields(r6)[0] ? (*(hl__types__ArrayBytes_hl_UI16*)(hl_vfields(r6)[0])) : (hl__types__ArrayBytes_hl_UI16)hl_dyn_getp(r6->value,95562612/*ibuf*/,&type$35);
	if( !r11 ) goto label$2891$50;
	r11 = hl_vfields(r6)[0] ? (*(hl__types__ArrayBytes_hl_UI16*)(hl_vfields(r6)[0])) : (hl__types__ArrayBytes_hl_UI16)hl_dyn_getp(r6->value,95562612/*ibuf*/,&type$35);
	if( r11 == NULL ) hl_null_access();
	r10 = r11->length;
	r19 = (double)r10;
	r10 = 3;
	r20 = (double)r10;
	r19 = r19 / r20;
	r15 = (int)r19;
	goto label$2891$63;
	label$2891$50:
	r13 = hl_vfields(r6)[1] ? (*(vdynamic**)(hl_vfields(r6)[1])) : (vdynamic*)hl_dyn_getp(r6->value,501708502/*quads*/,&type$140);
	r14 = r13 ? r13->v.b : 0;
	if( !r14 ) goto label$2891$57;
	r15 = r0->vcount;
	r21 = 1;
	r15 = r15 >> r21;
	goto label$2891$63;
	label$2891$57:
	r15 = r0->vcount;
	r19 = (double)r15;
	r15 = 3;
	r20 = (double)r15;
	r19 = r19 / r20;
	r15 = (int)r19;
	label$2891$63:
	r0->tcount = r15;
	r11 = hl_vfields(r6)[0] ? (*(hl__types__ArrayBytes_hl_UI16*)(hl_vfields(r6)[0])) : (hl__types__ArrayBytes_hl_UI16)hl_dyn_getp(r6->value,95562612/*ibuf*/,&type$35);
	if( !r11 ) goto label$2891$72;
	r11 = hl_vfields(r6)[0] ? (*(hl__types__ArrayBytes_hl_UI16*)(hl_vfields(r6)[0])) : (hl__types__ArrayBytes_hl_UI16)hl_dyn_getp(r6->value,95562612/*ibuf*/,&type$35);
	r23 = NULL;
	r24 = NULL;
	r22 = h3d_Indexes_alloc(r11,r23,r24);
	r0->indexes = r22;
	goto label$2891$79;
	label$2891$72:
	r22 = r0->indexes;
	if( !r22 ) goto label$2891$79;
	r22 = r0->indexes;
	if( r22 == NULL ) hl_null_access();
	h3d_Indexes_dispose(r22);
	r22 = NULL;
	r0->indexes = r22;
	label$2891$79:
	return;
}

h3d__col__Bounds h3d_prim_RawPrimitive_getBounds(h3d__prim__RawPrimitive r0) {
	String r2, r3;
	h3d__col__Bounds r1;
	r1 = r0->bounds;
	if( r1 ) goto label$2892$6;
	r2 = (String)global$717;
	r3 = Std_string(((vdynamic*)r0));
	r2 = String___add__(r2,r3);
	hl_throw((vdynamic*)r2);
	label$2892$6:
	r1 = r0->bounds;
	return r1;
}

int h3d_prim_RawPrimitive_triCount(h3d__prim__RawPrimitive r0) {
	int r1;
	r1 = r0->tcount;
	return r1;
}

int h3d_prim_RawPrimitive_vertexCount(h3d__prim__RawPrimitive r0) {
	int r1;
	r1 = r0->vcount;
	return r1;
}

void h3d_prim_RawPrimitive_new(h3d__prim__RawPrimitive r0,vvirtual* r1,bool* r2) {
	bool r3;
	h3d__col__Bounds r5;
	h3d__Engine r7;
	vclosure *r4;
	if( r2 ) goto label$2895$3;
	r3 = false;
	goto label$2895$4;
	label$2895$3:
	r3 = *r2;
	label$2895$4:
	r4 = hl_alloc_closure_ptr(&type$2525,fun$3015,r1);
	r0->onContextLost = r4;
	if( r1 == NULL ) hl_null_access();
	r5 = hl_vfields(r1)[0] ? (*(h3d__col__Bounds*)(hl_vfields(r1)[0])) : (h3d__col__Bounds)hl_dyn_getp(r1->value,102598660/*bounds*/,&type$251);
	r0->bounds = r5;
	r7 = NULL;
	h3d_prim_RawPrimitive_alloc(r0,r7);
	if( r3 ) goto label$2895$14;
	r4 = NULL;
	r0->onContextLost = r4;
	label$2895$14:
	return;
}

