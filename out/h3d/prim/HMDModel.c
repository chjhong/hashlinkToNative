// Generated by HLC 4.0.0 (HL v4)
#include <hl/code.h>

int h3d_prim_HMDModel_triCount(h3d__prim__HMDModel r0) {
	hxd__fmt__hmd__Geometry r3;
	double r1, r4;
	int r2;
	r3 = r0->data;
	if( r3 == NULL ) hl_null_access();
	r2 = hxd_fmt_hmd_Geometry_get_indexCount(r3);
	r1 = (double)r2;
	r2 = 3;
	r4 = (double)r2;
	r1 = r1 / r4;
	r2 = (int)r1;
	return r2;
}

int h3d_prim_HMDModel_vertexCount(h3d__prim__HMDModel r0) {
	hxd__fmt__hmd__Geometry r2;
	int r1;
	r2 = r0->data;
	if( r2 == NULL ) hl_null_access();
	r1 = r2->vertexCount;
	return r1;
}

h3d__col__Bounds h3d_prim_HMDModel_getBounds(h3d__prim__HMDModel r0) {
	h3d__col__Bounds r1;
	hxd__fmt__hmd__Geometry r2;
	r2 = r0->data;
	if( r2 == NULL ) hl_null_access();
	r1 = r2->bounds;
	return r1;
}

void h3d_prim_HMDModel_selectMaterial(h3d__prim__HMDModel r0,int r1) {
	r0->curMaterial = r1;
	return;
}

hxd__fmt__hmd__GeometryBuffer h3d_prim_HMDModel_getDataBuffers(h3d__prim__HMDModel r0,hl__types__ArrayObj r1,hl__types__ArrayObj r2,vdynamic* r3) {
	hxd__fmt__hmd__Geometry r6;
	hxd__fmt__hmd__GeometryBuffer r4;
	hxd__fmt__hmd__Library r5;
	r5 = r0->lib;
	if( r5 == NULL ) hl_null_access();
	r6 = r0->data;
	r4 = hxd_fmt_hmd_Library_getBuffers(r5,r6,r1,r2,r3);
	return r4;
}

void h3d_prim_HMDModel_loadSkin(h3d__prim__HMDModel r0,h3d__anim__Skin r1) {
	hxd__fmt__hmd__Geometry r4;
	hxd__fmt__hmd__Library r3;
	r3 = r0->lib;
	if( r3 == NULL ) hl_null_access();
	r4 = r0->data;
	hxd_fmt_hmd_Library_loadSkin(r3,r4,r1);
	return;
}

void h3d_prim_HMDModel_addAlias(h3d__prim__HMDModel r0,String r1,String r2,int* r3) {
	vvirtual *r7;
	haxe__ds__StringMap r6;
	int r4;
	if( r3 ) goto label$2945$3;
	r4 = 0;
	goto label$2945$4;
	label$2945$3:
	r4 = *r3;
	label$2945$4:
	r6 = r0->bufferAliases;
	if( r6 == NULL ) hl_null_access();
	r7 = hl_alloc_virtual(&type$2490);
	if( hl_vfields(r7)[1] ) *(String*)(hl_vfields(r7)[1]) = (String)r2; else hl_dyn_setp(r7->value,204206281/*realName*/,&type$13,r2);
	if( hl_vfields(r7)[0] ) *(int*)(hl_vfields(r7)[0]) = (int)r4; else hl_dyn_seti(r7->value,4167970/*offset*/,&type$3,r4);
	haxe_ds_StringMap_set(r6,r1,((vdynamic*)r7));
	return;
}

void h3d_prim_HMDModel_alloc(h3d__prim__HMDModel r0,h3d__Engine r1) {
	String r27, r36, r41;
	bool *r23;
	hxd__fs__FileEntry r9;
	haxe__ds__StringMap r31;
	vvirtual *r8, *r37;
	hl__types__ArrayObj r7;
	hxd__res__Resource r10;
	bool r32;
	haxe__io__Bytes r12, r13;
	haxe__ds__IntMap r38;
	hxd__fmt__hmd__GeometryFormat r24;
	hl__types__ArrayBytes_Int r15, r18;
	hxd__fmt__hmd__Geometry r5;
	h3d__BufferOffset r40;
	vclosure *r33, *r35;
	double r19, r20;
	h3d__Buffer r3;
	int *r28;
	vdynamic *r25, *r34, *r39;
	h3d__impl__ManagedBuffer r42;
	varray *r26;
	h3d__Indexes r22;
	vbyte *r16;
	hxd__fmt__hmd__Library r11;
	int r4, r6, r14, r17, r21, r29, r30;
	h3d_prim_MeshPrimitive_dispose(((h3d__prim__MeshPrimitive)r0));
	r3 = (h3d__Buffer)hl_alloc_obj(h3d__Buffer__val);
	r5 = r0->data;
	if( r5 == NULL ) hl_null_access();
	r4 = r5->vertexCount;
	r5 = r0->data;
	if( r5 == NULL ) hl_null_access();
	r6 = r5->vertexStride;
	r7 = NULL;
	r8 = NULL;
	h3d_Buffer_new(r3,r4,r6,r7,r8);
	r0->buffer = r3;
	r11 = r0->lib;
	if( r11 == NULL ) hl_null_access();
	r10 = r11->resource;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->entry;
	if( r9 == NULL ) hl_null_access();
	((void (*)(hxd__fs__FileEntry))r9->$type->vobj_proto[2])(r9);
	r4 = r0->dataPosition;
	r5 = r0->data;
	if( r5 == NULL ) hl_null_access();
	r6 = r5->vertexPosition;
	r4 = r4 + r6;
	((void (*)(hxd__fs__FileEntry,int))r9->$type->vobj_proto[3])(r9,r4);
	r5 = r0->data;
	if( r5 == NULL ) hl_null_access();
	r4 = r5->vertexCount;
	r5 = r0->data;
	if( r5 == NULL ) hl_null_access();
	r6 = r5->vertexStride;
	r4 = r4 * r6;
	r6 = 4;
	r4 = r4 * r6;
	r12 = haxe_io_Bytes_alloc(r4);
	r6 = 0;
	((void (*)(hxd__fs__FileEntry,haxe__io__Bytes,int,int))r9->$type->vobj_proto[5])(r9,r12,r6,r4);
	r3 = r0->buffer;
	if( r3 == NULL ) hl_null_access();
	r6 = 0;
	r5 = r0->data;
	if( r5 == NULL ) hl_null_access();
	r14 = r5->vertexCount;
	h3d_Buffer_uploadBytes(r3,r12,r6,r14);
	r6 = 0;
	r0->indexCount = r6;
	r6 = 0;
	r16 = hl_alloc_bytes(r6);
	r6 = 0;
	r6 = 0;
	r15 = hl_types_ArrayBase_allocI32(r16,r6);
	r0->indexesTriPos = r15;
	r6 = 0;
	r5 = r0->data;
	if( r5 == NULL ) hl_null_access();
	r15 = r5->indexCounts;
	label$2946$56:
	if( r15 == NULL ) hl_null_access();
	r17 = r15->length;
	if( r6 >= r17 ) goto label$2946$83;
	r14 = r6;
	++r6;
	r17 = r15->length;
	if( ((unsigned)r14) < ((unsigned)r17) ) goto label$2946$66;
	r14 = 0;
	goto label$2946$70;
	label$2946$66:
	r16 = r15->bytes;
	r17 = 2;
	r17 = r14 << r17;
	r14 = *(int*)(r16 + r17);
	label$2946$70:
	r17 = r0->indexCount;
	r19 = (double)r17;
	r17 = 3;
	r20 = (double)r17;
	r19 = r19 / r20;
	r18 = r0->indexesTriPos;
	if( r18 == NULL ) hl_null_access();
	r17 = (int)r19;
	r17 = hl_types_ArrayBytes_Int_push(r18,r17);
	r17 = r0->indexCount;
	r17 = r17 + r14;
	r0->indexCount = r17;
	goto label$2946$56;
	label$2946$83:
	r22 = (h3d__Indexes)hl_alloc_obj(h3d__Indexes__val);
	r6 = r0->indexCount;
	r23 = NULL;
	h3d_Indexes_new(r22,r6,r23);
	r0->indexes = r22;
	if( r9 == NULL ) hl_null_access();
	r5 = r0->data;
	if( r5 == NULL ) hl_null_access();
	r6 = r5->indexPosition;
	r5 = r0->data;
	if( r5 == NULL ) hl_null_access();
	r14 = r5->vertexPosition;
	r14 = r14 + r4;
	r6 = r6 - r14;
	((void (*)(hxd__fs__FileEntry,int))r9->$type->vobj_proto[3])(r9,r6);
	r6 = r0->indexCount;
	r14 = 2;
	r6 = r6 * r14;
	r13 = haxe_io_Bytes_alloc(r6);
	r6 = 0;
	r14 = r0->indexCount;
	r17 = 2;
	r14 = r14 * r17;
	((void (*)(hxd__fs__FileEntry,haxe__io__Bytes,int,int))r9->$type->vobj_proto[5])(r9,r13,r6,r14);
	r22 = r0->indexes;
	if( r22 == NULL ) hl_null_access();
	r6 = 0;
	r14 = r0->indexCount;
	h3d_Indexes_uploadBytes(r22,r13,r6,r14);
	((void (*)(hxd__fs__FileEntry))r9->$type->vobj_proto[6])(r9);
	r6 = 0;
	r14 = 0;
	r5 = r0->data;
	if( r5 == NULL ) hl_null_access();
	r7 = r5->vertexFormat;
	label$2946$118:
	if( r7 == NULL ) hl_null_access();
	r21 = r7->length;
	if( r14 >= r21 ) goto label$2946$142;
	r21 = r7->length;
	if( ((unsigned)r14) < ((unsigned)r21) ) goto label$2946$126;
	r24 = NULL;
	goto label$2946$129;
	label$2946$126:
	r26 = r7->array;
	r25 = ((vdynamic**)(r26 + 1))[r14];
	r24 = (hxd__fmt__hmd__GeometryFormat)r25;
	label$2946$129:
	++r14;
	if( r24 == NULL ) hl_null_access();
	r27 = r24->name;
	r3 = r0->buffer;
	r17 = r6;
	r28 = &r17;
	h3d_prim_MeshPrimitive_addBuffer(((h3d__prim__MeshPrimitive)r0),r27,r3,r28);
	r29 = r24->format;
	r30 = 7;
	r29 = r29 & r30;
	r21 = r6 + r29;
	r6 = r21;
	goto label$2946$118;
	label$2946$142:
	r27 = r0->normalsRecomputed;
	if( !r27 ) goto label$2946$146;
	r27 = r0->normalsRecomputed;
	h3d_prim_HMDModel_recomputeNormals(r0,r27);
	label$2946$146:
	r31 = r0->bufferAliases;
	if( r31 == NULL ) hl_null_access();
	r25 = haxe_ds_StringMap_keys(r31);
	label$2946$149:
	if( r25 == NULL ) hl_null_access();
	r33 = (vclosure*)hl_dyn_getp((vdynamic*)r25,407283053/*hasNext*/,&type$118);
	if( r33 == NULL ) hl_null_access();
	r32 = r33->hasValue ? ((bool (*)(vdynamic*))r33->fun)((vdynamic*)r33->value) : ((bool (*)(void))r33->fun)();
	if( !r32 ) goto label$2946$204;
	r35 = (vclosure*)hl_dyn_getp((vdynamic*)r25,151160317/*next*/,&type$378);
	if( r35 == NULL ) hl_null_access();
	r27 = r35->hasValue ? ((String (*)(vdynamic*))r35->fun)((vdynamic*)r35->value) : ((String (*)(void))r35->fun)();
	r31 = r0->bufferAliases;
	if( r31 == NULL ) hl_null_access();
	r34 = haxe_ds_StringMap_get(r31,r27);
	r37 = hl_to_virtual(&type$2490,(vdynamic*)r34);
	r38 = r0->bufferCache;
	if( r38 == NULL ) hl_null_access();
	if( r37 == NULL ) hl_null_access();
	r36 = hl_vfields(r37)[1] ? (*(String*)(hl_vfields(r37)[1])) : (String)hl_dyn_getp(r37->value,204206281/*realName*/,&type$13);
	r39 = hxsl_Globals_allocID(r36);
	r14 = r39 ? r39->v.i : 0;
	r34 = haxe_ds_IntMap_get(r38,r14);
	r40 = (h3d__BufferOffset)r34;
	if( r40 ) goto label$2946$178;
	r36 = (String)global$680;
	r41 = hl_vfields(r37)[1] ? (*(String*)(hl_vfields(r37)[1])) : (String)hl_dyn_getp(r37->value,204206281/*realName*/,&type$13);
	r36 = String___add__(r36,r41);
	r41 = (String)global$698;
	r36 = String___add__(r36,r41);
	r36 = String___add__(r36,r27);
	hl_throw((vdynamic*)r36);
	label$2946$178:
	if( r40 == NULL ) hl_null_access();
	r14 = r40->offset;
	r21 = hl_vfields(r37)[0] ? (*(int*)(hl_vfields(r37)[0])) : (int)hl_dyn_geti(r37->value,4167970/*offset*/,&type$3);
	r14 = r14 + r21;
	r3 = r40->buffer;
	if( r3 == NULL ) hl_null_access();
	r42 = r3->buffer;
	if( r42 == NULL ) hl_null_access();
	r21 = r42->stride;
	if( r21 >= r14 ) goto label$2946$197;
	r36 = (String)global$699;
	r36 = String___add__(r36,r27);
	r41 = (String)global$700;
	r36 = String___add__(r36,r41);
	r41 = hl_vfields(r37)[1] ? (*(String*)(hl_vfields(r37)[1])) : (String)hl_dyn_getp(r37->value,204206281/*realName*/,&type$13);
	r36 = String___add__(r36,r41);
	r41 = (String)global$701;
	r36 = String___add__(r36,r41);
	hl_throw((vdynamic*)r36);
	label$2946$197:
	r3 = r40->buffer;
	r14 = r40->offset;
	r21 = hl_vfields(r37)[0] ? (*(int*)(hl_vfields(r37)[0])) : (int)hl_dyn_geti(r37->value,4167970/*offset*/,&type$3);
	r14 = r14 + r21;
	r28 = &r14;
	h3d_prim_MeshPrimitive_addBuffer(((h3d__prim__MeshPrimitive)r0),r27,r3,r28);
	goto label$2946$149;
	label$2946$204:
	return;
}

void h3d_prim_HMDModel_recomputeNormals(h3d__prim__HMDModel r0,String r1) {
	String r3;
	vvirtual *r43;
	hl__types__ArrayObj r7, r12;
	hl_type *r9;
	bool r18, r37;
	hl__types__ArrayBytes_hl_UI16 r38, r39;
	hxd__fmt__hmd__GeometryFormat r11;
	hl__types__ArrayBytes_Single r20;
	hl__types__ArrayBytes_Int r14;
	hxd__fmt__hmd__Geometry r6;
	h3d__prim__Polygon r41;
	unsigned short r40;
	float r22;
	h3d__Buffer r42;
	double r24, r26, r28, r35, r36;
	h3d__col__Point r19, r33;
	hxd__fmt__hmd__GeometryBuffer r4;
	int *r44;
	double *r25, *r27, *r29;
	vdynamic *r13, *r34;
	vbyte *r23;
	int r10, r15, r16, r17, r21, r30, r31, r32;
	varray *r8;
	hxd__fmt__hmd__Library r5;
	if( r1 ) goto label$2947$3;
	r3 = (String)global$702;
	r1 = r3;
	label$2947$3:
	r5 = r0->lib;
	if( r5 == NULL ) hl_null_access();
	r6 = r0->data;
	r9 = &type$2492;
	r10 = 1;
	r8 = hl_alloc_array(r9,r10);
	r11 = (hxd__fmt__hmd__GeometryFormat)hl_alloc_obj(hxd__fmt__hmd__GeometryFormat__val);
	r3 = (String)global$703;
	r10 = 3;
	hxd_fmt_hmd_GeometryFormat_new(r11,r3,r10);
	r10 = 0;
	((hxd__fmt__hmd__GeometryFormat*)(r8 + 1))[r10] = r11;
	r7 = hl_types_ArrayObj_alloc(r8);
	r12 = NULL;
	r13 = NULL;
	r4 = hxd_fmt_hmd_Library_getBuffers(r5,r6,r7,r12,r13);
	r14 = (hl__types__ArrayBytes_Int)hl_alloc_obj(hl__types__ArrayBytes_Int__val);
	hl_types_ArrayBytes_Int_new(r14);
	r9 = &type$246;
	r10 = 0;
	r8 = hl_alloc_array(r9,r10);
	r7 = hl_types_ArrayObj_alloc(r8);
	r10 = 0;
	r6 = r0->data;
	if( r6 == NULL ) hl_null_access();
	r15 = r6->vertexCount;
	label$2947$29:
	if( r10 >= r15 ) goto label$2947$122;
	r16 = r10;
	++r10;
	r18 = false;
	r19 = (h3d__col__Point)hl_alloc_obj(h3d__col__Point__val);
	if( r4 == NULL ) hl_null_access();
	r20 = r4->vertexes;
	if( r20 == NULL ) hl_null_access();
	r21 = 3;
	r17 = r16 * r21;
	r21 = r20->length;
	if( ((unsigned)r17) < ((unsigned)r21) ) goto label$2947$44;
	r22 = 0.;
	goto label$2947$48;
	label$2947$44:
	r23 = r20->bytes;
	r21 = 2;
	r21 = r17 << r21;
	r22 = *(float*)(r23 + r21);
	label$2947$48:
	r24 = (double)r22;
	r25 = &r24;
	r20 = r4->vertexes;
	if( r20 == NULL ) hl_null_access();
	r21 = 3;
	r17 = r16 * r21;
	r21 = 1;
	r17 = r17 + r21;
	r21 = r20->length;
	if( ((unsigned)r17) < ((unsigned)r21) ) goto label$2947$60;
	r22 = 0.;
	goto label$2947$64;
	label$2947$60:
	r23 = r20->bytes;
	r21 = 2;
	r21 = r17 << r21;
	r22 = *(float*)(r23 + r21);
	label$2947$64:
	r26 = (double)r22;
	r27 = &r26;
	r20 = r4->vertexes;
	if( r20 == NULL ) hl_null_access();
	r21 = 3;
	r17 = r16 * r21;
	r21 = 2;
	r17 = r17 + r21;
	r21 = r20->length;
	if( ((unsigned)r17) < ((unsigned)r21) ) goto label$2947$76;
	r22 = 0.;
	goto label$2947$80;
	label$2947$76:
	r23 = r20->bytes;
	r21 = 2;
	r21 = r17 << r21;
	r22 = *(float*)(r23 + r21);
	label$2947$80:
	r28 = (double)r22;
	r29 = &r28;
	h3d_col_Point_new(r19,r25,r27,r29);
	r17 = 0;
	if( r7 == NULL ) hl_null_access();
	r21 = r7->length;
	label$2947$86:
	if( r17 >= r21 ) goto label$2947$115;
	r30 = r17;
	++r17;
	if( r7 == NULL ) hl_null_access();
	r32 = r7->length;
	if( ((unsigned)r30) < ((unsigned)r32) ) goto label$2947$95;
	r33 = NULL;
	goto label$2947$98;
	label$2947$95:
	r8 = r7->array;
	r34 = ((vdynamic**)(r8 + 1))[r30];
	r33 = (h3d__col__Point)r34;
	label$2947$98:
	if( r33 == NULL ) hl_null_access();
	r35 = r33->x;
	if( r19 == NULL ) hl_null_access();
	r36 = r19->x;
	if( r35 != r36 ) goto label$2947$114;
	r35 = r33->y;
	r36 = r19->y;
	if( r35 != r36 ) goto label$2947$114;
	r35 = r33->z;
	r36 = r19->z;
	if( r35 != r36 ) goto label$2947$114;
	if( r14 == NULL ) hl_null_access();
	r31 = hl_types_ArrayBytes_Int_push(r14,r30);
	r37 = true;
	r18 = r37;
	goto label$2947$115;
	label$2947$114:
	goto label$2947$86;
	label$2947$115:
	if( r18 ) goto label$2947$121;
	if( r14 == NULL ) hl_null_access();
	if( r7 == NULL ) hl_null_access();
	r17 = r7->length;
	r17 = hl_types_ArrayBytes_Int_push(r14,r17);
	r17 = hl_types_ArrayObj_push(r7,((vdynamic*)r19));
	label$2947$121:
	goto label$2947$29;
	label$2947$122:
	r38 = (hl__types__ArrayBytes_hl_UI16)hl_alloc_obj(hl__types__ArrayBytes_hl_UI16__val);
	hl_types_ArrayBytes_hl_UI16_new(r38);
	r10 = 0;
	if( r4 == NULL ) hl_null_access();
	r39 = r4->indexes;
	label$2947$127:
	if( r39 == NULL ) hl_null_access();
	r16 = r39->length;
	if( r10 >= r16 ) goto label$2947$156;
	if( r38 == NULL ) hl_null_access();
	if( r14 == NULL ) hl_null_access();
	r15 = r10;
	++r10;
	r16 = r39->length;
	if( ((unsigned)r15) < ((unsigned)r16) ) goto label$2947$139;
	r15 = 0;
	goto label$2947$143;
	label$2947$139:
	r23 = r39->bytes;
	r16 = 1;
	r16 = r15 << r16;
	r15 = *(unsigned short*)(r23 + r16);
	label$2947$143:
	r40 = (int)r15;
	r15 = (int)r40;
	r16 = r14->length;
	if( ((unsigned)r15) < ((unsigned)r16) ) goto label$2947$149;
	r15 = 0;
	goto label$2947$153;
	label$2947$149:
	r23 = r14->bytes;
	r16 = 2;
	r16 = r15 << r16;
	r15 = *(int*)(r23 + r16);
	label$2947$153:
	r40 = (int)r15;
	r15 = hl_types_ArrayBytes_hl_UI16_push(r38,r40);
	goto label$2947$127;
	label$2947$156:
	r41 = (h3d__prim__Polygon)hl_alloc_obj(h3d__prim__Polygon__val);
	h3d_prim_Polygon_new(r41,r7,r38);
	h3d_prim_Polygon_addNormals(r41);
	r20 = (hl__types__ArrayBytes_Single)hl_alloc_obj(hl__types__ArrayBytes_Single__val);
	hl_types_ArrayBytes_Single_new(r20);
	r10 = 0;
	r6 = r0->data;
	if( r6 == NULL ) hl_null_access();
	r15 = r6->vertexCount;
	label$2947$165:
	if( r10 >= r15 ) goto label$2947$200;
	if( r41 == NULL ) hl_null_access();
	r12 = r41->normals;
	if( r12 == NULL ) hl_null_access();
	if( r14 == NULL ) hl_null_access();
	r16 = r10;
	++r10;
	r17 = r14->length;
	if( ((unsigned)r16) < ((unsigned)r17) ) goto label$2947$177;
	r16 = 0;
	goto label$2947$181;
	label$2947$177:
	r23 = r14->bytes;
	r17 = 2;
	r17 = r16 << r17;
	r16 = *(int*)(r23 + r17);
	label$2947$181:
	r17 = r12->length;
	if( ((unsigned)r16) < ((unsigned)r17) ) goto label$2947$185;
	r19 = NULL;
	goto label$2947$188;
	label$2947$185:
	r8 = r12->array;
	r34 = ((vdynamic**)(r8 + 1))[r16];
	r19 = (h3d__col__Point)r34;
	label$2947$188:
	if( r20 == NULL ) hl_null_access();
	if( r19 == NULL ) hl_null_access();
	r35 = r19->x;
	r22 = (float)r35;
	r16 = hl_types_ArrayBytes_Single_push(r20,r22);
	r35 = r19->y;
	r22 = (float)r35;
	r16 = hl_types_ArrayBytes_Single_push(r20,r22);
	r35 = r19->z;
	r22 = (float)r35;
	r16 = hl_types_ArrayBytes_Single_push(r20,r22);
	goto label$2947$165;
	label$2947$200:
	r10 = 3;
	r12 = NULL;
	r43 = NULL;
	r42 = h3d_Buffer_ofFloats(r20,r10,r12,r43);
	r10 = 0;
	r44 = &r10;
	h3d_prim_MeshPrimitive_addBuffer(((h3d__prim__MeshPrimitive)r0),r1,r42,r44);
	r0->normalsRecomputed = r1;
	return;
}

void h3d_prim_HMDModel_render(h3d__prim__HMDModel r0,h3d__Engine r1) {
	bool r6;
	hxd__fmt__hmd__Geometry r10;
	hl__types__ArrayBytes_Int r9;
	h3d__BufferOffset r7;
	double r8, r12;
	int *r13, *r14;
	vbyte *r11;
	h3d__Indexes r5;
	int r3, r4, r15;
	r3 = r0->curMaterial;
	r4 = 0;
	if( r3 >= r4 ) goto label$2948$5;
	h3d_prim_MeshPrimitive_render(((h3d__prim__MeshPrimitive)r0),r1);
	return;
	label$2948$5:
	r5 = r0->indexes;
	if( !r5 ) goto label$2948$11;
	r5 = r0->indexes;
	if( r5 == NULL ) hl_null_access();
	r6 = h3d_Indexes_isDisposed(r5);
	if( !r6 ) goto label$2948$12;
	label$2948$11:
	h3d_prim_HMDModel_alloc(r0,r1);
	label$2948$12:
	r7 = h3d_prim_MeshPrimitive_getBuffers(((h3d__prim__MeshPrimitive)r0),r1);
	r10 = r0->data;
	if( r10 == NULL ) hl_null_access();
	r9 = r10->indexCounts;
	if( r9 == NULL ) hl_null_access();
	r3 = r0->curMaterial;
	r4 = r9->length;
	if( ((unsigned)r3) < ((unsigned)r4) ) goto label$2948$22;
	r3 = 0;
	goto label$2948$26;
	label$2948$22:
	r11 = r9->bytes;
	r4 = 2;
	r4 = r3 << r4;
	r3 = *(int*)(r11 + r4);
	label$2948$26:
	r8 = (double)r3;
	r3 = 3;
	r12 = (double)r3;
	r8 = r8 / r12;
	if( r1 == NULL ) hl_null_access();
	r5 = r0->indexes;
	r9 = r0->indexesTriPos;
	if( r9 == NULL ) hl_null_access();
	r3 = r0->curMaterial;
	r4 = r9->length;
	if( ((unsigned)r3) < ((unsigned)r4) ) goto label$2948$39;
	r3 = 0;
	goto label$2948$43;
	label$2948$39:
	r11 = r9->bytes;
	r4 = 2;
	r4 = r3 << r4;
	r3 = *(int*)(r11 + r4);
	label$2948$43:
	r13 = &r3;
	r4 = (int)r8;
	r14 = &r4;
	h3d_Engine_renderMultiBuffers(r1,r7,r5,r13,r14);
	r15 = -1;
	r0->curMaterial = r15;
	return;
}

void h3d_prim_HMDModel_initCollider(h3d__prim__HMDModel r0,h3d__col__PolygonBuffer r1) {
	String r10;
	vvirtual *r18, *r34;
	hl__types__ArrayObj r5, r12;
	hl_type *r7;
	h3d__col__Bounds r19;
	hl__types__ArrayBytes_hl_UI16 r15;
	hxd__fmt__hmd__GeometryFormat r9;
	hl__types__ArrayBytes_Single r14;
	hxd__fmt__hmd__Geometry r4;
	h3d__col__OptimizedCollider r24;
	h3d__col__Sphere r25;
	double r20, r21, r22, r23, r26, r28, r30, r32;
	hxd__fmt__hmd__GeometryBuffer r2;
	double *r27, *r29, *r31, *r33;
	int *r16, *r17;
	vdynamic *r13;
	int r8;
	varray *r6;
	hxd__fmt__hmd__Library r3;
	r3 = r0->lib;
	if( r3 == NULL ) hl_null_access();
	r4 = r0->data;
	r7 = &type$2492;
	r8 = 1;
	r6 = hl_alloc_array(r7,r8);
	r9 = (hxd__fmt__hmd__GeometryFormat)hl_alloc_obj(hxd__fmt__hmd__GeometryFormat__val);
	r10 = (String)global$703;
	r8 = 3;
	hxd_fmt_hmd_GeometryFormat_new(r9,r10,r8);
	r8 = 0;
	((hxd__fmt__hmd__GeometryFormat*)(r6 + 1))[r8] = r9;
	r5 = hl_types_ArrayObj_alloc(r6);
	r12 = NULL;
	r13 = NULL;
	r2 = hxd_fmt_hmd_Library_getBuffers(r3,r4,r5,r12,r13);
	if( r1 == NULL ) hl_null_access();
	if( r2 == NULL ) hl_null_access();
	r14 = r2->vertexes;
	r15 = r2->indexes;
	r16 = NULL;
	r17 = NULL;
	h3d_col_PolygonBuffer_setData(r1,r14,r15,r16,r17);
	r18 = r0->collider;
	if( r18 ) goto label$2949$91;
	r4 = r0->data;
	if( r4 == NULL ) hl_null_access();
	r19 = r4->bounds;
	if( r19 == NULL ) hl_null_access();
	r20 = r19->xMax;
	r21 = r19->xMin;
	r20 = r20 - r21;
	r21 = r19->yMax;
	r22 = r19->yMin;
	r21 = r21 - r22;
	r22 = r19->zMax;
	r23 = r19->zMin;
	r22 = r22 - r23;
	r24 = (h3d__col__OptimizedCollider)hl_alloc_obj(h3d__col__OptimizedCollider__val);
	r25 = (h3d__col__Sphere)hl_alloc_obj(h3d__col__Sphere__val);
	r23 = r19->xMin;
	r26 = r19->xMax;
	r23 = r23 + r26;
	r26 = 0.5;
	r23 = r23 * r26;
	r27 = &r23;
	r26 = r19->yMin;
	r28 = r19->yMax;
	r26 = r26 + r28;
	r28 = 0.5;
	r26 = r26 * r28;
	r29 = &r26;
	r28 = r19->zMin;
	r30 = r19->zMax;
	r28 = r28 + r30;
	r30 = 0.5;
	r28 = r28 * r30;
	r31 = &r28;
	r30 = r20 * r20;
	r32 = r21 * r21;
	r30 = r30 + r32;
	r32 = r22 * r22;
	r30 = r30 + r32;
	r30 = hl_math_sqrt(r30);
	r32 = 0.5;
	r30 = r30 * r32;
	r33 = &r30;
	h3d_col_Sphere_new(r25,r27,r29,r31,r33);
	if( r25 ) goto label$2949$71;
	r18 = NULL;
	goto label$2949$75;
	label$2949$71:
	r18 = r25->$_f4;
	if( r18 ) goto label$2949$75;
	r18 = hl_to_virtual(&type$252,(vdynamic*)r25);
	r25->$_f4 = r18;
	label$2949$75:
	if( r1 ) goto label$2949$78;
	r34 = NULL;
	goto label$2949$82;
	label$2949$78:
	r34 = r1->$_f5;
	if( r34 ) goto label$2949$82;
	r34 = hl_to_virtual(&type$252,(vdynamic*)r1);
	r1->$_f5 = r34;
	label$2949$82:
	h3d_col_OptimizedCollider_new(r24,r18,r34);
	if( r24 ) goto label$2949$86;
	r18 = NULL;
	goto label$2949$90;
	label$2949$86:
	r18 = r24->$_f2;
	if( r18 ) goto label$2949$90;
	r18 = hl_to_virtual(&type$252,(vdynamic*)r24);
	r24->$_f2 = r18;
	label$2949$90:
	r0->collider = r18;
	label$2949$91:
	return;
}

vvirtual* h3d_prim_HMDModel_getCollider(h3d__prim__HMDModel r0) {
	hxd__fmt__hmd__Model r16;
	hxd__fmt__hmd__Data r12;
	String r9;
	hxd__fs__FileEntry r6;
	hl__types__ArrayObj r11, r15;
	vvirtual *r2, *r5;
	hxd__res__Resource r7;
	hxd__fmt__hmd__Geometry r18, r19;
	h3d__col__PolygonBuffer r4;
	vdynamic *r3;
	varray *r17;
	int r10, r13, r14;
	hxd__fmt__hmd__Library r8;
	r2 = r0->collider;
	if( !r2 ) goto label$2950$4;
	r2 = r0->collider;
	return r2;
	label$2950$4:
	r4 = (h3d__col__PolygonBuffer)hl_alloc_obj(h3d__col__PolygonBuffer__val);
	h3d_col_PolygonBuffer_new(r4);
	r5 = hl_alloc_virtual(&type$2019);
	r8 = r0->lib;
	if( r8 == NULL ) hl_null_access();
	r7 = r8->resource;
	if( r7 == NULL ) hl_null_access();
	r6 = r7->entry;
	if( hl_vfields(r5)[0] ) *(hxd__fs__FileEntry*)(hl_vfields(r5)[0]) = (hxd__fs__FileEntry)r6; else hl_dyn_setp(r5->value,277248513/*entry*/,&type$302,r6);
	r9 = NULL;
	if( hl_vfields(r5)[1] ) *(String*)(hl_vfields(r5)[1]) = (String)r9; else hl_dyn_setp(r5->value,427680551/*geometryName*/,&type$13,r9);
	r4->source = r5;
	r10 = 0;
	r8 = r0->lib;
	if( r8 == NULL ) hl_null_access();
	r12 = r8->header;
	if( r12 == NULL ) hl_null_access();
	r11 = r12->models;
	label$2950$22:
	if( r11 == NULL ) hl_null_access();
	r14 = r11->length;
	if( r10 >= r14 ) goto label$2950$58;
	r14 = r11->length;
	if( ((unsigned)r10) < ((unsigned)r14) ) goto label$2950$30;
	r16 = NULL;
	goto label$2950$33;
	label$2950$30:
	r17 = r11->array;
	r3 = ((vdynamic**)(r17 + 1))[r10];
	r16 = (hxd__fmt__hmd__Model)r3;
	label$2950$33:
	++r10;
	r8 = r0->lib;
	if( r8 == NULL ) hl_null_access();
	r12 = r8->header;
	if( r12 == NULL ) hl_null_access();
	r15 = r12->geometries;
	if( r15 == NULL ) hl_null_access();
	if( r16 == NULL ) hl_null_access();
	r13 = r16->geometry;
	r14 = r15->length;
	if( ((unsigned)r13) < ((unsigned)r14) ) goto label$2950$46;
	r18 = NULL;
	goto label$2950$49;
	label$2950$46:
	r17 = r15->array;
	r3 = ((vdynamic**)(r17 + 1))[r13];
	r18 = (hxd__fmt__hmd__Geometry)r3;
	label$2950$49:
	r19 = r0->data;
	if( r18 != r19 ) goto label$2950$57;
	if( r4 == NULL ) hl_null_access();
	r5 = r4->source;
	if( r5 == NULL ) hl_null_access();
	r9 = r16->name;
	if( hl_vfields(r5)[1] ) *(String*)(hl_vfields(r5)[1]) = (String)r9; else hl_dyn_setp(r5->value,427680551/*geometryName*/,&type$13,r9);
	goto label$2950$58;
	label$2950$57:
	goto label$2950$22;
	label$2950$58:
	h3d_prim_HMDModel_initCollider(r0,r4);
	r2 = r0->collider;
	return r2;
}

void h3d_prim_HMDModel_new(h3d__prim__HMDModel r0,hxd__fmt__hmd__Geometry r1,int r2,hxd__fmt__hmd__Library r3) {
	haxe__ds__StringMap r4;
	r4 = (haxe__ds__StringMap)hl_alloc_obj(haxe__ds__StringMap__val);
	haxe_ds_StringMap_new(r4);
	r0->bufferAliases = r4;
	r0->data = r1;
	r0->dataPosition = r2;
	r0->lib = r3;
	return;
}

